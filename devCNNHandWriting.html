<!DOCTYPE html>
<html lang="en-US">
<head><meta charset="UTF-8" /><script type="46b118dd096b29ef1b5fe745-text/javascript">if(navigator.userAgent.match(/MSIE|Internet Explorer/i)||navigator.userAgent.match(/Trident\/7\..*?rv:11/i)){var href=document.location.href;if(!href.match(/[?&]nowprocket/)){if(href.indexOf("?")==-1){if(href.indexOf("#")==-1){document.location.href=href+"?nowprocket=1"}else{document.location.href=href.replace("#","?nowprocket=1#")}}else{if(href.indexOf("#")==-1){document.location.href=href+"&nowprocket=1"}else{document.location.href=href.replace("#","&nowprocket=1#")}}}}</script><script type="46b118dd096b29ef1b5fe745-text/javascript">class RocketLazyLoadScripts{constructor(e){this.triggerEvents=e,this.eventOptions={passive:!0},this.userEventListener=this.triggerListener.bind(this),this.delayedScripts={normal:[],async:[],defer:[]},this.allJQueries=[]}_addUserInteractionListener(e){this.triggerEvents.forEach((t=>window.addEventListener(t,e.userEventListener,e.eventOptions)))}_removeUserInteractionListener(e){this.triggerEvents.forEach((t=>window.removeEventListener(t,e.userEventListener,e.eventOptions)))}triggerListener(){this._removeUserInteractionListener(this),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",this._loadEverythingNow.bind(this)):this._loadEverythingNow()}async _loadEverythingNow(){this._delayEventListeners(),this._delayJQueryReady(this),this._handleDocumentWrite(),this._registerAllDelayedScripts(),this._preloadAllScripts(),await this._loadScriptsFromList(this.delayedScripts.normal),await this._loadScriptsFromList(this.delayedScripts.defer),await this._loadScriptsFromList(this.delayedScripts.async),await this._triggerDOMContentLoaded(),await this._triggerWindowLoad(),window.dispatchEvent(new Event("rocket-allScriptsLoaded"))}_registerAllDelayedScripts(){document.querySelectorAll("script[type=rocketlazyloadscript]").forEach((e=>{e.hasAttribute("src")?e.hasAttribute("async")&&!1!==e.async?this.delayedScripts.async.push(e):e.hasAttribute("defer")&&!1!==e.defer||"module"===e.getAttribute("data-rocket-type")?this.delayedScripts.defer.push(e):this.delayedScripts.normal.push(e):this.delayedScripts.normal.push(e)}))}async _transformScript(e){return await this._requestAnimFrame(),new Promise((t=>{const n=document.createElement("script");let r;[...e.attributes].forEach((e=>{let t=e.nodeName;"type"!==t&&("data-rocket-type"===t&&(t="type",r=e.nodeValue),n.setAttribute(t,e.nodeValue))})),e.hasAttribute("src")?(n.addEventListener("load",t),n.addEventListener("error",t)):(n.text=e.text,t()),e.parentNode.replaceChild(n,e)}))}async _loadScriptsFromList(e){const t=e.shift();return t?(await this._transformScript(t),this._loadScriptsFromList(e)):Promise.resolve()}_preloadAllScripts(){var e=document.createDocumentFragment();[...this.delayedScripts.normal,...this.delayedScripts.defer,...this.delayedScripts.async].forEach((t=>{const n=t.getAttribute("src");if(n){const t=document.createElement("link");t.href=n,t.rel="preload",t.as="script",e.appendChild(t)}})),document.head.appendChild(e)}_delayEventListeners(){let e={};function t(t,n){!function(t){function n(n){return e[t].eventsToRewrite.indexOf(n)>=0?"rocket-"+n:n}e[t]||(e[t]={originalFunctions:{add:t.addEventListener,remove:t.removeEventListener},eventsToRewrite:[]},t.addEventListener=function(){arguments[0]=n(arguments[0]),e[t].originalFunctions.add.apply(t,arguments)},t.removeEventListener=function(){arguments[0]=n(arguments[0]),e[t].originalFunctions.remove.apply(t,arguments)})}(t),e[t].eventsToRewrite.push(n)}function n(e,t){let n=e[t];Object.defineProperty(e,t,{get:()=>n||function(){},set(r){e["rocket"+t]=n=r}})}t(document,"DOMContentLoaded"),t(window,"DOMContentLoaded"),t(window,"load"),t(window,"pageshow"),t(document,"readystatechange"),n(document,"onreadystatechange"),n(window,"onload"),n(window,"onpageshow")}_delayJQueryReady(e){let t=window.jQuery;Object.defineProperty(window,"jQuery",{get:()=>t,set(n){if(n&&n.fn&&!e.allJQueries.includes(n)){n.fn.ready=n.fn.init.prototype.ready=function(t){e.domReadyFired?t.bind(document)(n):document.addEventListener("rocket-DOMContentLoaded",(()=>t.bind(document)(n)))};const t=n.fn.on;n.fn.on=n.fn.init.prototype.on=function(){if(this[0]===window){function e(e){return e.split(" ").map((e=>"load"===e||0===e.indexOf("load.")?"rocket-jquery-load":e)).join(" ")}"string"==typeof arguments[0]||arguments[0]instanceof String?arguments[0]=e(arguments[0]):"object"==typeof arguments[0]&&Object.keys(arguments[0]).forEach((t=>{delete Object.assign(arguments[0],{[e(t)]:arguments[0][t]})[t]}))}return t.apply(this,arguments),this},e.allJQueries.push(n)}t=n}})}async _triggerDOMContentLoaded(){this.domReadyFired=!0,await this._requestAnimFrame(),document.dispatchEvent(new Event("rocket-DOMContentLoaded")),await this._requestAnimFrame(),window.dispatchEvent(new Event("rocket-DOMContentLoaded")),await this._requestAnimFrame(),document.dispatchEvent(new Event("rocket-readystatechange")),await this._requestAnimFrame(),document.rocketonreadystatechange&&document.rocketonreadystatechange()}async _triggerWindowLoad(){await this._requestAnimFrame(),window.dispatchEvent(new Event("rocket-load")),await this._requestAnimFrame(),window.rocketonload&&window.rocketonload(),await this._requestAnimFrame(),this.allJQueries.forEach((e=>e(window).trigger("rocket-jquery-load"))),window.dispatchEvent(new Event("rocket-pageshow")),await this._requestAnimFrame(),window.rocketonpageshow&&window.rocketonpageshow()}_handleDocumentWrite(){const e=new Map;document.write=document.writeln=function(t){const n=document.currentScript,r=document.createRange(),i=n.parentElement;let o=e.get(n);void 0===o&&(o=n.nextSibling,e.set(n,o));const a=document.createDocumentFragment();r.setStart(a,0),a.appendChild(r.createContextualFragment(t)),i.insertBefore(a,o)}}async _requestAnimFrame(){return new Promise((e=>requestAnimationFrame(e)))}static run(){const e=new RocketLazyLoadScripts(["keydown","mousemove","touchmove","touchstart","touchend","wheel"]);e._addUserInteractionListener(e)}}RocketLazyLoadScripts.run();</script>



<link rel="pingback" href="https://machinelearningmastery.com/xmlrpc.php" />
<meta name='robots' content='index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1' />

<script type="rocketlazyloadscript">
MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};

</script>

<!--  Mobile viewport scale -->
<meta content="initial-scale=1.0, maximum-scale=1.0, user-scalable=yes" name="viewport"/>

	<!-- This site is optimized with the Yoast SEO plugin v17.6 - https://yoast.com/wordpress/plugins/seo/ -->
	<title>How to Develop a CNN for MNIST Handwritten Digit Classification</title><link rel="stylesheet" href="https://machinelearningmastery.com/wp-content/cache/min/1/f5120c90ddf1b3d6f3ee7aa3abf4d8c6.css" media="all" data-minify="1" />
	<link rel="canonical" href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/" />
	<meta property="og:locale" content="en_US" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="How to Develop a CNN for MNIST Handwritten Digit Classification" />
	<meta property="og:description" content="How to Develop a Convolutional Neural Network From Scratch for MNIST Handwritten Digit Classification. The MNIST handwritten digit classification problem [&hellip;]" />
	<meta property="og:url" content="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/" />
	<meta property="og:site_name" content="Machine Learning Mastery" />
	<meta property="article:publisher" content="https://www.facebook.com/MachineLearningMastery/" />
	<meta property="article:author" content="https://www.facebook.com/MachineLearningMastery/" />
	<meta property="article:published_time" content="2019-05-07T19:00:02+00:00" />
	<meta property="article:modified_time" content="2021-11-14T05:05:20+00:00" />
	<meta property="og:image" content="https://machinelearningmastery.com/wp-content/uploads/2019/02/Plot-of-a-Subset-of-Images-from-the-MNIST-Dataset.png" />
	<meta property="og:image:width" content="1280" />
	<meta property="og:image:height" content="960" />
	<meta name="twitter:label1" content="Written by" />
	<meta name="twitter:data1" content="Jason Brownlee" />
	<meta name="twitter:label2" content="Est. reading time" />
	<meta name="twitter:data2" content="34 minutes" />
	<script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"Organization","@id":"https://machinelearningmastery.com/#organization","name":"Machine Learning Mastery","url":"https://machinelearningmastery.com/","sameAs":["https://www.facebook.com/MachineLearningMastery/","https://www.linkedin.com/company/machine-learning-mastery","https://twitter.com/TeachTheMachine"],"logo":{"@type":"ImageObject","@id":"https://machinelearningmastery.com/#logo","inLanguage":"en-US","url":"https://machinelearningmastery.com/wp-content/uploads/2016/09/cropped-icon.png","contentUrl":"https://machinelearningmastery.com/wp-content/uploads/2016/09/cropped-icon.png","width":512,"height":512,"caption":"Machine Learning Mastery"},"image":{"@id":"https://machinelearningmastery.com/#logo"}},{"@type":"WebSite","@id":"https://machinelearningmastery.com/#website","url":"https://machinelearningmastery.com/","name":"Machine Learning Mastery","description":"Making developers awesome at machine learning","publisher":{"@id":"https://machinelearningmastery.com/#organization"},"potentialAction":[{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https://machinelearningmastery.com/?s={search_term_string}"},"query-input":"required name=search_term_string"}],"inLanguage":"en-US"},{"@type":"ImageObject","@id":"https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#primaryimage","inLanguage":"en-US","url":"https://machinelearningmastery.com/wp-content/uploads/2019/02/Plot-of-a-Subset-of-Images-from-the-MNIST-Dataset.png","contentUrl":"https://machinelearningmastery.com/wp-content/uploads/2019/02/Plot-of-a-Subset-of-Images-from-the-MNIST-Dataset.png","width":1280,"height":960,"caption":"Plot of a Subset of Images From the MNIST Dataset"},{"@type":"WebPage","@id":"https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#webpage","url":"https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/","name":"How to Develop a CNN for MNIST Handwritten Digit Classification","isPartOf":{"@id":"https://machinelearningmastery.com/#website"},"primaryImageOfPage":{"@id":"https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#primaryimage"},"datePublished":"2019-05-07T19:00:02+00:00","dateModified":"2021-11-14T05:05:20+00:00","breadcrumb":{"@id":"https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#breadcrumb"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/"]}]},{"@type":"BreadcrumbList","@id":"https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https://machinelearningmastery.com/"},{"@type":"ListItem","position":2,"name":"Blog","item":"https://machinelearningmastery.com/blog/"},{"@type":"ListItem","position":3,"name":"How to Develop a CNN for MNIST Handwritten Digit Classification"}]},{"@type":"Article","@id":"https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#article","isPartOf":{"@id":"https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#webpage"},"author":{"@id":"https://machinelearningmastery.com/#/schema/person/e2d0ff4828d406a3b47e5a3c9a0591e8"},"headline":"How to Develop a CNN for MNIST Handwritten Digit Classification","datePublished":"2019-05-07T19:00:02+00:00","dateModified":"2021-11-14T05:05:20+00:00","mainEntityOfPage":{"@id":"https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#webpage"},"wordCount":3844,"commentCount":148,"publisher":{"@id":"https://machinelearningmastery.com/#organization"},"image":{"@id":"https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#primaryimage"},"thumbnailUrl":"https://machinelearningmastery.com/wp-content/uploads/2019/02/Plot-of-a-Subset-of-Images-from-the-MNIST-Dataset.png","articleSection":["Deep Learning for Computer Vision"],"inLanguage":"en-US","potentialAction":[{"@type":"CommentAction","name":"Comment","target":["https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#respond"]}]},{"@type":"Person","@id":"https://machinelearningmastery.com/#/schema/person/e2d0ff4828d406a3b47e5a3c9a0591e8","name":"Jason Brownlee","image":{"@type":"ImageObject","@id":"https://machinelearningmastery.com/#personlogo","inLanguage":"en-US","url":"https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=96&d=mm&r=g","contentUrl":"https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=96&d=mm&r=g","caption":"Jason Brownlee"},"description":"Jason Brownlee, PhD is a machine learning specialist who teaches developers how to get results with modern machine learning methods via hands-on tutorials.","sameAs":["http://MachineLearningMastery.com","https://www.facebook.com/MachineLearningMastery/","https://www.linkedin.com/company/machine-learning-mastery","https://twitter.com/teachthemachine"],"url":"https://machinelearningmastery.com/author/jasonb/"}]}</script>
	<!-- / Yoast SEO plugin. -->


<link rel='dns-prefetch' href='//cdn.jsdelivr.net' />
<link rel='dns-prefetch' href='//ads.adthrive.com' />
<link rel='dns-prefetch' href='//www.google-analytics.com' />
<link rel='dns-prefetch' href='//loadeu.exelator.com' />
<link rel='dns-prefetch' href='//sync.crwdcntrl.net' />
<link rel='dns-prefetch' href='//gdpr-wrapper.privacymanager.io' />
<link rel='dns-prefetch' href='//securepubads.g.doubleclick.net' />
<link rel='dns-prefetch' href='//gdpr.privacymanager.io' />
<link rel='dns-prefetch' href='//sb.scorecardresearch.com' />
<link rel='dns-prefetch' href='//confiant-integrations.global.ssl.fastly.net' />

<link rel="alternate" type="application/rss+xml" title="Machine Learning Mastery &raquo; Feed" href="https://feeds.feedburner.com/MachineLearningMastery" />
<link rel="alternate" type="application/rss+xml" title="Machine Learning Mastery &raquo; Comments Feed" href="https://machinelearningmastery.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Machine Learning Mastery &raquo; How to Develop a CNN for MNIST Handwritten Digit Classification Comments Feed" href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/feed/" />
<!-- machinelearningmastery.com is managing ads with Advanced Ads 1.30.2 – https://wpadvancedads.com/ --><!--noptimize--><script id="machi-ready" type="46b118dd096b29ef1b5fe745-text/javascript">
			window.advanced_ads_ready=function(e,a){a=a||"complete";var d=function(e){return"interactive"===a?"loading"!==e:"complete"===e};d(document.readyState)?e():document.addEventListener("readystatechange",(function(a){d(a.target.readyState)&&e()}),{once:"interactive"===a})},window.advanced_ads_ready_queue=window.advanced_ads_ready_queue||[];		</script>
		<!--/noptimize--><style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	









<!--[if lt IE 9]>
<link href="https://machinelearningmastery.com/wp-content/themes/canvas-new/css/non-responsive.css" rel="stylesheet" type="text/css" />
<style type="text/css">.col-full, #wrapper { width: 960px; max-width: 960px; } #inner-wrapper { padding: 0; } body.full-width #header, #nav-container, body.full-width #content, body.full-width #footer-widgets, body.full-width #footer { padding-left: 0; padding-right: 0; } body.fixed-mobile #top, body.fixed-mobile #header-container, body.fixed-mobile #footer-container, body.fixed-mobile #nav-container, body.fixed-mobile #footer-widgets-container { min-width: 960px; padding: 0 1em; } body.full-width #content { width: auto; padding: 0 1em;}</style>
<![endif]-->
<script type="rocketlazyloadscript" data-rocket-type='text/javascript' src='https://machinelearningmastery.com/wp-includes/js/jquery/jquery.min.js?ver=3.6.0' id='jquery-core-js' defer></script>
<script type="rocketlazyloadscript" data-rocket-type='text/javascript' src='https://machinelearningmastery.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.3.2' id='jquery-migrate-js' defer></script>
<script type="46b118dd096b29ef1b5fe745-text/javascript" id='urvanov_syntax_highlighter_js-js-extra'>
/* <![CDATA[ */
var UrvanovSyntaxHighlighterSyntaxSettings = {"version":"2.8.26","is_admin":"0","ajaxurl":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","prefix":"urvanov-syntax-highlighter-","setting":"urvanov-syntax-highlighter-setting","selected":"urvanov-syntax-highlighter-setting-selected","changed":"urvanov-syntax-highlighter-setting-changed","special":"urvanov-syntax-highlighter-setting-special","orig_value":"data-orig-value","debug":""};
var UrvanovSyntaxHighlighterSyntaxStrings = {"copy":"Copied to the clipboard","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type="rocketlazyloadscript" data-rocket-type='text/javascript' src='https://machinelearningmastery.com/wp-content/plugins/urvanov-syntax-highlighter/js/min/urvanov_syntax_highlighter.min.js?ver=2.8.26' id='urvanov_syntax_highlighter_js-js' defer></script>
<script type="46b118dd096b29ef1b5fe745-text/javascript" id='ssb-front-js-js-extra'>
/* <![CDATA[ */
var SSB = {"ajax_url":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","fb_share_nonce":"dfc28ac3f2"};
/* ]]> */
</script>
<script type="rocketlazyloadscript" data-minify="1" data-rocket-type='text/javascript' src='https://machinelearningmastery.com/wp-content/cache/min/1/wp-content/plugins/simple-social-buttons/assets/js/front.js?ver=1637275040' id='ssb-front-js-js' defer></script>
<script type="46b118dd096b29ef1b5fe745-text/javascript" id='advanced-ads-advanced-js-js-extra'>
/* <![CDATA[ */
var advads_options = {"blog_id":"1","privacy":{"enabled":false,"state":"not_needed"}};
/* ]]> */
</script>
<script type="rocketlazyloadscript" data-rocket-type='text/javascript' src='https://machinelearningmastery.com/wp-content/plugins/advanced-ads/public/assets/js/advanced.min.js?ver=1.30.2' id='advanced-ads-advanced-js-js' defer></script>
<script type="rocketlazyloadscript" data-rocket-type='text/javascript' src='https://machinelearningmastery.com/wp-content/themes/canvas-new/includes/js/third-party.min.js?ver=5.8.2' id='third-party-js' defer></script>
<script type="rocketlazyloadscript" data-rocket-type='text/javascript' src='https://machinelearningmastery.com/wp-content/themes/canvas-new/includes/js/modernizr.min.js?ver=2.6.2' id='modernizr-js' defer></script>
<script type="rocketlazyloadscript" data-rocket-type='text/javascript' src='https://machinelearningmastery.com/wp-content/themes/canvas-new/includes/js/general.min.js?ver=5.8.2' id='general-js' defer></script>
<link rel="https://api.w.org/" href="https://machinelearningmastery.com/wp-json/" /><link rel="alternate" type="application/json" href="https://machinelearningmastery.com/wp-json/wp/v2/posts/7553" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://machinelearningmastery.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://machinelearningmastery.com/wp-includes/wlwmanifest.xml" /> 
<link rel='shortlink' href='https://machinelearningmastery.com/?p=7553' />
<link rel="alternate" type="application/json+oembed" href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fhow-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fhow-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification%2F&#038;format=xml" />
<style type="text/css">.crp_title {
    font-size: medium;
}
.group.portfolio-img img {
    height: auto;
    padding: 3px;
	  border: 0px solid #fff;
    background: rgba(255,255,255,.7);
}
.crp_related ul li {
    background: #fff;
    padding: 3px;
    margin: 0 0 1em;
    width: 100%;
    box-sizing: border-box;
    -moz-box-sizing: border-box;
    -webkit-box-sizing: border-box;
    box-shadow: 0 0px 0px 0 rgb(0 0 0 / 18%);
    border-radius: 3px;
    -moz-border-radius: 3px;
    -webkit-border-radius: 3px;
    border: 0px solid #fff;
    animation: wzslideup .8s ease-out,wzfadein 1s ease-out;
    -webkit-animation: wzslideup .8s ease-out,wzfadein 1s ease-out;
    -moz-animation: wzslideup .8s ease-out,wzfadein 1s ease;
    font-size: 1em;
    text-align: center;
    display: inline-block;
}</style>    <style type="text/css">

      .mpcs-classroom .nav-back i,
      .mpcs-classroom .navbar-section a.btn,
      .mpcs-classroom .navbar-section a,
      .mpcs-classroom .navbar-section button {
        color: rgba(255, 255, 255) !important;
      }

      .mpcs-classroom .navbar-section .dropdown .menu a {
        color: rgba(44, 54, 55) !important;
      }

      .mpcs-classroom .mpcs-progress-ring {
        background-color: rgba(29, 166, 154) !important;
      }

      .mpcs-classroom .mpcs-course-filter .dropdown .btn span,
      .mpcs-classroom .mpcs-course-filter .dropdown .btn i,
      .mpcs-classroom .mpcs-course-filter .input-group .input-group-btn,
      .mpcs-classroom .mpcs-course-filter .input-group .mpcs-search,
      .mpcs-classroom .mpcs-course-filter .input-group input[type=text],
      .mpcs-classroom .mpcs-course-filter .dropdown a,
      .mpcs-classroom .pagination,
      .mpcs-classroom .pagination i,
      .mpcs-classroom .pagination a {
        color: rgba(44, 54, 55) !important;
        border-color: rgba(44, 54, 55) !important;
      }

      /* body.mpcs-classroom a{
        color: rgba();
      } */

      #mpcs-navbar,
      #mpcs-navbar button#previous_lesson_link,
      #mpcs-navbar button#previous_lesson_link:hover {
        background: rgba(44, 54, 55);
      }

      .course-progress .user-progress,
      .btn-green,
      #mpcs-navbar button:not(#previous_lesson_link){
        background: rgba(29, 166, 154, 0.9);
      }

      .btn-green:hover,
      #mpcs-navbar button:not(#previous_lesson_link):focus,
      #mpcs-navbar button:not(#previous_lesson_link):hover{
        background: rgba(29, 166, 154);
      }

      .btn-green{border: rgba(29, 166, 154)}

      .course-progress .progress-text,
      .mpcs-lesson i.mpcs-circle-regular {
        color: rgba(29, 166, 154)
      }

      #mpcs-main #bookmark, .mpcs-lesson.current{background: rgba(29, 166, 154, 0.3)}

      .mpcs-instructor .tile-subtitle{
        color: rgba(29, 166, 154, 1)
      }

    </style>
     <style media="screen">

		.simplesocialbuttons.simplesocialbuttons_inline .ssb-fb-like {
	  margin: ;
	}
		 /*inline margin*/
	
	
	
	
	
	
			 .simplesocialbuttons.simplesocialbuttons_inline.simplesocial-simple-icons button{
		 margin: ;
	 }

			 /*margin-digbar*/

	
	
	
	
	
	
	
</style>

<!-- Open Graph Meta Tags generated by Simple Social Buttons 3.2.4 -->
<meta property="og:title" content="How to Develop a CNN for MNIST Handwritten Digit Classification - Machine Learning Mastery" />
<meta property="og:description" content="How to Develop a Convolutional Neural Network From Scratch for MNIST Handwritten Digit Classification.
The MNIST handwritten digit classification problem is a standard dataset used in computer vision and deep learning.

Although the dataset is effectively solved, it can be used as the basis for learning and practicing how to develop, evaluate, and use convolutional deep learning neural networks for image classification" />
<meta property="og:url" content="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/" />
<meta property="og:site_name" content="Machine Learning Mastery" />
<meta property="og:image" content="https://machinelearningmastery.com/wp-content/uploads/2019/02/Plot-of-a-Subset-of-Images-from-the-MNIST-Dataset.png" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:description" content="How to Develop a Convolutional Neural Network From Scratch for MNIST Handwritten Digit Classification.
The MNIST handwritten digit classification problem is a standard dataset used in computer vision and deep learning.

Although the dataset is effectively solved, it can be used as the basis for learning and practicing how to develop, evaluate, and use convolutional deep learning neural networks for image classification" />
<meta name="twitter:title" content="How to Develop a CNN for MNIST Handwritten Digit Classification - Machine Learning Mastery" />
<meta property="twitter:image" content="https://machinelearningmastery.com/wp-content/uploads/2019/02/Plot-of-a-Subset-of-Images-from-the-MNIST-Dataset.png" />
    
    <script type="rocketlazyloadscript" data-rocket-type="text/javascript">
        var ajaxurl = 'https://machinelearningmastery.com/wp-admin/admin-ajax.php';
    </script>
<style id="wplmi-inline-css" type="text/css"> span.wplmi-user-avatar { width: 16px;display: inline-block !important;flex-shrink: 0; } img.wplmi-elementor-avatar { border-radius: 100%;margin-right: 3px; } 

</style>

<link rel="preload" as="font" href="https://machinelearningmastery.com/wp-content/themes/canvas-new/includes/fonts/fontawesome-webfont.woff2?v=4.5.0" crossorigin><script type="rocketlazyloadscript" data-rocket-type="text/javascript">
		var advadsCfpQueue = [];
		var advadsCfpAd = function( adID ){
			if ( 'undefined' == typeof advadsProCfp ) { advadsCfpQueue.push( adID ) } else { advadsProCfp.addElement( adID ) }
		};
		</script>
		
<!-- Custom CSS Styling -->
<style type="text/css">
#logo .site-title, #logo .site-description { display:none; }
body {background-repeat:no-repeat;background-position:top left;background-attachment:scroll;border-top:0px solid #000000;}
#header {background-repeat:no-repeat;background-position:left top;margin-top:0px;margin-bottom:0px;padding-top:10px;padding-bottom:10px;border:0px solid ;}
#logo .site-title a {font:bold 40px/1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
#logo .site-description {font:normal 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#999999;}
body, p { font:normal 14px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
h1 { font:bold 28px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h2 { font:bold 24px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h3 { font:bold 20px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h4 { font:bold 16px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h5 { font:bold 14px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h6 { font:bold 12px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }
.page-title, .post .title, .page .title {font:bold 28px/1.1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
.post .title a:link, .post .title a:visited, .page .title a:link, .page .title a:visited {color:#222222}
.post-meta { font:normal 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
.entry, .entry p{ font:normal 15px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.post-more {font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:;border-top:0px solid #e6e6e6;border-bottom:0px solid #e6e6e6;}
#post-author, #connect {border-top:1px solid #e6e6e6;border-bottom:1px solid #e6e6e6;border-left:1px solid #e6e6e6;border-right:1px solid #e6e6e6;border-radius:5px;-moz-border-radius:5px;-webkit-border-radius:5px;background-color:#fafafa}
.nav-entries a, .woo-pagination { font:normal 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#888; }
.woo-pagination a, .woo-pagination a:hover {color:#888!important}
.widget h3 {font:bold 14px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#555555;border-bottom:1px solid #e6e6e6;}
.widget_recent_comments li, #twitter li { border-color: #e6e6e6;}
.widget p, .widget .textwidget { font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.widget {font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555;border-radius:0px;-moz-border-radius:0px;-webkit-border-radius:0px;}
#tabs .inside li a, .widget_woodojo_tabs .tabbable .tab-pane li a { font:bold 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
#tabs .inside li span.meta, .widget_woodojo_tabs .tabbable .tab-pane li span.meta { font:300 11px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
#tabs ul.wooTabs li a, .widget_woodojo_tabs .tabbable .nav-tabs li a { font:300 11px/2em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
@media only screen and (min-width:768px) {
ul.nav li a, #navigation ul.rss a, #navigation ul.cart a.cart-contents, #navigation .cart-contents #navigation ul.rss, #navigation ul.nav-search, #navigation ul.nav-search a { font:bold 15px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#ffffff; } #navigation ul.rss li a:before, #navigation ul.nav-search a.search-contents:before { color:#ffffff;}
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover a, #navigation ul.nav li ul li a, #navigation ul.cart > li:hover > a, #navigation ul.cart > li > ul > div, #navigation ul.cart > li > ul > div p, #navigation ul.cart > li > ul span, #navigation ul.cart .cart_list a, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a { color:#eeeeee!important; }
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover, #navigation ul.nav li ul, #navigation ul.cart li:hover a.cart-contents, #navigation ul.nav-search li:hover a.search-contents, #navigation ul.nav-search a.search-contents + ul, #navigation ul.cart a.cart-contents + ul, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a{background-color:#84abc7!important}
#navigation ul.nav li ul, #navigation ul.cart > li > ul > div  { border: 0px solid #dbdbdb; }
#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation ul.nav > li  { border-right: 0px solid #dbdbdb; }#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation { box-shadow: none; -moz-box-shadow: none; -webkit-box-shadow: none; }#navigation ul li:first-child, #navigation ul li:first-child a { border-radius:0px 0 0 0px; -moz-border-radius:0px 0 0 0px; -webkit-border-radius:0px 0 0 0px; }
#navigation {background:#84abc7;border-top:0px solid #dbdbdb;border-bottom:0px solid #dbdbdb;border-left:0px solid #dbdbdb;border-right:0px solid #dbdbdb;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
#top ul.nav li a { font:normal 12px/1.6em "Helvetica Neue", Helvetica, sans-serif;color:#ddd; }
}
#footer, #footer p { font:normal 13px/1.4em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
#footer {border-top:1px solid #dbdbdb;border-bottom:0px solid ;border-left:0px solid ;border-right:0px solid ;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
.magazine #loopedSlider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-magazine .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.magazine #loopedSlider .content .excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-magazine .slide-content p, .wooslider-theme-magazine .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.magazine .block .post .title a {font:bold 18px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }
#loopedSlider.business-slider .content h2 { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#loopedSlider.business-slider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#wrapper #loopedSlider.business-slider .content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.archive_header { font:bold 18px/1em Arial, sans-serif;color:#222222; }
.archive_header {border-bottom:1px solid #e6e6e6;}
.archive_header .catrss { display:none; }
</style>

<!-- Custom Favicon -->
<link rel="shortcut icon" href="https://machinelearningmastery.com/wp-content/uploads/2019/09/icon-16x16.png"/>
<!-- Options Panel Custom CSS -->
<style type="text/css">
#logo img {
   max-width: 100%;
   height: auto;
}
</style>


<!-- Woo Shortcodes CSS -->


<!-- Custom Stylesheet -->


<!-- Theme version -->
<meta name="generator" content="Canvas 5.9.21" />
<meta name="generator" content="WooFramework 6.2.9" />
<script type="rocketlazyloadscript">
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-44039733-3', 'auto',{'allowLinker': true });
ga('require', 'linker');
ga('linker:autoLink',['samcart.com']);
ga('send', 'pageview');
</script>
<script type="rocketlazyloadscript" async src='https://www.google-analytics.com/analytics.js'></script><link rel="icon" href="https://machinelearningmastery.com/wp-content/uploads/2016/09/cropped-icon-32x32.png" sizes="32x32" />
<link rel="icon" href="https://machinelearningmastery.com/wp-content/uploads/2016/09/cropped-icon-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://machinelearningmastery.com/wp-content/uploads/2016/09/cropped-icon-180x180.png" />
<meta name="msapplication-TileImage" content="https://machinelearningmastery.com/wp-content/uploads/2016/09/cropped-icon-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			.display-posts-listing.image-left .listing-item {
	overflow: hidden; 
	margin-bottom: 30px;
	width: 100%;
}

.display-posts-listing.image-left .image {
	float: left;
	margin: 0 10px 0 0;
}

.display-posts-listing.image-left .attachment-thumbnail {
	height: auto; 
	width: auto; 
	max-width: 50px; 
	max-height: 50px;
	border-radius: 50%;
}

.display-posts-listing.image-left .title {
	display: block;
}

.display-posts-listing.image-left .excerpt-dash { 
	display: none; 
}

.display-posts-listing.image-left {
	margin: 0 0 40px 0;
}		</style>
		<noscript><style id="rocket-lazyload-nojs-css">.rll-youtube-player, [data-lazy-src]{display:none !important;}</style></noscript>	<!-- Facebook Pixel Code -->
<script type="rocketlazyloadscript">
!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '834324500844861');
fbq('track', 'PageView');
</script>
<noscript><img height="1" width="1" style="display:none"
src="https://www.facebook.com/tr?id=834324500844861&ev=PageView&noscript=1"
/></noscript>
<!-- End Facebook Pixel Code -->
	
	
</head>
<body class="post-template-default single single-post postid-7553 single-format-standard chrome alt-style-default two-col-left width-960 two-col-left-960 aa-prefix-machi-">
<div id="wrapper">

	<div id="inner-wrapper">

	<h3 class="nav-toggle icon"><a href="#navigation">Navigation</a></h3>

	<header id="header" class="col-full">

		<div id="logo">
<a href="https://machinelearningmastery.com/" title="Making developers awesome at machine learning"><img width="480" height="80" src="https://machinelearningmastery.com/wp-content/uploads/2019/09/Header_smaller_text_better-1.png" alt="Machine Learning Mastery" /></a>
<span class="site-title"><a href="https://machinelearningmastery.com/">Machine Learning Mastery</a></span>
<span class="site-description">Making developers awesome at machine learning</span>
</div>
	    <div class="header-widget">
	        <div id="custom_html-33" class="widget_text widget widget_custom_html"><div class="textwidget custom-html-widget"><div style="text-align: right;">
	<script type="rocketlazyloadscript" src="https://embed.lpcontent.net/leadboxes/current/embed.js" async defer></script> <a href="" data-leadbox-popup="ENjQkSg3mXWBSzxzvb3R9e" data-leadbox-domain="machinelearningmastery.lpages.co">Click to Take the FREE Computer Vision Crash-Course</a> 
</div></div></div><div id="search-4" class="widget widget_search"><div class="search_main">
    <form method="get" class="searchform" action="https://machinelearningmastery.com/" >
        <input type="text" class="field s" name="s" value="Search..." onfocus="if (!window.__cfRLUnblockHandlers) return false; if (this.value == 'Search...') {this.value = '';}" onblur="if (!window.__cfRLUnblockHandlers) return false; if (this.value == '') {this.value = 'Search...';}" data-cf-modified-46b118dd096b29ef1b5fe745-="" />
		<input type="hidden" name="post_type" value="post" />
        <button type="submit" class="fa fa-search submit" name="submit" value="Search"></button>
    </form>
    <div class="fix"></div>
</div></div>	    </div>
	
	</header>
	<nav id="navigation" class="col-full" role="navigation">

	
	<section class="menus">

		<a href="https://machinelearningmastery.com" class="nav-home"><span>Home</span></a>

	<h3>Main Menu</h3><ul id="main-nav" class="nav fl"><li id="menu-item-6503" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6503"><a href="https://machinelearningmastery.com/start-here/">Get Started</a></li>
<li id="menu-item-6501" class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-6501"><a href="https://machinelearningmastery.com/blog/">Blog</a></li>
<li id="menu-item-6506" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-6506"><a href="#">Topics</a>
<ul class="sub-menu">
	<li id="menu-item-6508" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6508"><a href="https://machinelearningmastery.com/category/deep-learning/">Deep Learning (keras)</a></li>
	<li id="menu-item-7921" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-7921"><a href="https://machinelearningmastery.com/category/deep-learning-for-computer-vision/">Computer Vision</a></li>
	<li id="menu-item-6509" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6509"><a href="https://machinelearningmastery.com/category/deep-learning-time-series/">Neural Net Time Series</a></li>
	<li id="menu-item-6515" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6515"><a href="https://machinelearningmastery.com/category/natural-language-processing/">NLP (Text)</a></li>
	<li id="menu-item-8576" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-8576"><a href="https://machinelearningmastery.com/category/generative-adversarial-networks/">GANs</a></li>
	<li id="menu-item-6511" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6511"><a href="https://machinelearningmastery.com/category/lstm/">LSTMs</a></li>
	<li id="menu-item-7106" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-7106"><a href="https://machinelearningmastery.com/category/better-deep-learning/">Better Deep Learning</a></li>
	<li id="menu-item-6512" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6512"><a href="https://machinelearningmastery.com/category/machine-learning-algorithms/">Intro to Algorithms</a></li>
	<li id="menu-item-6507" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6507"><a href="https://machinelearningmastery.com/category/algorithms-from-scratch/">Code Algorithms</a></li>
	<li id="menu-item-6520" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6520"><a href="https://machinelearningmastery.com/category/time-series/">Intro to Time Series</a></li>
	<li id="menu-item-6516" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6516"><a href="https://machinelearningmastery.com/category/python-machine-learning/">Python (scikit-learn)</a></li>
	<li id="menu-item-11055" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-11055"><a href="https://machinelearningmastery.com/category/ensemble-learning/">Ensemble Learning</a></li>
	<li id="menu-item-9966" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-9966"><a href="https://machinelearningmastery.com/category/imbalanced-classification/">Imbalanced Learning</a></li>
	<li id="menu-item-10674" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-10674"><a href="https://machinelearningmastery.com/category/data-preparation/">Data Preparation</a></li>
	<li id="menu-item-6517" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6517"><a href="https://machinelearningmastery.com/category/r-machine-learning/">R (caret)</a></li>
	<li id="menu-item-6522" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6522"><a href="https://machinelearningmastery.com/category/weka-machine-learning/">Weka (no code)</a></li>
	<li id="menu-item-6510" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6510"><a href="https://machinelearningmastery.com/category/linear-algebra/">Linear Algebra</a></li>
	<li id="menu-item-6519" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6519"><a href="https://machinelearningmastery.com/category/statistical-methods/">Statistics</a></li>
	<li id="menu-item-12825" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-12825"><a href="https://machinelearningmastery.com/category/optimization/">Optimization</a></li>
	<li id="menu-item-8989" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-8989"><a href="https://machinelearningmastery.com/category/probability/">Probability</a></li>
	<li id="menu-item-6523" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6523"><a href="https://machinelearningmastery.com/category/xgboost/">XGBoost</a></li>
</ul>
</li>
<li id="menu-item-6502" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6502"><a href="https://machinelearningmastery.com/products/">EBooks</a></li>
<li id="menu-item-6500" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6500"><a href="https://machinelearningmastery.com/faq/">FAQ</a></li>
<li id="menu-item-6504" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6504"><a href="https://machinelearningmastery.com/about/">About</a></li>
<li id="menu-item-6505" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6505"><a href="https://machinelearningmastery.com/contact/">Contact</a></li>
</ul>	<div class="side-nav">
		</div><!-- /#side-nav -->

	</section><!-- /.menus -->

	<a href="#top" class="nav-close"><span>Return to Content</span></a>

</nav>
<!--<div style="width:100%; height:90px; padding-top:10px; padding-bottom:50px; float:center;">[the_ad_placement id="header"]</div>-->       
    <!-- #content Starts -->
	    <div id="content" class="col-full">
    
    	<div id="main-sidebar-container">    

            <!-- #main Starts -->
                        <section id="main">                       
<article class="post-7553 post type-post status-publish format-standard has-post-thumbnail hentry category-deep-learning-for-computer-vision">
	
	<header>
	<h1 class="title entry-title">How to Develop a CNN for MNIST Handwritten Digit Classification</h1>	</header>
<div class="post-meta"><span class="small">By</span> <span class="author vcard"><span class="fn"><a href="https://machinelearningmastery.com/author/jasonb/" title="Posts by Jason Brownlee" rel="author">Jason Brownlee</a></span></span> <span class="small">on</span> <abbr class="date time published updated" title="2019-05-08T05:00:02+1000">May 8, 2019</abbr>  <span class="small">in</span> <span class="categories"><a href="https://machinelearningmastery.com/category/deep-learning-for-computer-vision/" title="View all items in Deep Learning for Computer Vision">Deep Learning for Computer Vision</a></span>  </div>
	<section class="entry">
<div class="simplesocialbuttons simplesocial-simple-icons simplesocialbuttons_inline simplesocialbuttons-align-left post-7553 post  simplesocialbuttons-inline-no-animation">
<button class="ssb_tweet-icon" data-href="https://twitter.com/share?text=How+to+Develop+a+CNN+for+MNIST+Handwritten+Digit+Classification&url=https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/" rel="nofollow" onclick="if (!window.__cfRLUnblockHandlers) return false; javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" data-cf-modified-46b118dd096b29ef1b5fe745-="">
						<span class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 72 72"><path fill="none" d="M0 0h72v72H0z"/><path class="icon" fill="#fff" d="M68.812 15.14c-2.348 1.04-4.87 1.744-7.52 2.06 2.704-1.62 4.78-4.186 5.757-7.243-2.53 1.5-5.33 2.592-8.314 3.176C56.35 10.59 52.948 9 49.182 9c-7.23 0-13.092 5.86-13.092 13.093 0 1.026.118 2.02.338 2.98C25.543 24.527 15.9 19.318 9.44 11.396c-1.125 1.936-1.77 4.184-1.77 6.58 0 4.543 2.312 8.552 5.824 10.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163 0 6.345 4.513 11.638 10.504 12.84-1.1.298-2.256.457-3.45.457-.845 0-1.666-.078-2.464-.23 1.667 5.2 6.5 8.985 12.23 9.09-4.482 3.51-10.13 5.605-16.26 5.605-1.055 0-2.096-.06-3.122-.184 5.794 3.717 12.676 5.882 20.067 5.882 24.083 0 37.25-19.95 37.25-37.25 0-.565-.013-1.133-.038-1.693 2.558-1.847 4.778-4.15 6.532-6.774z"/></svg></span><i class="simplesocialtxt">Tweet </i></button>
		<button class="ssb_fbshare-icon" target="_blank" data-href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/" onclick="if (!window.__cfRLUnblockHandlers) return false; javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" data-cf-modified-46b118dd096b29ef1b5fe745-="">
						<span class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" class="_1pbq" color="#ffffff"><path fill="#ffffff" fill-rule="evenodd" class="icon" d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z"></path></svg></span>
						<span class="simplesocialtxt">Share </span> </button>
<button class="ssb_linkedin-icon" data-href="https://www.linkedin.com/cws/share?url=https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/" onclick="if (!window.__cfRLUnblockHandlers) return false; javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" data-cf-modified-46b118dd096b29ef1b5fe745-="">
						<span class="icon"> <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="15px" height="14.1px" viewBox="-301.4 387.5 15 14.1" enable-background="new -301.4 387.5 15 14.1" xml:space="preserve"> <g id="XMLID_398_"> <path id="XMLID_399_" fill="#FFFFFF" d="M-296.2,401.6c0-3.2,0-6.3,0-9.5h0.1c1,0,2,0,2.9,0c0.1,0,0.1,0,0.1,0.1c0,0.4,0,0.8,0,1.2 c0.1-0.1,0.2-0.3,0.3-0.4c0.5-0.7,1.2-1,2.1-1.1c0.8-0.1,1.5,0,2.2,0.3c0.7,0.4,1.2,0.8,1.5,1.4c0.4,0.8,0.6,1.7,0.6,2.5 c0,1.8,0,3.6,0,5.4v0.1c-1.1,0-2.1,0-3.2,0c0-0.1,0-0.1,0-0.2c0-1.6,0-3.2,0-4.8c0-0.4,0-0.8-0.2-1.2c-0.2-0.7-0.8-1-1.6-1 c-0.8,0.1-1.3,0.5-1.6,1.2c-0.1,0.2-0.1,0.5-0.1,0.8c0,1.7,0,3.4,0,5.1c0,0.2,0,0.2-0.2,0.2c-1,0-1.9,0-2.9,0 C-296.1,401.6-296.2,401.6-296.2,401.6z"/> <path id="XMLID_400_" fill="#FFFFFF" d="M-298,401.6L-298,401.6c-1.1,0-2.1,0-3,0c-0.1,0-0.1,0-0.1-0.1c0-3.1,0-6.1,0-9.2 c0-0.1,0-0.1,0.1-0.1c1,0,2,0,2.9,0h0.1C-298,395.3-298,398.5-298,401.6z"/> <path id="XMLID_401_" fill="#FFFFFF" d="M-299.6,390.9c-0.7-0.1-1.2-0.3-1.6-0.8c-0.5-0.8-0.2-2.1,1-2.4c0.6-0.2,1.2-0.1,1.8,0.2 c0.5,0.4,0.7,0.9,0.6,1.5c-0.1,0.7-0.5,1.1-1.1,1.3C-299.1,390.8-299.4,390.8-299.6,390.9L-299.6,390.9z"/> </g> </svg> </span>
						<span class="simplesocialtxt">Share</span> </button>
</div>
<p id="last-modified-info">Last Updated on November 14, 2021</p>
<h4 style="text-align: center;">How to Develop a Convolutional Neural Network From Scratch for MNIST Handwritten Digit Classification.</h4>
<p>The MNIST handwritten digit classification problem is a standard dataset used in computer vision and deep learning.</p>
<p>Although the dataset is effectively solved, it can be used as the basis for learning and practicing how to develop, evaluate, and use convolutional deep learning neural networks for image classification from scratch. This includes how to develop a robust test harness for estimating the performance of the model, how to explore improvements to the model, and how to save the model and later load it to make predictions on new data.</p>
<p>In this tutorial, you will discover how to develop a convolutional neural network for handwritten digit classification from scratch.</p>
<p>After completing this tutorial, you will know:</p>
<ul>
<li>How to develop a test harness to develop a robust evaluation of a model and establish a baseline of performance for a classification task.</li>
<li>How to explore extensions to a baseline model to improve learning and model capacity.</li>
<li>How to develop a finalized model, evaluate the performance of the final model, and use it to make predictions on new images.</li>
</ul>
<p><strong>Kick-start your project</strong> with my new book <a href="https://machinelearningmastery.com/deep-learning-for-computer-vision/">Deep Learning for Computer Vision</a>, including <em>step-by-step tutorials</em> and the <em>Python source code</em> files for all examples.</p>
<p>Let’s get started.</p>
<ul>
<li><strong>Updated Dec/2019</strong>: Updated examples for TensorFlow 2.0 and Keras 2.3.</li>
<li><strong>Updated Jan/2020</strong>: Fixed a bug where models were defined outside the cross-validation loop.</li>
<li><strong>Updated Nov/2021</strong>: Updated to use Tensorflow 2.6</li>
</ul>
<div id="attachment_7563" style="width: 650px" class="wp-caption aligncenter"><img aria-describedby="caption-attachment-7563" loading="lazy" class="size-full wp-image-7563" src="https://machinelearningmastery.com/wp-content/uploads/2019/05/How-to-Develop-a-Convolutional-Neural-Network-From-Scratch-for-MNIST-Handwritten-Digit-Classification.jpg" alt="How to Develop a Convolutional Neural Network From Scratch for MNIST Handwritten Digit Classification" width="640" height="426" srcset="https://machinelearningmastery.com/wp-content/uploads/2019/05/How-to-Develop-a-Convolutional-Neural-Network-From-Scratch-for-MNIST-Handwritten-Digit-Classification.jpg 640w, https://machinelearningmastery.com/wp-content/uploads/2019/05/How-to-Develop-a-Convolutional-Neural-Network-From-Scratch-for-MNIST-Handwritten-Digit-Classification-300x200.jpg 300w" sizes="(max-width: 640px) 100vw, 640px" /><p id="caption-attachment-7563" class="wp-caption-text">How to Develop a Convolutional Neural Network From Scratch for MNIST Handwritten Digit Classification<br />Photo by <a href="https://www.flickr.com/photos/geographyalltheway_photos/2918451763/">Richard Allaway</a>, some rights reserved.</p></div>
<h2>Tutorial Overview</h2>
<p>This tutorial is divided into five parts; they are:</p>
<ol>
<li>MNIST Handwritten Digit Classification Dataset</li>
<li>Model Evaluation Methodology</li>
<li>How to Develop a Baseline Model</li>
<li>How to Develop an Improved Model</li>
<li>How to Finalize the Model and Make Predictions</li>
</ol>
<div class="woo-sc-hr"></div>
<center>
<h3>Want Results with Deep Learning for Computer Vision?</h3>
<p>Take my free 7-day email crash course now (with sample code).</p>
<p>Click to sign-up and also get a free PDF Ebook version of the course.</p>
<p><script type="rocketlazyloadscript" src="https://embed.lpcontent.net/leadboxes/current/embed.js" async defer></script> <button data-leadbox-popup="3wpm2NEBjgVJVkjQop9L9Y" data-leadbox-domain="machinelearningmastery.lpages.co" style="background: rgb(255, 215, 18);border-color: rgb(255, 215, 18);border-radius: 20px;color: #FFFFFF;display: inline-block;vertical-align: middle;padding: 16px 32px;min-width: 192px;border: 1px solid rgb(255, 215, 18);font-size: 1rem;font-family: Helvetica, Arial, sans-serif;text-align: center;outline: 0;line-height: 1;cursor: pointer;-webkit-transition: background 0.3s, color 0.3s, border 0.3s;transition: background 0.3s, color 0.3s, border 0.3s;  box-shadow: 0px 2px 5px rgba(0, 0, 0, 0.6);">Click here to subscribe</button> </p>
</center>
<div class="woo-sc-hr"></div>
<h3>Development Environment</h3>
<p>This tutorial assumes that you are using standalone Keras running on top of TensorFlow with Python 3. If you need help setting up your development environment see this tutorial:</p>
<ul>
<li><a href="https://machinelearningmastery.com/setup-python-environment-machine-learning-deep-learning-anaconda/">How to Setup Your Python Environment for Machine Learning with Anaconda</a></li>
</ul>
<h2>MNIST Handwritten Digit Classification Dataset</h2>
<p>The <a href="https://en.wikipedia.org/wiki/MNIST_database">MNIST dataset</a> is an acronym that stands for the Modified National Institute of Standards and Technology dataset.</p>
<p>It is a dataset of 60,000 small square 28&#215;28 pixel grayscale images of handwritten single digits between 0 and 9.</p>
<p>The task is to classify a given image of a handwritten digit into one of 10 classes representing integer values from 0 to 9, inclusively.</p>
<p>It is a widely used and deeply understood dataset and, for the most part, is &#8220;<em>solved</em>.&#8221; Top-performing models are deep learning convolutional neural networks that achieve a classification accuracy of above 99%, with an error rate between 0.4 %and 0.2% on the hold out test dataset.</p>
<p>The example below loads the MNIST dataset using the Keras API and creates a plot of the first nine images in the training dataset.</p>
		<div id="urvanov-syntax-highlighter-619c550b940ac204101529" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# example of loading the mnist dataset
from tensorflow.keras.datasets import mnist
from matplotlib import pyplot as plt
# load dataset
(trainX, trainy), (testX, testy) = mnist.load_data()
# summarize loaded dataset
print('Train: X=%s, y=%s' % (trainX.shape, trainy.shape))
print('Test: X=%s, y=%s' % (testX.shape, testy.shape))
# plot first few images
for i in range(9):
	# define subplot
	plt.subplot(330 + 1 + i)
	# plot raw pixel data
	plt.imshow(trainX[i], cmap=plt.get_cmap('gray'))
# show the figure
plt.show()</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940ac204101529-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940ac204101529-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940ac204101529-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940ac204101529-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940ac204101529-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940ac204101529-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940ac204101529-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940ac204101529-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940ac204101529-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940ac204101529-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940ac204101529-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940ac204101529-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940ac204101529-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940ac204101529-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940ac204101529-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940ac204101529-16">16</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940ac204101529-1"><span class="crayon-p"># example of loading the mnist dataset</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940ac204101529-2"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">datasets </span><span class="crayon-e">import </span><span class="crayon-e">mnist</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940ac204101529-3"><span class="crayon-e">from </span><span class="crayon-e">matplotlib </span><span class="crayon-e">import </span><span class="crayon-e">pyplot </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-i">plt</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940ac204101529-4"><span class="crayon-p"># load dataset</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940ac204101529-5"><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainy</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testy</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">mnist</span><span class="crayon-sy">.</span><span class="crayon-e">load_data</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940ac204101529-6"><span class="crayon-p"># summarize loaded dataset</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940ac204101529-7"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Train: X=%s, y=%s'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainy</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940ac204101529-8"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Test: X=%s, y=%s'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testy</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940ac204101529-9"><span class="crayon-p"># plot first few images</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940ac204101529-10"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">9</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940ac204101529-11"><span class="crayon-h">	</span><span class="crayon-p"># define subplot</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940ac204101529-12"><span class="crayon-h">	</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-cn">330</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940ac204101529-13"><span class="crayon-h">	</span><span class="crayon-p"># plot raw pixel data</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940ac204101529-14"><span class="crayon-h">	</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">imshow</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cmap</span><span class="crayon-o">=</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">get_cmap</span><span class="crayon-sy">(</span><span class="crayon-s">'gray'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940ac204101529-15"><span class="crayon-p"># show the figure</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940ac204101529-16"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>Running the example loads the MNIST train and test dataset and prints their shape.</p>
<p>We can see that there are 60,000 examples in the training dataset and 10,000 in the test dataset and that images are indeed square with 28&#215;28 pixels.</p>
		<div id="urvanov-syntax-highlighter-619c550b940b2517109998" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
Train: X=(60000, 28, 28), y=(60000,)
Test: X=(10000, 28, 28), y=(10000,)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940b2517109998-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940b2517109998-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940b2517109998-1">Train: X=(60000, 28, 28), y=(60000,)</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940b2517109998-2">Test: X=(10000, 28, 28), y=(10000,)</div></div></td>
					</tr>
				</table>
			</div>
		</div><p>A plot of the first nine images in the dataset is also created showing the natural handwritten nature of the images to be classified.</p>
<div id="attachment_7555" style="width: 1034px" class="wp-caption aligncenter"><img aria-describedby="caption-attachment-7555" loading="lazy" class="size-large wp-image-7555" src="https://machinelearningmastery.com/wp-content/uploads/2019/02/Plot-of-a-Subset-of-Images-from-the-MNIST-Dataset-1024x768.png" alt="Plot of a Subset of Images From the MNIST Dataset" width="1024" height="768" srcset="https://machinelearningmastery.com/wp-content/uploads/2019/02/Plot-of-a-Subset-of-Images-from-the-MNIST-Dataset-1024x768.png 1024w, https://machinelearningmastery.com/wp-content/uploads/2019/02/Plot-of-a-Subset-of-Images-from-the-MNIST-Dataset-300x225.png 300w, https://machinelearningmastery.com/wp-content/uploads/2019/02/Plot-of-a-Subset-of-Images-from-the-MNIST-Dataset-768x576.png 768w, https://machinelearningmastery.com/wp-content/uploads/2019/02/Plot-of-a-Subset-of-Images-from-the-MNIST-Dataset.png 1280w" sizes="(max-width: 1024px) 100vw, 1024px" /><p id="caption-attachment-7555" class="wp-caption-text">Plot of a Subset of Images From the MNIST Dataset</p></div>
<h2>Model Evaluation Methodology</h2>
<p>Although the MNIST dataset is effectively solved, it can be a useful starting point for developing and practicing a methodology for solving image classification tasks using convolutional neural networks.</p>
<p>Instead of reviewing the literature on well-performing models on the dataset, we can develop a new model from scratch.</p>
<p>The dataset already has a well-defined train and test dataset that we can use.</p>
<p>In order to estimate the performance of a model for a given training run, we can further split the training set into a train and validation dataset. Performance on the train and validation dataset over each run can then be plotted to provide learning curves and insight into how well a model is learning the problem.</p>
<p>The Keras API supports this by specifying the &#8220;<em>validation_data</em>&#8221; argument to the <em>model.fit()</em> function when training the model, that will, in turn, return an object that describes model performance for the chosen loss and metrics on each training epoch.</p>
		<div id="urvanov-syntax-highlighter-619c550b940b3913736942" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# record model performance on a validation dataset during training
history = model.fit(..., validation_data=(valX, valY))</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940b3913736942-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940b3913736942-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940b3913736942-1"><span class="crayon-p"># record model performance on a validation dataset during training</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940b3913736942-2"><span class="crayon-v">history</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">validation_data</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">valX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">valY</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>In order to estimate the performance of a model on the problem in general, we can use <a href="https://machinelearningmastery.com/k-fold-cross-validation/">k-fold cross-validation</a>, perhaps five-fold cross-validation. This will give some account of the models variance with both respect to differences in the training and test datasets, and in terms of the stochastic nature of the learning algorithm. The performance of a model can be taken as the mean performance across k-folds, given the standard deviation, that could be used to estimate a confidence interval if desired.</p>
<p>We can use the <a href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.KFold.html">KFold class</a> from the scikit-learn API to implement the k-fold cross-validation evaluation of a given neural network model. There are many ways to achieve this, although we can choose a flexible approach where the <em>KFold</em> class is only used to specify the row indexes used for each spit.</p>
		<div id="urvanov-syntax-highlighter-619c550b940b4846966559" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# example of k-fold cv for a neural net
data = ...
# prepare cross validation
kfold = KFold(5, shuffle=True, random_state=1)
# enumerate splits
for train_ix, test_ix in kfold.split(data):
        model = ...
	...</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940b4846966559-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940b4846966559-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940b4846966559-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940b4846966559-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940b4846966559-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940b4846966559-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940b4846966559-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940b4846966559-8">8</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940b4846966559-1"><span class="crayon-p"># example of k-fold cv for a neural net</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940b4846966559-2"><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940b4846966559-3"><span class="crayon-p"># prepare cross validation</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940b4846966559-4"><span class="crayon-v">kfold</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">KFold</span><span class="crayon-sy">(</span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">shuffle</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">random_state</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940b4846966559-5"><span class="crayon-p"># enumerate splits</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940b4846966559-6"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">train_ix</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">test_ix </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">kfold</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940b4846966559-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940b4846966559-8"><span class="crayon-h">	</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>We will hold back the actual test dataset and use it as an evaluation of our final model.</p>
<h2>How to Develop a Baseline Model</h2>
<p>The first step is to develop a baseline model.</p>
<p>This is critical as it both involves developing the infrastructure for the test harness so that any model we design can be evaluated on the dataset, and it establishes a baseline in model performance on the problem, by which all improvements can be compared.</p>
<p>The design of the test harness is modular, and we can develop a separate function for each piece. This allows a given aspect of the test harness to be modified or inter-changed, if we desire, separately from the rest.</p>
<p>We can develop this test harness with five key elements. They are the loading of the dataset, the preparation of the dataset, the definition of the model, the evaluation of the model, and the presentation of results.</p>
<h3>Load Dataset</h3>
<p>We know some things about the dataset.</p>
<p>For example, we know that the images are all pre-aligned (e.g. each image only contains a hand-drawn digit), that the images all have the same square size of 28&#215;28 pixels, and that the images are grayscale.</p>
<p>Therefore, we can load the images and reshape the data arrays to have a single color channel.</p>
		<div id="urvanov-syntax-highlighter-619c550b940b5195494896" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# load dataset
(trainX, trainY), (testX, testY) = mnist.load_data()
# reshape dataset to have a single channel
trainX = trainX.reshape((trainX.shape[0], 28, 28, 1))
testX = testX.reshape((testX.shape[0], 28, 28, 1))</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940b5195494896-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940b5195494896-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940b5195494896-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940b5195494896-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940b5195494896-5">5</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940b5195494896-1"><span class="crayon-p"># load dataset</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940b5195494896-2"><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testY</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">mnist</span><span class="crayon-sy">.</span><span class="crayon-e">load_data</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940b5195494896-3"><span class="crayon-p"># reshape dataset to have a single channel</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940b5195494896-4"><span class="crayon-v">trainX</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">trainX</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940b5195494896-5"><span class="crayon-v">testX</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>We also know that there are 10 classes and that classes are represented as unique integers.</p>
<p>We can, therefore, use a one hot encoding for the class element of each sample, transforming the integer into a 10 element binary vector with a 1 for the index of the class value, and 0 values for all other classes. We can achieve this with the <em>to_categorical()</em> utility function.</p>
		<div id="urvanov-syntax-highlighter-619c550b940b6242370839" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# one hot encode target values
trainY = to_categorical(trainY)
testY = to_categorical(testY)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940b6242370839-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940b6242370839-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940b6242370839-3">3</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940b6242370839-1"><span class="crayon-p"># one hot encode target values</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940b6242370839-2"><span class="crayon-v">trainY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">to_categorical</span><span class="crayon-sy">(</span><span class="crayon-v">trainY</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940b6242370839-3"><span class="crayon-v">testY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">to_categorical</span><span class="crayon-sy">(</span><span class="crayon-v">testY</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>The <em>load_dataset()</em> function implements these behaviors and can be used to load the dataset.</p>
		<div id="urvanov-syntax-highlighter-619c550b940b7810585586" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# load train and test dataset
def load_dataset():
	# load dataset
	(trainX, trainY), (testX, testY) = mnist.load_data()
	# reshape dataset to have a single channel
	trainX = trainX.reshape((trainX.shape[0], 28, 28, 1))
	testX = testX.reshape((testX.shape[0], 28, 28, 1))
	# one hot encode target values
	trainY = to_categorical(trainY)
	testY = to_categorical(testY)
	return trainX, trainY, testX, testY</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940b7810585586-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940b7810585586-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940b7810585586-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940b7810585586-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940b7810585586-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940b7810585586-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940b7810585586-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940b7810585586-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940b7810585586-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940b7810585586-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940b7810585586-11">11</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940b7810585586-1"><span class="crayon-p"># load train and test dataset</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940b7810585586-2"><span class="crayon-e">def </span><span class="crayon-e">load_dataset</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940b7810585586-3"><span class="crayon-h">	</span><span class="crayon-p"># load dataset</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940b7810585586-4"><span class="crayon-h">	</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testY</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">mnist</span><span class="crayon-sy">.</span><span class="crayon-e">load_data</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940b7810585586-5"><span class="crayon-h">	</span><span class="crayon-p"># reshape dataset to have a single channel</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940b7810585586-6"><span class="crayon-h">	</span><span class="crayon-v">trainX</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">trainX</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940b7810585586-7"><span class="crayon-h">	</span><span class="crayon-v">testX</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940b7810585586-8"><span class="crayon-h">	</span><span class="crayon-p"># one hot encode target values</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940b7810585586-9"><span class="crayon-h">	</span><span class="crayon-v">trainY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">to_categorical</span><span class="crayon-sy">(</span><span class="crayon-v">trainY</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940b7810585586-10"><span class="crayon-h">	</span><span class="crayon-v">testY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">to_categorical</span><span class="crayon-sy">(</span><span class="crayon-v">testY</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940b7810585586-11"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testY</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p></p>
<h3>Prepare Pixel Data</h3>
<p>We know that the pixel values for each image in the dataset are unsigned integers in the range between black and white, or 0 and 255.</p>
<p>We do not know the best way to scale the pixel values for modeling, but we know that some scaling will be required.</p>
<p>A good starting point is to <a href="https://machinelearningmastery.com/how-to-normalize-center-and-standardize-images-with-the-imagedatagenerator-in-keras/">normalize the pixel values</a> of grayscale images, e.g. rescale them to the range [0,1]. This involves first converting the data type from unsigned integers to floats, then dividing the pixel values by the maximum value.</p>
		<div id="urvanov-syntax-highlighter-619c550b940b8924513836" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# convert from integers to floats
train_norm = train.astype('float32')
test_norm = test.astype('float32')
# normalize to range 0-1
train_norm = train_norm / 255.0
test_norm = test_norm / 255.0</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940b8924513836-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940b8924513836-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940b8924513836-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940b8924513836-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940b8924513836-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940b8924513836-6">6</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940b8924513836-1"><span class="crayon-p"># convert from integers to floats</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940b8924513836-2"><span class="crayon-v">train_norm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940b8924513836-3"><span class="crayon-v">test_norm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940b8924513836-4"><span class="crayon-p"># normalize to range 0-1</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940b8924513836-5"><span class="crayon-v">train_norm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">train_norm</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">255.0</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940b8924513836-6"><span class="crayon-v">test_norm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">test_norm</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">255.0</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>The <em>prep_pixels()</em> function below implements these behaviors and is provided with the pixel values for both the train and test datasets that will need to be scaled.</p>
		<div id="urvanov-syntax-highlighter-619c550b940b9829556579" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# scale pixels
def prep_pixels(train, test):
	# convert from integers to floats
	train_norm = train.astype('float32')
	test_norm = test.astype('float32')
	# normalize to range 0-1
	train_norm = train_norm / 255.0
	test_norm = test_norm / 255.0
	# return normalized images
	return train_norm, test_norm</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940b9829556579-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940b9829556579-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940b9829556579-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940b9829556579-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940b9829556579-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940b9829556579-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940b9829556579-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940b9829556579-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940b9829556579-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940b9829556579-10">10</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940b9829556579-1"><span class="crayon-p"># scale pixels</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940b9829556579-2"><span class="crayon-e">def </span><span class="crayon-e">prep_pixels</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940b9829556579-3"><span class="crayon-h">	</span><span class="crayon-p"># convert from integers to floats</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940b9829556579-4"><span class="crayon-h">	</span><span class="crayon-v">train_norm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940b9829556579-5"><span class="crayon-h">	</span><span class="crayon-v">test_norm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940b9829556579-6"><span class="crayon-h">	</span><span class="crayon-p"># normalize to range 0-1</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940b9829556579-7"><span class="crayon-h">	</span><span class="crayon-v">train_norm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">train_norm</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">255.0</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940b9829556579-8"><span class="crayon-h">	</span><span class="crayon-v">test_norm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">test_norm</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">255.0</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940b9829556579-9"><span class="crayon-h">	</span><span class="crayon-p"># return normalized images</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940b9829556579-10"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">train_norm</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_norm</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>This function must be called to prepare the pixel values prior to any modeling.</p>
<h3>Define Model</h3>
<p>Next, we need to define a baseline convolutional neural network model for the problem.</p>
<p>The model has two main aspects: the feature extraction front end comprised of convolutional and pooling layers, and the classifier backend that will make a prediction.</p>
<p>For the convolutional front-end, we can start with a single <a href="https://machinelearningmastery.com/convolutional-layers-for-deep-learning-neural-networks/">convolutional layer</a> with a small filter size (3,3) and a modest number of filters (32) followed by a <a href="https://machinelearningmastery.com/pooling-layers-for-convolutional-neural-networks/">max pooling layer</a>. The filter maps can then be flattened to provide features to the classifier.</p>
<p>Given that the problem is a multi-class classification task, we know that we will require an output layer with 10 nodes in order to predict the probability distribution of an image belonging to each of the 10 classes. This will also require the use of a softmax activation function. Between the feature extractor and the output layer, we can add a dense layer to interpret the features, in this case with 100 nodes.</p>
<p>All layers will use the <a href="https://machinelearningmastery.com/rectified-linear-activation-function-for-deep-learning-neural-networks/">ReLU activation function</a> and the He weight initialization scheme, both best practices.</p>
<p>We will use a conservative configuration for the stochastic gradient descent optimizer with a <a href="https://machinelearningmastery.com/understand-the-dynamics-of-learning-rate-on-deep-learning-neural-networks/">learning rate</a> of 0.01 and a momentum of 0.9. The <a href="https://machinelearningmastery.com/cross-entropy-for-machine-learning/">categorical cross-entropy</a> loss function will be optimized, suitable for multi-class classification, and we will monitor the classification accuracy metric, which is appropriate given we have the same number of examples in each of the 10 classes.</p>
<p>The <em>define_model()</em> function below will define and return this model.</p>
		<div id="urvanov-syntax-highlighter-619c550b940ba075170862" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# define cnn model
def define_model():
	model = Sequential()
	model.add(Conv2D(32, (3, 3), activation='relu', kernel_initializer='he_uniform', input_shape=(28, 28, 1)))
	model.add(MaxPooling2D((2, 2)))
	model.add(Flatten())
	model.add(Dense(100, activation='relu', kernel_initializer='he_uniform'))
	model.add(Dense(10, activation='softmax'))
	# compile model
	opt = SGD(learning_rate=0.01, momentum=0.9)
	model.compile(optimizer=opt, loss='categorical_crossentropy', metrics=['accuracy'])
	return model</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940ba075170862-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940ba075170862-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940ba075170862-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940ba075170862-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940ba075170862-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940ba075170862-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940ba075170862-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940ba075170862-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940ba075170862-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940ba075170862-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940ba075170862-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940ba075170862-12">12</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940ba075170862-1"><span class="crayon-p"># define cnn model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940ba075170862-2"><span class="crayon-e">def </span><span class="crayon-e">define_model</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940ba075170862-3"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940ba075170862-4"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">32</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'he_uniform'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940ba075170862-5"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">MaxPooling2D</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940ba075170862-6"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Flatten</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940ba075170862-7"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'he_uniform'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940ba075170862-8"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'softmax'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940ba075170862-9"><span class="crayon-h">	</span><span class="crayon-p"># compile model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940ba075170862-10"><span class="crayon-h">	</span><span class="crayon-v">opt</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">SGD</span><span class="crayon-sy">(</span><span class="crayon-v">learning_rate</span><span class="crayon-o">=</span><span class="crayon-cn">0.01</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">momentum</span><span class="crayon-o">=</span><span class="crayon-cn">0.9</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940ba075170862-11"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-v">opt</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'categorical_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940ba075170862-12"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">model</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p></p>
<h3>Evaluate Model</h3>
<p>After the model is defined, we need to evaluate it.</p>
<p>The model will be evaluated using <a href="https://machinelearningmastery.com/k-fold-cross-validation/">five-fold cross-validation</a>. The value of <em>k=5</em> was chosen to provide a baseline for both repeated evaluation and to not be so large as to require a long running time. Each test set will be 20% of the training dataset, or about 12,000 examples, close to the size of the actual test set for this problem.</p>
<p>The training dataset is shuffled prior to being split, and the sample shuffling is performed each time, so that any model we evaluate will have the same train and test datasets in each fold, providing an apples-to-apples comparison between models.</p>
<p>We will train the baseline model for a modest 10 training epochs with a default batch size of 32 examples. The test set for each fold will be used to evaluate the model both during each epoch of the training run, so that we can later create learning curves, and at the end of the run, so that we can estimate the performance of the model. As such, we will keep track of the resulting history from each run, as well as the classification accuracy of the fold.</p>
<p>The <em>evaluate_model()</em> function below implements these behaviors, taking the training dataset as arguments and returning a list of accuracy scores and training histories that can be later summarized.</p>
		<div id="urvanov-syntax-highlighter-619c550b940bb077918309" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# evaluate a model using k-fold cross-validation
def evaluate_model(dataX, dataY, n_folds=5):
	scores, histories = list(), list()
	# prepare cross validation
	kfold = KFold(n_folds, shuffle=True, random_state=1)
	# enumerate splits
	for train_ix, test_ix in kfold.split(dataX):
		# define model
		model = define_model()
		# select rows for train and test
		trainX, trainY, testX, testY = dataX[train_ix], dataY[train_ix], dataX[test_ix], dataY[test_ix]
		# fit model
		history = model.fit(trainX, trainY, epochs=10, batch_size=32, validation_data=(testX, testY), verbose=0)
		# evaluate model
		_, acc = model.evaluate(testX, testY, verbose=0)
		print('&gt; %.3f' % (acc * 100.0))
		# stores scores
		scores.append(acc)
		histories.append(history)
	return scores, histories</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bb077918309-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bb077918309-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bb077918309-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bb077918309-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bb077918309-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bb077918309-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bb077918309-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bb077918309-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bb077918309-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bb077918309-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bb077918309-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bb077918309-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bb077918309-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bb077918309-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bb077918309-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bb077918309-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bb077918309-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bb077918309-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bb077918309-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bb077918309-20">20</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bb077918309-1"><span class="crayon-p"># evaluate a model using k-fold cross-validation</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bb077918309-2"><span class="crayon-e">def </span><span class="crayon-e">evaluate_model</span><span class="crayon-sy">(</span><span class="crayon-v">dataX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_folds</span><span class="crayon-o">=</span><span class="crayon-cn">5</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bb077918309-3"><span class="crayon-h">	</span><span class="crayon-v">scores</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">histories</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bb077918309-4"><span class="crayon-h">	</span><span class="crayon-p"># prepare cross validation</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bb077918309-5"><span class="crayon-h">	</span><span class="crayon-v">kfold</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">KFold</span><span class="crayon-sy">(</span><span class="crayon-v">n_folds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">shuffle</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">random_state</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bb077918309-6"><span class="crayon-h">	</span><span class="crayon-p"># enumerate splits</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bb077918309-7"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">train_ix</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">test_ix </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">kfold</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-v">dataX</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bb077918309-8"><span class="crayon-h">		</span><span class="crayon-p"># define model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bb077918309-9"><span class="crayon-h">		</span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">define_model</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bb077918309-10"><span class="crayon-h">		</span><span class="crayon-p"># select rows for train and test</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bb077918309-11"><span class="crayon-h">		</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataX</span><span class="crayon-sy">[</span><span class="crayon-v">train_ix</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataY</span><span class="crayon-sy">[</span><span class="crayon-v">train_ix</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataX</span><span class="crayon-sy">[</span><span class="crayon-v">test_ix</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataY</span><span class="crayon-sy">[</span><span class="crayon-v">test_ix</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bb077918309-12"><span class="crayon-h">		</span><span class="crayon-p"># fit model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bb077918309-13"><span class="crayon-h">		</span><span class="crayon-v">history</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">32</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">validation_data</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testY</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bb077918309-14"><span class="crayon-h">		</span><span class="crayon-p"># evaluate model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bb077918309-15"><span class="crayon-h">		</span><span class="crayon-v">_</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">acc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">evaluate</span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bb077918309-16"><span class="crayon-h">		</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'&gt; %.3f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e ">acc *</span><span class="crayon-h"> </span><span class="crayon-cn">100.0</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bb077918309-17"><span class="crayon-h">		</span><span class="crayon-p"># stores scores</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bb077918309-18"><span class="crayon-h">		</span><span class="crayon-v">scores</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">acc</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bb077918309-19"><span class="crayon-h">		</span><span class="crayon-v">histories</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">history</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bb077918309-20"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">histories</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p></p>
<h3>Present Results</h3>
<p>Once the model has been evaluated, we can present the results.</p>
<p>There are two key aspects to present: the diagnostics of the learning behavior of the model during training and the estimation of the model performance. These can be implemented using separate functions.</p>
<p>First, the diagnostics involve creating a line plot showing model performance on the train and test set during each fold of the k-fold cross-validation. These plots are valuable for getting an idea of whether a model is overfitting, underfitting, or has a good fit for the dataset.</p>
<p>We will create a single figure with two subplots, one for loss and one for accuracy. Blue lines will indicate model performance on the training dataset and orange lines will indicate performance on the hold out test dataset. The <em>summarize_diagnostics()</em> function below creates and shows this plot given the collected training histories.</p>
		<div id="urvanov-syntax-highlighter-619c550b940bc992759632" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# plot diagnostic learning curves
def summarize_diagnostics(histories):
	for i in range(len(histories)):
		# plot loss
		plt.subplot(2, 1, 1)
		plt.title('Cross Entropy Loss')
		plt.plot(histories[i].history['loss'], color='blue', label='train')
		plt.plot(histories[i].history['val_loss'], color='orange', label='test')
		# plot accuracy
		plt.subplot(2, 1, 2)
		plt.title('Classification Accuracy')
		plt.plot(histories[i].history['accuracy'], color='blue', label='train')
		plt.plot(histories[i].history['val_accuracy'], color='orange', label='test')
	plt.show()</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bc992759632-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bc992759632-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bc992759632-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bc992759632-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bc992759632-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bc992759632-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bc992759632-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bc992759632-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bc992759632-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bc992759632-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bc992759632-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bc992759632-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bc992759632-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bc992759632-14">14</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bc992759632-1"><span class="crayon-p"># plot diagnostic learning curves</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bc992759632-2"><span class="crayon-e">def </span><span class="crayon-e">summarize_diagnostics</span><span class="crayon-sy">(</span><span class="crayon-v">histories</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bc992759632-3"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">histories</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bc992759632-4"><span class="crayon-h">		</span><span class="crayon-p"># plot loss</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bc992759632-5"><span class="crayon-h">		</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bc992759632-6"><span class="crayon-h">		</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">title</span><span class="crayon-sy">(</span><span class="crayon-s">'Cross Entropy Loss'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bc992759632-7"><span class="crayon-h">		</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">histories</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-v">history</span><span class="crayon-sy">[</span><span class="crayon-s">'loss'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">color</span><span class="crayon-o">=</span><span class="crayon-s">'blue'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-s">'train'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bc992759632-8"><span class="crayon-h">		</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">histories</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-v">history</span><span class="crayon-sy">[</span><span class="crayon-s">'val_loss'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">color</span><span class="crayon-o">=</span><span class="crayon-s">'orange'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-s">'test'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bc992759632-9"><span class="crayon-h">		</span><span class="crayon-p"># plot accuracy</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bc992759632-10"><span class="crayon-h">		</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bc992759632-11"><span class="crayon-h">		</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">title</span><span class="crayon-sy">(</span><span class="crayon-s">'Classification Accuracy'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bc992759632-12"><span class="crayon-h">		</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">histories</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-v">history</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">color</span><span class="crayon-o">=</span><span class="crayon-s">'blue'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-s">'train'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bc992759632-13"><span class="crayon-h">		</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">histories</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-v">history</span><span class="crayon-sy">[</span><span class="crayon-s">'val_accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">color</span><span class="crayon-o">=</span><span class="crayon-s">'orange'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-s">'test'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bc992759632-14"><span class="crayon-h">	</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>Next, the classification accuracy scores collected during each fold can be summarized by calculating the mean and standard deviation. This provides an estimate of the average expected performance of the model trained on this dataset, with an estimate of the average variance in the mean. We will also summarize the distribution of scores by creating and showing a box and whisker plot.</p>
<p>The <em>summarize_performance()</em> function below implements this for a given list of scores collected during model evaluation.</p>
		<div id="urvanov-syntax-highlighter-619c550b940bd650619068" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# summarize model performance
def summarize_performance(scores):
	# print summary
	print('Accuracy: mean=%.3f std=%.3f, n=%d' % (mean(scores)*100, std(scores)*100, len(scores)))
	# box and whisker plots of results
	plt.boxplot(scores)
	plt.show()</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bd650619068-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bd650619068-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bd650619068-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bd650619068-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bd650619068-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bd650619068-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bd650619068-7">7</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bd650619068-1"><span class="crayon-p"># summarize model performance</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bd650619068-2"><span class="crayon-e">def </span><span class="crayon-e">summarize_performance</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bd650619068-3"><span class="crayon-h">	</span><span class="crayon-p"># print summary</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bd650619068-4"><span class="crayon-h">	</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Accuracy: mean=%.3f std=%.3f, n=%d'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">std</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bd650619068-5"><span class="crayon-h">	</span><span class="crayon-p"># box and whisker plots of results</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bd650619068-6"><span class="crayon-h">	</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">boxplot</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bd650619068-7"><span class="crayon-h">	</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p></p>
<h3>Complete Example</h3>
<p>We need a function that will drive the test harness.</p>
<p>This involves calling all of the define functions.</p>
		<div id="urvanov-syntax-highlighter-619c550b940be424628148" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# run the test harness for evaluating a model
def run_test_harness():
	# load dataset
	trainX, trainY, testX, testY = load_dataset()
	# prepare pixel data
	trainX, testX = prep_pixels(trainX, testX)
	# evaluate model
	scores, histories = evaluate_model(trainX, trainY)
	# learning curves
	summarize_diagnostics(histories)
	# summarize estimated performance
	summarize_performance(scores)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940be424628148-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940be424628148-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940be424628148-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940be424628148-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940be424628148-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940be424628148-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940be424628148-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940be424628148-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940be424628148-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940be424628148-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940be424628148-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940be424628148-12">12</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940be424628148-1"><span class="crayon-p"># run the test harness for evaluating a model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940be424628148-2"><span class="crayon-e">def </span><span class="crayon-e">run_test_harness</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940be424628148-3"><span class="crayon-h">	</span><span class="crayon-p"># load dataset</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940be424628148-4"><span class="crayon-h">	</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_dataset</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940be424628148-5"><span class="crayon-h">	</span><span class="crayon-p"># prepare pixel data</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940be424628148-6"><span class="crayon-h">	</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">prep_pixels</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940be424628148-7"><span class="crayon-h">	</span><span class="crayon-p"># evaluate model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940be424628148-8"><span class="crayon-h">	</span><span class="crayon-v">scores</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">histories</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">evaluate_model</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940be424628148-9"><span class="crayon-h">	</span><span class="crayon-p"># learning curves</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940be424628148-10"><span class="crayon-h">	</span><span class="crayon-e">summarize_diagnostics</span><span class="crayon-sy">(</span><span class="crayon-v">histories</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940be424628148-11"><span class="crayon-h">	</span><span class="crayon-p"># summarize estimated performance</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940be424628148-12"><span class="crayon-h">	</span><span class="crayon-e">summarize_performance</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>We now have everything we need; the complete code example for a baseline convolutional neural network model on the MNIST dataset is listed below.</p>
		<div id="urvanov-syntax-highlighter-619c550b940bf795871678" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# baseline cnn model for mnist
from numpy import mean
from numpy import std
from matplotlib import pyplot as plt
from sklearn.model_selection import KFold
from tensorflow.keras.datasets import mnist
from tensorflow.keras.utils import to_categorical
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Conv2D
from tensorflow.keras.layers import MaxPooling2D
from tensorflow.keras.layers import Dense
from tensorflow.keras.layers import Flatten
from tensorflow.keras.optimizers import SGD

# load train and test dataset
def load_dataset():
	# load dataset
	(trainX, trainY), (testX, testY) = mnist.load_data()
	# reshape dataset to have a single channel
	trainX = trainX.reshape((trainX.shape[0], 28, 28, 1))
	testX = testX.reshape((testX.shape[0], 28, 28, 1))
	# one hot encode target values
	trainY = to_categorical(trainY)
	testY = to_categorical(testY)
	return trainX, trainY, testX, testY

# scale pixels
def prep_pixels(train, test):
	# convert from integers to floats
	train_norm = train.astype('float32')
	test_norm = test.astype('float32')
	# normalize to range 0-1
	train_norm = train_norm / 255.0
	test_norm = test_norm / 255.0
	# return normalized images
	return train_norm, test_norm

# define cnn model
def define_model():
	model = Sequential()
	model.add(Conv2D(32, (3, 3), activation='relu', kernel_initializer='he_uniform', input_shape=(28, 28, 1)))
	model.add(MaxPooling2D((2, 2)))
	model.add(Flatten())
	model.add(Dense(100, activation='relu', kernel_initializer='he_uniform'))
	model.add(Dense(10, activation='softmax'))
	# compile model
	opt = SGD(learning_rate=0.01, momentum=0.9)
	model.compile(optimizer=opt, loss='categorical_crossentropy', metrics=['accuracy'])
	return model

# evaluate a model using k-fold cross-validation
def evaluate_model(dataX, dataY, n_folds=5):
	scores, histories = list(), list()
	# prepare cross validation
	kfold = KFold(n_folds, shuffle=True, random_state=1)
	# enumerate splits
	for train_ix, test_ix in kfold.split(dataX):
		# define model
		model = define_model()
		# select rows for train and test
		trainX, trainY, testX, testY = dataX[train_ix], dataY[train_ix], dataX[test_ix], dataY[test_ix]
		# fit model
		history = model.fit(trainX, trainY, epochs=10, batch_size=32, validation_data=(testX, testY), verbose=0)
		# evaluate model
		_, acc = model.evaluate(testX, testY, verbose=0)
		print('&gt; %.3f' % (acc * 100.0))
		# stores scores
		scores.append(acc)
		histories.append(history)
	return scores, histories

# plot diagnostic learning curves
def summarize_diagnostics(histories):
	for i in range(len(histories)):
		# plot loss
		plt.subplot(2, 1, 1)
		plt.title('Cross Entropy Loss')
		plt.plot(histories[i].history['loss'], color='blue', label='train')
		plt.plot(histories[i].history['val_loss'], color='orange', label='test')
		# plot accuracy
		plt.subplot(2, 1, 2)
		plt.title('Classification Accuracy')
		plt.plot(histories[i].history['accuracy'], color='blue', label='train')
		plt.plot(histories[i].history['val_accuracy'], color='orange', label='test')
	plt.show()

# summarize model performance
def summarize_performance(scores):
	# print summary
	print('Accuracy: mean=%.3f std=%.3f, n=%d' % (mean(scores)*100, std(scores)*100, len(scores)))
	# box and whisker plots of results
	plt.boxplot(scores)
	plt.show()

# run the test harness for evaluating a model
def run_test_harness():
	# load dataset
	trainX, trainY, testX, testY = load_dataset()
	# prepare pixel data
	trainX, testX = prep_pixels(trainX, testX)
	# evaluate model
	scores, histories = evaluate_model(trainX, trainY)
	# learning curves
	summarize_diagnostics(histories)
	# summarize estimated performance
	summarize_performance(scores)

# entry point, run the test harness
run_test_harness()</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-30">30</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-31">31</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-32">32</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-33">33</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-34">34</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-35">35</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-36">36</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-37">37</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-38">38</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-39">39</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-40">40</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-41">41</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-42">42</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-43">43</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-44">44</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-45">45</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-46">46</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-47">47</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-48">48</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-49">49</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-50">50</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-51">51</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-52">52</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-53">53</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-54">54</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-55">55</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-56">56</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-57">57</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-58">58</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-59">59</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-60">60</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-61">61</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-62">62</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-63">63</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-64">64</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-65">65</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-66">66</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-67">67</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-68">68</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-69">69</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-70">70</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-71">71</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-72">72</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-73">73</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-74">74</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-75">75</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-76">76</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-77">77</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-78">78</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-79">79</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-80">80</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-81">81</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-82">82</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-83">83</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-84">84</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-85">85</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-86">86</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-87">87</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-88">88</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-89">89</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-90">90</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-91">91</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-92">92</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-93">93</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-94">94</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-95">95</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-96">96</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-97">97</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-98">98</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-99">99</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-100">100</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-101">101</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-102">102</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-103">103</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-104">104</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-105">105</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-106">106</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-107">107</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-108">108</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940bf795871678-109">109</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-1"><span class="crayon-p"># baseline cnn model for mnist</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-2"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">mean</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-3"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">std</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-4"><span class="crayon-e">from </span><span class="crayon-e">matplotlib </span><span class="crayon-e">import </span><span class="crayon-e">pyplot </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">plt</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-5"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">model_selection </span><span class="crayon-e">import </span><span class="crayon-e">KFold</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-6"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">datasets </span><span class="crayon-e">import </span><span class="crayon-e">mnist</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-7"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">utils </span><span class="crayon-e">import </span><span class="crayon-e">to_categorical</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-8"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-9"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Conv2D</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-10"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">MaxPooling2D</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-11"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-12"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Flatten</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-13"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">optimizers </span><span class="crayon-e">import </span><span class="crayon-i">SGD</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-14">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-15"><span class="crayon-p"># load train and test dataset</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-16"><span class="crayon-e">def </span><span class="crayon-e">load_dataset</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-17"><span class="crayon-h">	</span><span class="crayon-p"># load dataset</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-18"><span class="crayon-h">	</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testY</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">mnist</span><span class="crayon-sy">.</span><span class="crayon-e">load_data</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-19"><span class="crayon-h">	</span><span class="crayon-p"># reshape dataset to have a single channel</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-20"><span class="crayon-h">	</span><span class="crayon-v">trainX</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">trainX</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-21"><span class="crayon-h">	</span><span class="crayon-v">testX</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-22"><span class="crayon-h">	</span><span class="crayon-p"># one hot encode target values</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-23"><span class="crayon-h">	</span><span class="crayon-v">trainY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">to_categorical</span><span class="crayon-sy">(</span><span class="crayon-v">trainY</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-24"><span class="crayon-h">	</span><span class="crayon-v">testY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">to_categorical</span><span class="crayon-sy">(</span><span class="crayon-v">testY</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-25"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">testY</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-26">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-27"><span class="crayon-p"># scale pixels</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-28"><span class="crayon-e">def </span><span class="crayon-e">prep_pixels</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-29"><span class="crayon-h">	</span><span class="crayon-p"># convert from integers to floats</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-30"><span class="crayon-h">	</span><span class="crayon-v">train_norm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-31"><span class="crayon-h">	</span><span class="crayon-v">test_norm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-32"><span class="crayon-h">	</span><span class="crayon-p"># normalize to range 0-1</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-33"><span class="crayon-h">	</span><span class="crayon-v">train_norm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">train_norm</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">255.0</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-34"><span class="crayon-h">	</span><span class="crayon-v">test_norm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">test_norm</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">255.0</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-35"><span class="crayon-h">	</span><span class="crayon-p"># return normalized images</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-36"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">train_norm</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">_</span>norm</div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-37">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-38"><span class="crayon-p"># define cnn model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-39"><span class="crayon-e">def </span><span class="crayon-e">define_model</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-40"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-41"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">32</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'he_uniform'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-42"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">MaxPooling2D</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-43"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Flatten</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-44"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'he_uniform'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-45"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'softmax'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-46"><span class="crayon-h">	</span><span class="crayon-p"># compile model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-47"><span class="crayon-h">	</span><span class="crayon-v">opt</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">SGD</span><span class="crayon-sy">(</span><span class="crayon-v">learning_rate</span><span class="crayon-o">=</span><span class="crayon-cn">0.01</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">momentum</span><span class="crayon-o">=</span><span class="crayon-cn">0.9</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-48"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-v">opt</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'categorical_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-49"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-50">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-51"><span class="crayon-p"># evaluate a model using k-fold cross-validation</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-52"><span class="crayon-e">def </span><span class="crayon-e">evaluate_model</span><span class="crayon-sy">(</span><span class="crayon-v">dataX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_folds</span><span class="crayon-o">=</span><span class="crayon-cn">5</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-53"><span class="crayon-h">	</span><span class="crayon-v">scores</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">histories</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-54"><span class="crayon-h">	</span><span class="crayon-p"># prepare cross validation</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-55"><span class="crayon-h">	</span><span class="crayon-v">kfold</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">KFold</span><span class="crayon-sy">(</span><span class="crayon-v">n_folds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">shuffle</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">random_state</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-56"><span class="crayon-h">	</span><span class="crayon-p"># enumerate splits</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-57"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">train_ix</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">test_ix </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">kfold</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-v">dataX</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-58"><span class="crayon-h">		</span><span class="crayon-p"># define model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-59"><span class="crayon-h">		</span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">define_model</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-60"><span class="crayon-h">		</span><span class="crayon-p"># select rows for train and test</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-61"><span class="crayon-h">		</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataX</span><span class="crayon-sy">[</span><span class="crayon-v">train_ix</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataY</span><span class="crayon-sy">[</span><span class="crayon-v">train_ix</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataX</span><span class="crayon-sy">[</span><span class="crayon-v">test_ix</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataY</span><span class="crayon-sy">[</span><span class="crayon-v">test_ix</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-62"><span class="crayon-h">		</span><span class="crayon-p"># fit model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-63"><span class="crayon-h">		</span><span class="crayon-v">history</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">32</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">validation_data</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testY</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-64"><span class="crayon-h">		</span><span class="crayon-p"># evaluate model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-65"><span class="crayon-h">		</span><span class="crayon-v">_</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">acc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">evaluate</span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-66"><span class="crayon-h">		</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'&gt; %.3f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e ">acc *</span><span class="crayon-h"> </span><span class="crayon-cn">100.0</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-67"><span class="crayon-h">		</span><span class="crayon-p"># stores scores</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-68"><span class="crayon-h">		</span><span class="crayon-v">scores</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">acc</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-69"><span class="crayon-h">		</span><span class="crayon-v">histories</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">history</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-70"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">histories</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-71">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-72"><span class="crayon-p"># plot diagnostic learning curves</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-73"><span class="crayon-e">def </span><span class="crayon-e">summarize_diagnostics</span><span class="crayon-sy">(</span><span class="crayon-v">histories</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-74"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">histories</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-75"><span class="crayon-h">		</span><span class="crayon-p"># plot loss</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-76"><span class="crayon-h">		</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-77"><span class="crayon-h">		</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">title</span><span class="crayon-sy">(</span><span class="crayon-s">'Cross Entropy Loss'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-78"><span class="crayon-h">		</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">histories</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-v">history</span><span class="crayon-sy">[</span><span class="crayon-s">'loss'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">color</span><span class="crayon-o">=</span><span class="crayon-s">'blue'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-s">'train'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-79"><span class="crayon-h">		</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">histories</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-v">history</span><span class="crayon-sy">[</span><span class="crayon-s">'val_loss'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">color</span><span class="crayon-o">=</span><span class="crayon-s">'orange'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-s">'test'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-80"><span class="crayon-h">		</span><span class="crayon-p"># plot accuracy</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-81"><span class="crayon-h">		</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-82"><span class="crayon-h">		</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">title</span><span class="crayon-sy">(</span><span class="crayon-s">'Classification Accuracy'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-83"><span class="crayon-h">		</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">histories</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-v">history</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">color</span><span class="crayon-o">=</span><span class="crayon-s">'blue'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-s">'train'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-84"><span class="crayon-h">		</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">histories</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-v">history</span><span class="crayon-sy">[</span><span class="crayon-s">'val_accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">color</span><span class="crayon-o">=</span><span class="crayon-s">'orange'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-s">'test'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-85"><span class="crayon-h">	</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-86">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-87"><span class="crayon-p"># summarize model performance</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-88"><span class="crayon-e">def </span><span class="crayon-e">summarize_performance</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-89"><span class="crayon-h">	</span><span class="crayon-p"># print summary</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-90"><span class="crayon-h">	</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Accuracy: mean=%.3f std=%.3f, n=%d'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">std</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-91"><span class="crayon-h">	</span><span class="crayon-p"># box and whisker plots of results</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-92"><span class="crayon-h">	</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">boxplot</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-93"><span class="crayon-h">	</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-94">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-95"><span class="crayon-p"># run the test harness for evaluating a model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-96"><span class="crayon-e">def </span><span class="crayon-e">run_test_harness</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-97"><span class="crayon-h">	</span><span class="crayon-p"># load dataset</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-98"><span class="crayon-h">	</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_dataset</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-99"><span class="crayon-h">	</span><span class="crayon-p"># prepare pixel data</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-100"><span class="crayon-h">	</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">prep_pixels</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-101"><span class="crayon-h">	</span><span class="crayon-p"># evaluate model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-102"><span class="crayon-h">	</span><span class="crayon-v">scores</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">histories</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">evaluate_model</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-103"><span class="crayon-h">	</span><span class="crayon-p"># learning curves</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-104"><span class="crayon-h">	</span><span class="crayon-e">summarize_diagnostics</span><span class="crayon-sy">(</span><span class="crayon-v">histories</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-105"><span class="crayon-h">	</span><span class="crayon-p"># summarize estimated performance</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-106"><span class="crayon-h">	</span><span class="crayon-e">summarize_performance</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-107">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-108"><span class="crayon-p"># entry point, run the test harness</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940bf795871678-109"><span class="crayon-e">run_test_harness</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>Running the example prints the classification accuracy for each fold of the cross-validation process. This is helpful to get an idea that the model evaluation is progressing.</p>
<p><strong>Note</strong>: Your <a href="https://machinelearningmastery.com/different-results-each-time-in-machine-learning/">results may vary</a> given the stochastic nature of the algorithm or evaluation procedure, or differences in numerical precision. Consider running the example a few times and compare the average outcome.</p>

<p>We can see two cases where the model achieves perfect skill and one case where it achieved lower than 98% accuracy. These are good results.</p>
		<div id="urvanov-syntax-highlighter-619c550b940c0015126058" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
&gt; 98.550
&gt; 98.600
&gt; 98.642
&gt; 98.850
&gt; 98.742</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c0015126058-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c0015126058-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c0015126058-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c0015126058-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c0015126058-5">5</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c0015126058-1">&gt; 98.550</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c0015126058-2">&gt; 98.600</div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c0015126058-3">&gt; 98.642</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c0015126058-4">&gt; 98.850</div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c0015126058-5">&gt; 98.742</div></div></td>
					</tr>
				</table>
			</div>
		</div><p>Next, a diagnostic plot is shown, giving insight into the learning behavior of the model across each fold.</p>
<p>In this case, we can see that the model generally achieves a good fit, with train and test learning curves converging. There is no obvious sign of over- or underfitting.</p>
<div id="attachment_9971" style="width: 1290px" class="wp-caption aligncenter"><img aria-describedby="caption-attachment-9971" loading="lazy" class="size-full wp-image-9971" src="https://machinelearningmastery.com/wp-content/uploads/2019/05/Loss-and-Accuracy-Learning-Curves-for-the-Baseline-Model-During-k-Fold-Cross-Validation2.png" alt="Loss and Accuracy Learning Curves for the Baseline Model During k-Fold Cross-Validation" width="1280" height="960" srcset="https://machinelearningmastery.com/wp-content/uploads/2019/05/Loss-and-Accuracy-Learning-Curves-for-the-Baseline-Model-During-k-Fold-Cross-Validation2.png 1280w, https://machinelearningmastery.com/wp-content/uploads/2019/05/Loss-and-Accuracy-Learning-Curves-for-the-Baseline-Model-During-k-Fold-Cross-Validation2-300x225.png 300w, https://machinelearningmastery.com/wp-content/uploads/2019/05/Loss-and-Accuracy-Learning-Curves-for-the-Baseline-Model-During-k-Fold-Cross-Validation2-1024x768.png 1024w, https://machinelearningmastery.com/wp-content/uploads/2019/05/Loss-and-Accuracy-Learning-Curves-for-the-Baseline-Model-During-k-Fold-Cross-Validation2-768x576.png 768w" sizes="(max-width: 1280px) 100vw, 1280px" /><p id="caption-attachment-9971" class="wp-caption-text">Loss and Accuracy Learning Curves for the Baseline Model During k-Fold Cross-Validation</p></div>
<p>Next, a summary of the model performance is calculated.</p>
<p>We can see in this case, the model has an estimated skill of about 98.6%, which is reasonable.</p>
		<div id="urvanov-syntax-highlighter-619c550b940c1125061452" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
Accuracy: mean=98.677 std=0.107, n=5</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c1125061452-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c1125061452-1">Accuracy: mean=98.677 std=0.107, n=5</div></div></td>
					</tr>
				</table>
			</div>
		</div><p>Finally, a box and whisker plot is created to summarize the distribution of accuracy scores.</p>
<div id="attachment_9972" style="width: 1290px" class="wp-caption aligncenter"><img aria-describedby="caption-attachment-9972" loading="lazy" class="size-full wp-image-9972" src="https://machinelearningmastery.com/wp-content/uploads/2019/05/Box-and-Whisker-Plot-of-Accuracy-Scores-for-the-Baseline-Model-Evaluated-Using-k-Fold-Cross-Validation2.png" alt="Box and Whisker Plot of Accuracy Scores for the Baseline Model Evaluated Using k-Fold Cross-Validation" width="1280" height="960" srcset="https://machinelearningmastery.com/wp-content/uploads/2019/05/Box-and-Whisker-Plot-of-Accuracy-Scores-for-the-Baseline-Model-Evaluated-Using-k-Fold-Cross-Validation2.png 1280w, https://machinelearningmastery.com/wp-content/uploads/2019/05/Box-and-Whisker-Plot-of-Accuracy-Scores-for-the-Baseline-Model-Evaluated-Using-k-Fold-Cross-Validation2-300x225.png 300w, https://machinelearningmastery.com/wp-content/uploads/2019/05/Box-and-Whisker-Plot-of-Accuracy-Scores-for-the-Baseline-Model-Evaluated-Using-k-Fold-Cross-Validation2-1024x768.png 1024w, https://machinelearningmastery.com/wp-content/uploads/2019/05/Box-and-Whisker-Plot-of-Accuracy-Scores-for-the-Baseline-Model-Evaluated-Using-k-Fold-Cross-Validation2-768x576.png 768w" sizes="(max-width: 1280px) 100vw, 1280px" /><p id="caption-attachment-9972" class="wp-caption-text">Box and Whisker Plot of Accuracy Scores for the Baseline Model Evaluated Using k-Fold Cross-Validation</p></div>
<p>We now have a robust test harness and a well-performing baseline model.</p>
<h2>How to Develop an Improved Model</h2>
<p>There are many ways that we might explore improvements to the baseline model.</p>
<p>We will look at areas of model configuration that often result in an improvement, so-called low-hanging fruit. The first is a change to the learning algorithm, and the second is an increase in the depth of the model.</p>
<h3>Improvement to Learning</h3>
<p>There are many aspects of the learning algorithm that can be explored for improvement.</p>
<p>Perhaps the point of biggest leverage is the learning rate, such as evaluating the impact that smaller or larger values of the learning rate may have, as well as schedules that change the learning rate during training.</p>
<p>Another approach that can rapidly accelerate the learning of a model and can result in large performance improvements is batch normalization. We will evaluate the effect that batch normalization has on our baseline model.</p>
<p><a href="https://machinelearningmastery.com/how-to-accelerate-learning-of-deep-neural-networks-with-batch-normalization/">Batch normalization</a> can be used after convolutional and fully connected layers. It has the effect of changing the distribution of the output of the layer, specifically by standardizing the outputs. This has the effect of stabilizing and accelerating the learning process.</p>
<p>We can update the model definition to use batch normalization after the activation function for the convolutional and dense layers of our baseline model. The updated version of <em>define_model()</em> function with batch normalization is listed below.</p>
		<div id="urvanov-syntax-highlighter-619c550b940c2379270956" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# define cnn model
def define_model():
	model = Sequential()
	model.add(Conv2D(32, (3, 3), activation='relu', kernel_initializer='he_uniform', input_shape=(28, 28, 1)))
	model.add(BatchNormalization())
	model.add(MaxPooling2D((2, 2)))
	model.add(Flatten())
	model.add(Dense(100, activation='relu', kernel_initializer='he_uniform'))
	model.add(BatchNormalization())
	model.add(Dense(10, activation='softmax'))
	# compile model
	opt = SGD(learning_rate=0.01, momentum=0.9)
	model.compile(optimizer=opt, loss='categorical_crossentropy', metrics=['accuracy'])
	return model</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c2379270956-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c2379270956-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c2379270956-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c2379270956-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c2379270956-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c2379270956-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c2379270956-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c2379270956-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c2379270956-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c2379270956-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c2379270956-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c2379270956-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c2379270956-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c2379270956-14">14</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c2379270956-1"><span class="crayon-p"># define cnn model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c2379270956-2"><span class="crayon-e">def </span><span class="crayon-e">define_model</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c2379270956-3"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c2379270956-4"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">32</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'he_uniform'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c2379270956-5"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">BatchNormalization</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c2379270956-6"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">MaxPooling2D</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c2379270956-7"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Flatten</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c2379270956-8"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'he_uniform'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c2379270956-9"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">BatchNormalization</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c2379270956-10"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'softmax'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c2379270956-11"><span class="crayon-h">	</span><span class="crayon-p"># compile model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c2379270956-12"><span class="crayon-h">	</span><span class="crayon-v">opt</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">SGD</span><span class="crayon-sy">(</span><span class="crayon-v">learning_rate</span><span class="crayon-o">=</span><span class="crayon-cn">0.01</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">momentum</span><span class="crayon-o">=</span><span class="crayon-cn">0.9</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c2379270956-13"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-v">opt</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'categorical_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c2379270956-14"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">model</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>The complete code listing with this change is provided below.</p>
		<div id="urvanov-syntax-highlighter-619c550b940c3941066651" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# cnn model with batch normalization for mnist
from numpy import mean
from numpy import std
from matplotlib import pyplot as plt
from sklearn.model_selection import KFold
from tensorflow.keras.datasets import mnist
from tensorflow.keras.utils import to_categorical
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Conv2D
from tensorflow.keras.layers import MaxPooling2D
from tensorflow.keras.layers import Dense
from tensorflow.keras.layers import Flatten
from tensorflow.keras.optimizers import SGD
from tensorflow.keras.layers import BatchNormalization

# load train and test dataset
def load_dataset():
	# load dataset
	(trainX, trainY), (testX, testY) = mnist.load_data()
	# reshape dataset to have a single channel
	trainX = trainX.reshape((trainX.shape[0], 28, 28, 1))
	testX = testX.reshape((testX.shape[0], 28, 28, 1))
	# one hot encode target values
	trainY = to_categorical(trainY)
	testY = to_categorical(testY)
	return trainX, trainY, testX, testY

# scale pixels
def prep_pixels(train, test):
	# convert from integers to floats
	train_norm = train.astype('float32')
	test_norm = test.astype('float32')
	# normalize to range 0-1
	train_norm = train_norm / 255.0
	test_norm = test_norm / 255.0
	# return normalized images
	return train_norm, test_norm

# define cnn model
def define_model():
	model = Sequential()
	model.add(Conv2D(32, (3, 3), activation='relu', kernel_initializer='he_uniform', input_shape=(28, 28, 1)))
	model.add(BatchNormalization())
	model.add(MaxPooling2D((2, 2)))
	model.add(Flatten())
	model.add(Dense(100, activation='relu', kernel_initializer='he_uniform'))
	model.add(BatchNormalization())
	model.add(Dense(10, activation='softmax'))
	# compile model
	opt = SGD(learning_rate=0.01, momentum=0.9)
	model.compile(optimizer=opt, loss='categorical_crossentropy', metrics=['accuracy'])
	return model

# evaluate a model using k-fold cross-validation
def evaluate_model(dataX, dataY, n_folds=5):
	scores, histories = list(), list()
	# prepare cross validation
	kfold = KFold(n_folds, shuffle=True, random_state=1)
	# enumerate splits
	for train_ix, test_ix in kfold.split(dataX):
		# define model
		model = define_model()
		# select rows for train and test
		trainX, trainY, testX, testY = dataX[train_ix], dataY[train_ix], dataX[test_ix], dataY[test_ix]
		# fit model
		history = model.fit(trainX, trainY, epochs=10, batch_size=32, validation_data=(testX, testY), verbose=0)
		# evaluate model
		_, acc = model.evaluate(testX, testY, verbose=0)
		print('&gt; %.3f' % (acc * 100.0))
		# stores scores
		scores.append(acc)
		histories.append(history)
	return scores, histories

# plot diagnostic learning curves
def summarize_diagnostics(histories):
	for i in range(len(histories)):
		# plot loss
		plt.subplot(2, 1, 1)
		plt.title('Cross Entropy Loss')
		plt.plot(histories[i].history['loss'], color='blue', label='train')
		plt.plot(histories[i].history['val_loss'], color='orange', label='test')
		# plot accuracy
		plt.subplot(2, 1, 2)
		plt.title('Classification Accuracy')
		plt.plot(histories[i].history['accuracy'], color='blue', label='train')
		plt.plot(histories[i].history['val_accuracy'], color='orange', label='test')
	plt.show()

# summarize model performance
def summarize_performance(scores):
	# print summary
	print('Accuracy: mean=%.3f std=%.3f, n=%d' % (mean(scores)*100, std(scores)*100, len(scores)))
	# box and whisker plots of results
	plt.boxplot(scores)
	plt.show()

# run the test harness for evaluating a model
def run_test_harness():
	# load dataset
	trainX, trainY, testX, testY = load_dataset()
	# prepare pixel data
	trainX, testX = prep_pixels(trainX, testX)
	# evaluate model
	scores, histories = evaluate_model(trainX, trainY)
	# learning curves
	summarize_diagnostics(histories)
	# summarize estimated performance
	summarize_performance(scores)

# entry point, run the test harness
run_test_harness()</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-30">30</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-31">31</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-32">32</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-33">33</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-34">34</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-35">35</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-36">36</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-37">37</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-38">38</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-39">39</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-40">40</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-41">41</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-42">42</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-43">43</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-44">44</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-45">45</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-46">46</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-47">47</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-48">48</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-49">49</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-50">50</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-51">51</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-52">52</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-53">53</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-54">54</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-55">55</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-56">56</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-57">57</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-58">58</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-59">59</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-60">60</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-61">61</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-62">62</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-63">63</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-64">64</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-65">65</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-66">66</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-67">67</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-68">68</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-69">69</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-70">70</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-71">71</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-72">72</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-73">73</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-74">74</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-75">75</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-76">76</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-77">77</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-78">78</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-79">79</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-80">80</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-81">81</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-82">82</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-83">83</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-84">84</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-85">85</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-86">86</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-87">87</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-88">88</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-89">89</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-90">90</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-91">91</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-92">92</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-93">93</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-94">94</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-95">95</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-96">96</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-97">97</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-98">98</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-99">99</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-100">100</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-101">101</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-102">102</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-103">103</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-104">104</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-105">105</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-106">106</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-107">107</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-108">108</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-109">109</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-110">110</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-111">111</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c3941066651-112">112</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-1"><span class="crayon-p"># cnn model with batch normalization for mnist</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-2"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">mean</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-3"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">std</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-4"><span class="crayon-e">from </span><span class="crayon-e">matplotlib </span><span class="crayon-e">import </span><span class="crayon-e">pyplot </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">plt</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-5"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">model_selection </span><span class="crayon-e">import </span><span class="crayon-e">KFold</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-6"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">datasets </span><span class="crayon-e">import </span><span class="crayon-e">mnist</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-7"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">utils </span><span class="crayon-e">import </span><span class="crayon-e">to_categorical</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-8"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-9"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Conv2D</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-10"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">MaxPooling2D</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-11"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-12"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Flatten</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-13"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">optimizers </span><span class="crayon-e">import </span><span class="crayon-e">SGD</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-14"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-i">BatchNormalization</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-15">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-16"><span class="crayon-p"># load train and test dataset</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-17"><span class="crayon-e">def </span><span class="crayon-e">load_dataset</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-18"><span class="crayon-h">	</span><span class="crayon-p"># load dataset</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-19"><span class="crayon-h">	</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testY</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">mnist</span><span class="crayon-sy">.</span><span class="crayon-e">load_data</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-20"><span class="crayon-h">	</span><span class="crayon-p"># reshape dataset to have a single channel</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-21"><span class="crayon-h">	</span><span class="crayon-v">trainX</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">trainX</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-22"><span class="crayon-h">	</span><span class="crayon-v">testX</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-23"><span class="crayon-h">	</span><span class="crayon-p"># one hot encode target values</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-24"><span class="crayon-h">	</span><span class="crayon-v">trainY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">to_categorical</span><span class="crayon-sy">(</span><span class="crayon-v">trainY</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-25"><span class="crayon-h">	</span><span class="crayon-v">testY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">to_categorical</span><span class="crayon-sy">(</span><span class="crayon-v">testY</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-26"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">testY</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-27">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-28"><span class="crayon-p"># scale pixels</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-29"><span class="crayon-e">def </span><span class="crayon-e">prep_pixels</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-30"><span class="crayon-h">	</span><span class="crayon-p"># convert from integers to floats</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-31"><span class="crayon-h">	</span><span class="crayon-v">train_norm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-32"><span class="crayon-h">	</span><span class="crayon-v">test_norm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-33"><span class="crayon-h">	</span><span class="crayon-p"># normalize to range 0-1</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-34"><span class="crayon-h">	</span><span class="crayon-v">train_norm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">train_norm</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">255.0</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-35"><span class="crayon-h">	</span><span class="crayon-v">test_norm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">test_norm</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">255.0</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-36"><span class="crayon-h">	</span><span class="crayon-p"># return normalized images</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-37"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">train_norm</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">_</span>norm</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-38">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-39"><span class="crayon-p"># define cnn model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-40"><span class="crayon-e">def </span><span class="crayon-e">define_model</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-41"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-42"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">32</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'he_uniform'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-43"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">BatchNormalization</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-44"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">MaxPooling2D</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-45"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Flatten</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-46"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'he_uniform'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-47"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">BatchNormalization</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-48"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'softmax'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-49"><span class="crayon-h">	</span><span class="crayon-p"># compile model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-50"><span class="crayon-h">	</span><span class="crayon-v">opt</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">SGD</span><span class="crayon-sy">(</span><span class="crayon-v">learning_rate</span><span class="crayon-o">=</span><span class="crayon-cn">0.01</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">momentum</span><span class="crayon-o">=</span><span class="crayon-cn">0.9</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-51"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-v">opt</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'categorical_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-52"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-53">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-54"><span class="crayon-p"># evaluate a model using k-fold cross-validation</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-55"><span class="crayon-e">def </span><span class="crayon-e">evaluate_model</span><span class="crayon-sy">(</span><span class="crayon-v">dataX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_folds</span><span class="crayon-o">=</span><span class="crayon-cn">5</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-56"><span class="crayon-h">	</span><span class="crayon-v">scores</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">histories</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-57"><span class="crayon-h">	</span><span class="crayon-p"># prepare cross validation</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-58"><span class="crayon-h">	</span><span class="crayon-v">kfold</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">KFold</span><span class="crayon-sy">(</span><span class="crayon-v">n_folds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">shuffle</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">random_state</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-59"><span class="crayon-h">	</span><span class="crayon-p"># enumerate splits</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-60"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">train_ix</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">test_ix </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">kfold</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-v">dataX</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-61"><span class="crayon-h">		</span><span class="crayon-p"># define model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-62"><span class="crayon-h">		</span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">define_model</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-63"><span class="crayon-h">		</span><span class="crayon-p"># select rows for train and test</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-64"><span class="crayon-h">		</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataX</span><span class="crayon-sy">[</span><span class="crayon-v">train_ix</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataY</span><span class="crayon-sy">[</span><span class="crayon-v">train_ix</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataX</span><span class="crayon-sy">[</span><span class="crayon-v">test_ix</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataY</span><span class="crayon-sy">[</span><span class="crayon-v">test_ix</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-65"><span class="crayon-h">		</span><span class="crayon-p"># fit model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-66"><span class="crayon-h">		</span><span class="crayon-v">history</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">32</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">validation_data</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testY</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-67"><span class="crayon-h">		</span><span class="crayon-p"># evaluate model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-68"><span class="crayon-h">		</span><span class="crayon-v">_</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">acc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">evaluate</span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-69"><span class="crayon-h">		</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'&gt; %.3f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e ">acc *</span><span class="crayon-h"> </span><span class="crayon-cn">100.0</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-70"><span class="crayon-h">		</span><span class="crayon-p"># stores scores</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-71"><span class="crayon-h">		</span><span class="crayon-v">scores</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">acc</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-72"><span class="crayon-h">		</span><span class="crayon-v">histories</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">history</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-73"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">histories</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-74">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-75"><span class="crayon-p"># plot diagnostic learning curves</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-76"><span class="crayon-e">def </span><span class="crayon-e">summarize_diagnostics</span><span class="crayon-sy">(</span><span class="crayon-v">histories</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-77"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">histories</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-78"><span class="crayon-h">		</span><span class="crayon-p"># plot loss</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-79"><span class="crayon-h">		</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-80"><span class="crayon-h">		</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">title</span><span class="crayon-sy">(</span><span class="crayon-s">'Cross Entropy Loss'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-81"><span class="crayon-h">		</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">histories</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-v">history</span><span class="crayon-sy">[</span><span class="crayon-s">'loss'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">color</span><span class="crayon-o">=</span><span class="crayon-s">'blue'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-s">'train'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-82"><span class="crayon-h">		</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">histories</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-v">history</span><span class="crayon-sy">[</span><span class="crayon-s">'val_loss'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">color</span><span class="crayon-o">=</span><span class="crayon-s">'orange'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-s">'test'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-83"><span class="crayon-h">		</span><span class="crayon-p"># plot accuracy</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-84"><span class="crayon-h">		</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-85"><span class="crayon-h">		</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">title</span><span class="crayon-sy">(</span><span class="crayon-s">'Classification Accuracy'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-86"><span class="crayon-h">		</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">histories</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-v">history</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">color</span><span class="crayon-o">=</span><span class="crayon-s">'blue'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-s">'train'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-87"><span class="crayon-h">		</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">histories</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-v">history</span><span class="crayon-sy">[</span><span class="crayon-s">'val_accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">color</span><span class="crayon-o">=</span><span class="crayon-s">'orange'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-s">'test'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-88"><span class="crayon-h">	</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-89">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-90"><span class="crayon-p"># summarize model performance</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-91"><span class="crayon-e">def </span><span class="crayon-e">summarize_performance</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-92"><span class="crayon-h">	</span><span class="crayon-p"># print summary</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-93"><span class="crayon-h">	</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Accuracy: mean=%.3f std=%.3f, n=%d'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">std</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-94"><span class="crayon-h">	</span><span class="crayon-p"># box and whisker plots of results</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-95"><span class="crayon-h">	</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">boxplot</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-96"><span class="crayon-h">	</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-97">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-98"><span class="crayon-p"># run the test harness for evaluating a model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-99"><span class="crayon-e">def </span><span class="crayon-e">run_test_harness</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-100"><span class="crayon-h">	</span><span class="crayon-p"># load dataset</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-101"><span class="crayon-h">	</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_dataset</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-102"><span class="crayon-h">	</span><span class="crayon-p"># prepare pixel data</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-103"><span class="crayon-h">	</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">prep_pixels</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-104"><span class="crayon-h">	</span><span class="crayon-p"># evaluate model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-105"><span class="crayon-h">	</span><span class="crayon-v">scores</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">histories</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">evaluate_model</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-106"><span class="crayon-h">	</span><span class="crayon-p"># learning curves</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-107"><span class="crayon-h">	</span><span class="crayon-e">summarize_diagnostics</span><span class="crayon-sy">(</span><span class="crayon-v">histories</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-108"><span class="crayon-h">	</span><span class="crayon-p"># summarize estimated performance</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-109"><span class="crayon-h">	</span><span class="crayon-e">summarize_performance</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-110">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-111"><span class="crayon-p"># entry point, run the test harness</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c3941066651-112"><span class="crayon-e">run_test_harness</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>Running the example again reports model performance for each fold of the cross-validation process.</p>
<p><strong>Note</strong>: Your <a href="https://machinelearningmastery.com/different-results-each-time-in-machine-learning/">results may vary</a> given the stochastic nature of the algorithm or evaluation procedure, or differences in numerical precision. Consider running the example a few times and compare the average outcome.</p>

<p>We can see perhaps a small drop in model performance as compared to the baseline across the cross-validation folds.</p>
		<div id="urvanov-syntax-highlighter-619c550b940c4116337826" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
&gt; 98.475
&gt; 98.608
&gt; 98.683
&gt; 98.783
&gt; 98.667</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c4116337826-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c4116337826-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c4116337826-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c4116337826-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c4116337826-5">5</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c4116337826-1">&gt; 98.475</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c4116337826-2">&gt; 98.608</div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c4116337826-3">&gt; 98.683</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c4116337826-4">&gt; 98.783</div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c4116337826-5">&gt; 98.667</div></div></td>
					</tr>
				</table>
			</div>
		</div><p>A plot of the learning curves is created, in this case showing that the speed of learning (improvement over epochs) does not appear to be different from the baseline model.</p>
<p>The plots suggest that batch normalization, at least as implemented in this case, does not offer any benefit.</p>
<div id="attachment_9973" style="width: 1290px" class="wp-caption aligncenter"><img aria-describedby="caption-attachment-9973" loading="lazy" class="size-full wp-image-9973" src="https://machinelearningmastery.com/wp-content/uploads/2019/05/Loss-and-Accuracy-Learning-Curves-for-the-BatchNormalization-Model-During-k-Fold-Cross-Validation2.png" alt="Loss and Accuracy Learning Curves for the BatchNormalization Model During k-Fold Cross-Validation" width="1280" height="960" srcset="https://machinelearningmastery.com/wp-content/uploads/2019/05/Loss-and-Accuracy-Learning-Curves-for-the-BatchNormalization-Model-During-k-Fold-Cross-Validation2.png 1280w, https://machinelearningmastery.com/wp-content/uploads/2019/05/Loss-and-Accuracy-Learning-Curves-for-the-BatchNormalization-Model-During-k-Fold-Cross-Validation2-300x225.png 300w, https://machinelearningmastery.com/wp-content/uploads/2019/05/Loss-and-Accuracy-Learning-Curves-for-the-BatchNormalization-Model-During-k-Fold-Cross-Validation2-1024x768.png 1024w, https://machinelearningmastery.com/wp-content/uploads/2019/05/Loss-and-Accuracy-Learning-Curves-for-the-BatchNormalization-Model-During-k-Fold-Cross-Validation2-768x576.png 768w" sizes="(max-width: 1280px) 100vw, 1280px" /><p id="caption-attachment-9973" class="wp-caption-text">Loss and Accuracy Learning Curves for the BatchNormalization Model During k-Fold Cross-Validation</p></div>
<p>Next, the estimated performance of the model is presented, showing performance with a slight decrease in the mean accuracy of the model: 98.643 as compared to 98.677 with the baseline model.</p>
		<div id="urvanov-syntax-highlighter-619c550b940c5721100769" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
Accuracy: mean=98.643 std=0.101, n=5</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c5721100769-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c5721100769-1">Accuracy: mean=98.643 std=0.101, n=5</div></div></td>
					</tr>
				</table>
			</div>
		</div><p><div id="attachment_9974" style="width: 1290px" class="wp-caption aligncenter"><img aria-describedby="caption-attachment-9974" loading="lazy" class="size-full wp-image-9974" src="https://machinelearningmastery.com/wp-content/uploads/2019/05/Box-and-Whisker-Plot-of-Accuracy-Scores-for-the-BatchNormalization-Model-Evaluated-Using-k-Fold-Cross-Validation2.png" alt="Box and Whisker Plot of Accuracy Scores for the BatchNormalization Model Evaluated Using k-Fold Cross-Validation" width="1280" height="960" srcset="https://machinelearningmastery.com/wp-content/uploads/2019/05/Box-and-Whisker-Plot-of-Accuracy-Scores-for-the-BatchNormalization-Model-Evaluated-Using-k-Fold-Cross-Validation2.png 1280w, https://machinelearningmastery.com/wp-content/uploads/2019/05/Box-and-Whisker-Plot-of-Accuracy-Scores-for-the-BatchNormalization-Model-Evaluated-Using-k-Fold-Cross-Validation2-300x225.png 300w, https://machinelearningmastery.com/wp-content/uploads/2019/05/Box-and-Whisker-Plot-of-Accuracy-Scores-for-the-BatchNormalization-Model-Evaluated-Using-k-Fold-Cross-Validation2-1024x768.png 1024w, https://machinelearningmastery.com/wp-content/uploads/2019/05/Box-and-Whisker-Plot-of-Accuracy-Scores-for-the-BatchNormalization-Model-Evaluated-Using-k-Fold-Cross-Validation2-768x576.png 768w" sizes="(max-width: 1280px) 100vw, 1280px" /><p id="caption-attachment-9974" class="wp-caption-text">Box and Whisker Plot of Accuracy Scores for the BatchNormalization Model Evaluated Using k-Fold Cross-Validation</p></div></p>
<h3>Increase in Model Depth</h3>
<p>There are many ways to change the model configuration in order to explore improvements over the baseline model.</p>
<p>Two common approaches involve changing the <a href="https://machinelearningmastery.com/how-to-control-neural-network-model-capacity-with-nodes-and-layers/">capacity</a> of the feature extraction part of the model or changing the capacity or function of the classifier part of the model. Perhaps the point of biggest influence is a change to the feature extractor.</p>
<p>We can increase the depth of the feature extractor part of the model, following a <a href="https://machinelearningmastery.com/how-to-implement-major-architecture-innovations-for-convolutional-neural-networks/">VGG-like pattern</a> of adding more convolutional and pooling layers with the same sized filter, while increasing the number of filters. In this case, we will add a double convolutional layer with 64 filters each, followed by another max pooling layer.</p>
<p>The updated version of the <em>define_model()</em> function with this change is listed below.</p>
		<div id="urvanov-syntax-highlighter-619c550b940c6008184260" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# define cnn model
def define_model():
	model = Sequential()
	model.add(Conv2D(32, (3, 3), activation='relu', kernel_initializer='he_uniform', input_shape=(28, 28, 1)))
	model.add(MaxPooling2D((2, 2)))
	model.add(Conv2D(64, (3, 3), activation='relu', kernel_initializer='he_uniform'))
	model.add(Conv2D(64, (3, 3), activation='relu', kernel_initializer='he_uniform'))
	model.add(MaxPooling2D((2, 2)))
	model.add(Flatten())
	model.add(Dense(100, activation='relu', kernel_initializer='he_uniform'))
	model.add(Dense(10, activation='softmax'))
	# compile model
	opt = SGD(learning_rate=0.01, momentum=0.9)
	model.compile(optimizer=opt, loss='categorical_crossentropy', metrics=['accuracy'])
	return model</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c6008184260-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c6008184260-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c6008184260-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c6008184260-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c6008184260-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c6008184260-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c6008184260-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c6008184260-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c6008184260-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c6008184260-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c6008184260-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c6008184260-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c6008184260-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c6008184260-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c6008184260-15">15</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c6008184260-1"><span class="crayon-p"># define cnn model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c6008184260-2"><span class="crayon-e">def </span><span class="crayon-e">define_model</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c6008184260-3"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c6008184260-4"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">32</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'he_uniform'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c6008184260-5"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">MaxPooling2D</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c6008184260-6"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">64</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'he_uniform'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c6008184260-7"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">64</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'he_uniform'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c6008184260-8"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">MaxPooling2D</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c6008184260-9"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Flatten</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c6008184260-10"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'he_uniform'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c6008184260-11"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'softmax'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c6008184260-12"><span class="crayon-h">	</span><span class="crayon-p"># compile model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c6008184260-13"><span class="crayon-h">	</span><span class="crayon-v">opt</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">SGD</span><span class="crayon-sy">(</span><span class="crayon-v">learning_rate</span><span class="crayon-o">=</span><span class="crayon-cn">0.01</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">momentum</span><span class="crayon-o">=</span><span class="crayon-cn">0.9</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c6008184260-14"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-v">opt</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'categorical_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c6008184260-15"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">model</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>For completeness, the entire code listing, including this change, is provided below.</p>
		<div id="urvanov-syntax-highlighter-619c550b940c7005808816" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# deeper cnn model for mnist
from numpy import mean
from numpy import std
from matplotlib import pyplot as plt
from sklearn.model_selection import KFold
from tensorflow.keras.datasets import mnist
from tensorflow.keras.utils import to_categorical
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Conv2D
from tensorflow.keras.layers import MaxPooling2D
from tensorflow.keras.layers import Dense
from tensorflow.keras.layers import Flatten
from tensorflow.keras.optimizers import SGD

# load train and test dataset
def load_dataset():
	# load dataset
	(trainX, trainY), (testX, testY) = mnist.load_data()
	# reshape dataset to have a single channel
	trainX = trainX.reshape((trainX.shape[0], 28, 28, 1))
	testX = testX.reshape((testX.shape[0], 28, 28, 1))
	# one hot encode target values
	trainY = to_categorical(trainY)
	testY = to_categorical(testY)
	return trainX, trainY, testX, testY

# scale pixels
def prep_pixels(train, test):
	# convert from integers to floats
	train_norm = train.astype('float32')
	test_norm = test.astype('float32')
	# normalize to range 0-1
	train_norm = train_norm / 255.0
	test_norm = test_norm / 255.0
	# return normalized images
	return train_norm, test_norm

# define cnn model
def define_model():
	model = Sequential()
	model.add(Conv2D(32, (3, 3), activation='relu', kernel_initializer='he_uniform', input_shape=(28, 28, 1)))
	model.add(MaxPooling2D((2, 2)))
	model.add(Conv2D(64, (3, 3), activation='relu', kernel_initializer='he_uniform'))
	model.add(Conv2D(64, (3, 3), activation='relu', kernel_initializer='he_uniform'))
	model.add(MaxPooling2D((2, 2)))
	model.add(Flatten())
	model.add(Dense(100, activation='relu', kernel_initializer='he_uniform'))
	model.add(Dense(10, activation='softmax'))
	# compile model
	opt = SGD(learning_rate=0.01, momentum=0.9)
	model.compile(optimizer=opt, loss='categorical_crossentropy', metrics=['accuracy'])
	return model

# evaluate a model using k-fold cross-validation
def evaluate_model(dataX, dataY, n_folds=5):
	scores, histories = list(), list()
	# prepare cross validation
	kfold = KFold(n_folds, shuffle=True, random_state=1)
	# enumerate splits
	for train_ix, test_ix in kfold.split(dataX):
		# define model
		model = define_model()
		# select rows for train and test
		trainX, trainY, testX, testY = dataX[train_ix], dataY[train_ix], dataX[test_ix], dataY[test_ix]
		# fit model
		history = model.fit(trainX, trainY, epochs=10, batch_size=32, validation_data=(testX, testY), verbose=0)
		# evaluate model
		_, acc = model.evaluate(testX, testY, verbose=0)
		print('&gt; %.3f' % (acc * 100.0))
		# stores scores
		scores.append(acc)
		histories.append(history)
	return scores, histories

# plot diagnostic learning curves
def summarize_diagnostics(histories):
	for i in range(len(histories)):
		# plot loss
		plt.subplot(2, 1, 1)
		plt.title('Cross Entropy Loss')
		plt.plot(histories[i].history['loss'], color='blue', label='train')
		plt.plot(histories[i].history['val_loss'], color='orange', label='test')
		# plot accuracy
		plt.subplot(2, 1, 2)
		plt.title('Classification Accuracy')
		plt.plot(histories[i].history['accuracy'], color='blue', label='train')
		plt.plot(histories[i].history['val_accuracy'], color='orange', label='test')
	plt.show()

# summarize model performance
def summarize_performance(scores):
	# print summary
	print('Accuracy: mean=%.3f std=%.3f, n=%d' % (mean(scores)*100, std(scores)*100, len(scores)))
	# box and whisker plots of results
	plt.boxplot(scores)
	plt.show()

# run the test harness for evaluating a model
def run_test_harness():
	# load dataset
	trainX, trainY, testX, testY = load_dataset()
	# prepare pixel data
	trainX, testX = prep_pixels(trainX, testX)
	# evaluate model
	scores, histories = evaluate_model(trainX, trainY)
	# learning curves
	summarize_diagnostics(histories)
	# summarize estimated performance
	summarize_performance(scores)

# entry point, run the test harness
run_test_harness()</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-30">30</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-31">31</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-32">32</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-33">33</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-34">34</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-35">35</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-36">36</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-37">37</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-38">38</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-39">39</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-40">40</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-41">41</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-42">42</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-43">43</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-44">44</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-45">45</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-46">46</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-47">47</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-48">48</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-49">49</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-50">50</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-51">51</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-52">52</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-53">53</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-54">54</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-55">55</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-56">56</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-57">57</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-58">58</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-59">59</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-60">60</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-61">61</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-62">62</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-63">63</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-64">64</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-65">65</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-66">66</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-67">67</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-68">68</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-69">69</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-70">70</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-71">71</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-72">72</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-73">73</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-74">74</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-75">75</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-76">76</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-77">77</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-78">78</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-79">79</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-80">80</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-81">81</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-82">82</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-83">83</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-84">84</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-85">85</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-86">86</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-87">87</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-88">88</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-89">89</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-90">90</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-91">91</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-92">92</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-93">93</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-94">94</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-95">95</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-96">96</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-97">97</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-98">98</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-99">99</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-100">100</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-101">101</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-102">102</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-103">103</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-104">104</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-105">105</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-106">106</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-107">107</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-108">108</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-109">109</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-110">110</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-111">111</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c7005808816-112">112</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-1"><span class="crayon-p"># deeper cnn model for mnist</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-2"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">mean</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-3"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">std</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-4"><span class="crayon-e">from </span><span class="crayon-e">matplotlib </span><span class="crayon-e">import </span><span class="crayon-e">pyplot </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">plt</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-5"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">model_selection </span><span class="crayon-e">import </span><span class="crayon-e">KFold</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-6"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">datasets </span><span class="crayon-e">import </span><span class="crayon-e">mnist</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-7"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">utils </span><span class="crayon-e">import </span><span class="crayon-e">to_categorical</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-8"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-9"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Conv2D</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-10"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">MaxPooling2D</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-11"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-12"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Flatten</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-13"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">optimizers </span><span class="crayon-e">import </span><span class="crayon-i">SGD</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-14">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-15"><span class="crayon-p"># load train and test dataset</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-16"><span class="crayon-e">def </span><span class="crayon-e">load_dataset</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-17"><span class="crayon-h">	</span><span class="crayon-p"># load dataset</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-18"><span class="crayon-h">	</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testY</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">mnist</span><span class="crayon-sy">.</span><span class="crayon-e">load_data</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-19"><span class="crayon-h">	</span><span class="crayon-p"># reshape dataset to have a single channel</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-20"><span class="crayon-h">	</span><span class="crayon-v">trainX</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">trainX</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-21"><span class="crayon-h">	</span><span class="crayon-v">testX</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-22"><span class="crayon-h">	</span><span class="crayon-p"># one hot encode target values</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-23"><span class="crayon-h">	</span><span class="crayon-v">trainY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">to_categorical</span><span class="crayon-sy">(</span><span class="crayon-v">trainY</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-24"><span class="crayon-h">	</span><span class="crayon-v">testY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">to_categorical</span><span class="crayon-sy">(</span><span class="crayon-v">testY</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-25"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">testY</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-26">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-27"><span class="crayon-p"># scale pixels</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-28"><span class="crayon-e">def </span><span class="crayon-e">prep_pixels</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-29"><span class="crayon-h">	</span><span class="crayon-p"># convert from integers to floats</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-30"><span class="crayon-h">	</span><span class="crayon-v">train_norm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-31"><span class="crayon-h">	</span><span class="crayon-v">test_norm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-32"><span class="crayon-h">	</span><span class="crayon-p"># normalize to range 0-1</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-33"><span class="crayon-h">	</span><span class="crayon-v">train_norm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">train_norm</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">255.0</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-34"><span class="crayon-h">	</span><span class="crayon-v">test_norm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">test_norm</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">255.0</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-35"><span class="crayon-h">	</span><span class="crayon-p"># return normalized images</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-36"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">train_norm</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">_</span>norm</div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-37">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-38"><span class="crayon-p"># define cnn model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-39"><span class="crayon-e">def </span><span class="crayon-e">define_model</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-40"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-41"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">32</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'he_uniform'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-42"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">MaxPooling2D</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-43"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">64</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'he_uniform'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-44"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">64</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'he_uniform'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-45"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">MaxPooling2D</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-46"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Flatten</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-47"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'he_uniform'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-48"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'softmax'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-49"><span class="crayon-h">	</span><span class="crayon-p"># compile model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-50"><span class="crayon-h">	</span><span class="crayon-v">opt</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">SGD</span><span class="crayon-sy">(</span><span class="crayon-v">learning_rate</span><span class="crayon-o">=</span><span class="crayon-cn">0.01</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">momentum</span><span class="crayon-o">=</span><span class="crayon-cn">0.9</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-51"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-v">opt</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'categorical_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-52"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-53">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-54"><span class="crayon-p"># evaluate a model using k-fold cross-validation</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-55"><span class="crayon-e">def </span><span class="crayon-e">evaluate_model</span><span class="crayon-sy">(</span><span class="crayon-v">dataX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_folds</span><span class="crayon-o">=</span><span class="crayon-cn">5</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-56"><span class="crayon-h">	</span><span class="crayon-v">scores</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">histories</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-57"><span class="crayon-h">	</span><span class="crayon-p"># prepare cross validation</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-58"><span class="crayon-h">	</span><span class="crayon-v">kfold</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">KFold</span><span class="crayon-sy">(</span><span class="crayon-v">n_folds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">shuffle</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">random_state</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-59"><span class="crayon-h">	</span><span class="crayon-p"># enumerate splits</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-60"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">train_ix</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">test_ix </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">kfold</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-v">dataX</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-61"><span class="crayon-h">		</span><span class="crayon-p"># define model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-62"><span class="crayon-h">		</span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">define_model</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-63"><span class="crayon-h">		</span><span class="crayon-p"># select rows for train and test</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-64"><span class="crayon-h">		</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataX</span><span class="crayon-sy">[</span><span class="crayon-v">train_ix</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataY</span><span class="crayon-sy">[</span><span class="crayon-v">train_ix</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataX</span><span class="crayon-sy">[</span><span class="crayon-v">test_ix</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataY</span><span class="crayon-sy">[</span><span class="crayon-v">test_ix</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-65"><span class="crayon-h">		</span><span class="crayon-p"># fit model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-66"><span class="crayon-h">		</span><span class="crayon-v">history</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">32</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">validation_data</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testY</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-67"><span class="crayon-h">		</span><span class="crayon-p"># evaluate model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-68"><span class="crayon-h">		</span><span class="crayon-v">_</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">acc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">evaluate</span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-69"><span class="crayon-h">		</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'&gt; %.3f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e ">acc *</span><span class="crayon-h"> </span><span class="crayon-cn">100.0</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-70"><span class="crayon-h">		</span><span class="crayon-p"># stores scores</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-71"><span class="crayon-h">		</span><span class="crayon-v">scores</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">acc</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-72"><span class="crayon-h">		</span><span class="crayon-v">histories</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">history</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-73"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">histories</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-74">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-75"><span class="crayon-p"># plot diagnostic learning curves</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-76"><span class="crayon-e">def </span><span class="crayon-e">summarize_diagnostics</span><span class="crayon-sy">(</span><span class="crayon-v">histories</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-77"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">histories</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-78"><span class="crayon-h">		</span><span class="crayon-p"># plot loss</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-79"><span class="crayon-h">		</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-80"><span class="crayon-h">		</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">title</span><span class="crayon-sy">(</span><span class="crayon-s">'Cross Entropy Loss'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-81"><span class="crayon-h">		</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">histories</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-v">history</span><span class="crayon-sy">[</span><span class="crayon-s">'loss'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">color</span><span class="crayon-o">=</span><span class="crayon-s">'blue'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-s">'train'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-82"><span class="crayon-h">		</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">histories</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-v">history</span><span class="crayon-sy">[</span><span class="crayon-s">'val_loss'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">color</span><span class="crayon-o">=</span><span class="crayon-s">'orange'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-s">'test'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-83"><span class="crayon-h">		</span><span class="crayon-p"># plot accuracy</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-84"><span class="crayon-h">		</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-85"><span class="crayon-h">		</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">title</span><span class="crayon-sy">(</span><span class="crayon-s">'Classification Accuracy'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-86"><span class="crayon-h">		</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">histories</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-v">history</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">color</span><span class="crayon-o">=</span><span class="crayon-s">'blue'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-s">'train'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-87"><span class="crayon-h">		</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">histories</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-v">history</span><span class="crayon-sy">[</span><span class="crayon-s">'val_accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">color</span><span class="crayon-o">=</span><span class="crayon-s">'orange'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-s">'test'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-88"><span class="crayon-h">	</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-89">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-90"><span class="crayon-p"># summarize model performance</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-91"><span class="crayon-e">def </span><span class="crayon-e">summarize_performance</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-92"><span class="crayon-h">	</span><span class="crayon-p"># print summary</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-93"><span class="crayon-h">	</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Accuracy: mean=%.3f std=%.3f, n=%d'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">std</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-94"><span class="crayon-h">	</span><span class="crayon-p"># box and whisker plots of results</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-95"><span class="crayon-h">	</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">boxplot</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-96"><span class="crayon-h">	</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-97">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-98"><span class="crayon-p"># run the test harness for evaluating a model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-99"><span class="crayon-e">def </span><span class="crayon-e">run_test_harness</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-100"><span class="crayon-h">	</span><span class="crayon-p"># load dataset</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-101"><span class="crayon-h">	</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_dataset</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-102"><span class="crayon-h">	</span><span class="crayon-p"># prepare pixel data</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-103"><span class="crayon-h">	</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">prep_pixels</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-104"><span class="crayon-h">	</span><span class="crayon-p"># evaluate model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-105"><span class="crayon-h">	</span><span class="crayon-v">scores</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">histories</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">evaluate_model</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-106"><span class="crayon-h">	</span><span class="crayon-p"># learning curves</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-107"><span class="crayon-h">	</span><span class="crayon-e">summarize_diagnostics</span><span class="crayon-sy">(</span><span class="crayon-v">histories</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-108"><span class="crayon-h">	</span><span class="crayon-p"># summarize estimated performance</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-109"><span class="crayon-h">	</span><span class="crayon-e">summarize_performance</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-110">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-111"><span class="crayon-p"># entry point, run the test harness</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c7005808816-112"><span class="crayon-e">run_test_harness</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>Running the example reports model performance for each fold of the cross-validation process.</p>
<p><strong>Note</strong>: Your <a href="https://machinelearningmastery.com/different-results-each-time-in-machine-learning/">results may vary</a> given the stochastic nature of the algorithm or evaluation procedure, or differences in numerical precision. Consider running the example a few times and compare the average outcome.</p>

<p>The per-fold scores may suggest some improvement over the baseline.</p>
		<div id="urvanov-syntax-highlighter-619c550b940c8148099454" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
&gt; 99.058
&gt; 99.042
&gt; 98.883
&gt; 99.192
&gt; 99.133</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c8148099454-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c8148099454-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c8148099454-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940c8148099454-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940c8148099454-5">5</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c8148099454-1">&gt; 99.058</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c8148099454-2">&gt; 99.042</div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c8148099454-3">&gt; 98.883</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940c8148099454-4">&gt; 99.192</div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940c8148099454-5">&gt; 99.133</div></div></td>
					</tr>
				</table>
			</div>
		</div><p>A plot of the learning curves is created, in this case showing that the models still have a good fit on the problem, with no clear signs of overfitting. The plots may even suggest that further training epochs could be helpful.</p>
<div id="attachment_9975" style="width: 1290px" class="wp-caption aligncenter"><img aria-describedby="caption-attachment-9975" loading="lazy" class="size-full wp-image-9975" src="https://machinelearningmastery.com/wp-content/uploads/2019/05/Loss-and-Accuracy-Learning-Curves-for-the-Deeper-Model-During-k-Fold-Cross-Validation2.png" alt="Loss and Accuracy Learning Curves for the Deeper Model During k-Fold Cross-Validation" width="1280" height="960" srcset="https://machinelearningmastery.com/wp-content/uploads/2019/05/Loss-and-Accuracy-Learning-Curves-for-the-Deeper-Model-During-k-Fold-Cross-Validation2.png 1280w, https://machinelearningmastery.com/wp-content/uploads/2019/05/Loss-and-Accuracy-Learning-Curves-for-the-Deeper-Model-During-k-Fold-Cross-Validation2-300x225.png 300w, https://machinelearningmastery.com/wp-content/uploads/2019/05/Loss-and-Accuracy-Learning-Curves-for-the-Deeper-Model-During-k-Fold-Cross-Validation2-1024x768.png 1024w, https://machinelearningmastery.com/wp-content/uploads/2019/05/Loss-and-Accuracy-Learning-Curves-for-the-Deeper-Model-During-k-Fold-Cross-Validation2-768x576.png 768w" sizes="(max-width: 1280px) 100vw, 1280px" /><p id="caption-attachment-9975" class="wp-caption-text">Loss and Accuracy Learning Curves for the Deeper Model During k-Fold Cross-Validation</p></div>
<p>Next, the estimated performance of the model is presented, showing a small improvement in performance as compared to the baseline from 98.677 to 99.062, with a small drop in the standard deviation as well.</p>
		<div id="urvanov-syntax-highlighter-619c550b940cf883201127" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
Accuracy: mean=99.062 std=0.104, n=5</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940cf883201127-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940cf883201127-1">Accuracy: mean=99.062 std=0.104, n=5</div></div></td>
					</tr>
				</table>
			</div>
		</div><p><div id="attachment_9976" style="width: 1290px" class="wp-caption aligncenter"><img aria-describedby="caption-attachment-9976" loading="lazy" class="size-full wp-image-9976" src="https://machinelearningmastery.com/wp-content/uploads/2019/05/Box-and-Whisker-Plot-of-Accuracy-Scores-for-the-Deeper-Model-Evaluated-Using-k-Fold-Cross-Validation2.png" alt="Box and Whisker Plot of Accuracy Scores for the Deeper Model Evaluated Using k-Fold Cross-Validation" width="1280" height="960" srcset="https://machinelearningmastery.com/wp-content/uploads/2019/05/Box-and-Whisker-Plot-of-Accuracy-Scores-for-the-Deeper-Model-Evaluated-Using-k-Fold-Cross-Validation2.png 1280w, https://machinelearningmastery.com/wp-content/uploads/2019/05/Box-and-Whisker-Plot-of-Accuracy-Scores-for-the-Deeper-Model-Evaluated-Using-k-Fold-Cross-Validation2-300x225.png 300w, https://machinelearningmastery.com/wp-content/uploads/2019/05/Box-and-Whisker-Plot-of-Accuracy-Scores-for-the-Deeper-Model-Evaluated-Using-k-Fold-Cross-Validation2-1024x768.png 1024w, https://machinelearningmastery.com/wp-content/uploads/2019/05/Box-and-Whisker-Plot-of-Accuracy-Scores-for-the-Deeper-Model-Evaluated-Using-k-Fold-Cross-Validation2-768x576.png 768w" sizes="(max-width: 1280px) 100vw, 1280px" /><p id="caption-attachment-9976" class="wp-caption-text">Box and Whisker Plot of Accuracy Scores for the Deeper Model Evaluated Using k-Fold Cross-Validation</p></div></p>
<h2>How to Finalize the Model and Make Predictions</h2>
<p>The process of model improvement may continue for as long as we have ideas and the time and resources to test them out.</p>
<p>At some point, a final model configuration must be chosen and adopted. In this case, we will choose the deeper model as our final model.</p>
<p>First, we will finalize our model, but fitting a model on the entire training dataset and saving the model to file for later use. We will then load the model and evaluate its performance on the hold out test dataset to get an idea of how well the chosen model actually performs in practice. Finally, we will use the saved model to make a prediction on a single image.</p>
<h3>Save Final Model</h3>
<p>A final model is typically fit on all available data, such as the combination of all train and test dataset.</p>
<p>In this tutorial, we are intentionally holding back a test dataset so that we can estimate the performance of the final model, which can be a good idea in practice. As such, we will fit our model on the training dataset only.</p>
		<div id="urvanov-syntax-highlighter-619c550b940d0128493199" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# fit model
model.fit(trainX, trainY, epochs=10, batch_size=32, verbose=0)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d0128493199-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d0128493199-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d0128493199-1"><span class="crayon-p"># fit model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d0128493199-2"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">32</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>Once fit, we can save the final model to an H5 file by calling the <em>save()</em> function on the model and pass in the chosen filename.</p>
		<div id="urvanov-syntax-highlighter-619c550b940d1993362134" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# save model
model.save('final_model.h5')</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d1993362134-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d1993362134-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d1993362134-1"><span class="crayon-p"># save model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d1993362134-2"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">save</span><span class="crayon-sy">(</span><span class="crayon-s">'final_model.h5'</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>Note, saving and loading a Keras model requires that the <a href="https://www.h5py.org/">h5py library</a> is installed on your workstation.</p>
<p>The complete example of fitting the final deep model on the training dataset and saving it to file is listed below.</p>
		<div id="urvanov-syntax-highlighter-619c550b940d2913709492" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# save the final model to file
from tensorflow.keras.datasets import mnist
from tensorflow.keras.utils import to_categorical
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Conv2D
from tensorflow.keras.layers import MaxPooling2D
from tensorflow.keras.layers import Dense
from tensorflow.keras.layers import Flatten
from tensorflow.keras.optimizers import SGD

# load train and test dataset
def load_dataset():
	# load dataset
	(trainX, trainY), (testX, testY) = mnist.load_data()
	# reshape dataset to have a single channel
	trainX = trainX.reshape((trainX.shape[0], 28, 28, 1))
	testX = testX.reshape((testX.shape[0], 28, 28, 1))
	# one hot encode target values
	trainY = to_categorical(trainY)
	testY = to_categorical(testY)
	return trainX, trainY, testX, testY

# scale pixels
def prep_pixels(train, test):
	# convert from integers to floats
	train_norm = train.astype('float32')
	test_norm = test.astype('float32')
	# normalize to range 0-1
	train_norm = train_norm / 255.0
	test_norm = test_norm / 255.0
	# return normalized images
	return train_norm, test_norm

# define cnn model
def define_model():
	model = Sequential()
	model.add(Conv2D(32, (3, 3), activation='relu', kernel_initializer='he_uniform', input_shape=(28, 28, 1)))
	model.add(MaxPooling2D((2, 2)))
	model.add(Conv2D(64, (3, 3), activation='relu', kernel_initializer='he_uniform'))
	model.add(Conv2D(64, (3, 3), activation='relu', kernel_initializer='he_uniform'))
	model.add(MaxPooling2D((2, 2)))
	model.add(Flatten())
	model.add(Dense(100, activation='relu', kernel_initializer='he_uniform'))
	model.add(Dense(10, activation='softmax'))
	# compile model
	opt = SGD(learning_rate=0.01, momentum=0.9)
	model.compile(optimizer=opt, loss='categorical_crossentropy', metrics=['accuracy'])
	return model

# run the test harness for evaluating a model
def run_test_harness():
	# load dataset
	trainX, trainY, testX, testY = load_dataset()
	# prepare pixel data
	trainX, testX = prep_pixels(trainX, testX)
	# define model
	model = define_model()
	# fit model
	model.fit(trainX, trainY, epochs=10, batch_size=32, verbose=0)
	# save model
	model.save('final_model.h5')

# entry point, run the test harness
run_test_harness()</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d2913709492-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d2913709492-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d2913709492-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d2913709492-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d2913709492-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d2913709492-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d2913709492-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d2913709492-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d2913709492-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d2913709492-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d2913709492-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d2913709492-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d2913709492-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d2913709492-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d2913709492-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d2913709492-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d2913709492-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d2913709492-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d2913709492-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d2913709492-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d2913709492-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d2913709492-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d2913709492-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d2913709492-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d2913709492-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d2913709492-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d2913709492-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d2913709492-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d2913709492-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d2913709492-30">30</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d2913709492-31">31</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d2913709492-32">32</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d2913709492-33">33</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d2913709492-34">34</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d2913709492-35">35</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d2913709492-36">36</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d2913709492-37">37</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d2913709492-38">38</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d2913709492-39">39</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d2913709492-40">40</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d2913709492-41">41</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d2913709492-42">42</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d2913709492-43">43</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d2913709492-44">44</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d2913709492-45">45</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d2913709492-46">46</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d2913709492-47">47</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d2913709492-48">48</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d2913709492-49">49</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d2913709492-50">50</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d2913709492-51">51</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d2913709492-52">52</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d2913709492-53">53</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d2913709492-54">54</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d2913709492-55">55</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d2913709492-56">56</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d2913709492-57">57</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d2913709492-58">58</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d2913709492-59">59</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d2913709492-60">60</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d2913709492-61">61</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d2913709492-62">62</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d2913709492-63">63</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d2913709492-64">64</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d2913709492-1"><span class="crayon-p"># save the final model to file</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d2913709492-2"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">datasets </span><span class="crayon-e">import </span><span class="crayon-e">mnist</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d2913709492-3"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">utils </span><span class="crayon-e">import </span><span class="crayon-e">to_categorical</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d2913709492-4"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d2913709492-5"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Conv2D</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d2913709492-6"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">MaxPooling2D</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d2913709492-7"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d2913709492-8"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Flatten</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d2913709492-9"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">optimizers </span><span class="crayon-e">import </span><span class="crayon-i">SGD</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d2913709492-10">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d2913709492-11"><span class="crayon-p"># load train and test dataset</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d2913709492-12"><span class="crayon-e">def </span><span class="crayon-e">load_dataset</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d2913709492-13"><span class="crayon-h">	</span><span class="crayon-p"># load dataset</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d2913709492-14"><span class="crayon-h">	</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testY</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">mnist</span><span class="crayon-sy">.</span><span class="crayon-e">load_data</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d2913709492-15"><span class="crayon-h">	</span><span class="crayon-p"># reshape dataset to have a single channel</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d2913709492-16"><span class="crayon-h">	</span><span class="crayon-v">trainX</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">trainX</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d2913709492-17"><span class="crayon-h">	</span><span class="crayon-v">testX</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d2913709492-18"><span class="crayon-h">	</span><span class="crayon-p"># one hot encode target values</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d2913709492-19"><span class="crayon-h">	</span><span class="crayon-v">trainY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">to_categorical</span><span class="crayon-sy">(</span><span class="crayon-v">trainY</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d2913709492-20"><span class="crayon-h">	</span><span class="crayon-v">testY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">to_categorical</span><span class="crayon-sy">(</span><span class="crayon-v">testY</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d2913709492-21"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">testY</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d2913709492-22">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d2913709492-23"><span class="crayon-p"># scale pixels</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d2913709492-24"><span class="crayon-e">def </span><span class="crayon-e">prep_pixels</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d2913709492-25"><span class="crayon-h">	</span><span class="crayon-p"># convert from integers to floats</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d2913709492-26"><span class="crayon-h">	</span><span class="crayon-v">train_norm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d2913709492-27"><span class="crayon-h">	</span><span class="crayon-v">test_norm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d2913709492-28"><span class="crayon-h">	</span><span class="crayon-p"># normalize to range 0-1</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d2913709492-29"><span class="crayon-h">	</span><span class="crayon-v">train_norm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">train_norm</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">255.0</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d2913709492-30"><span class="crayon-h">	</span><span class="crayon-v">test_norm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">test_norm</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">255.0</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d2913709492-31"><span class="crayon-h">	</span><span class="crayon-p"># return normalized images</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d2913709492-32"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">train_norm</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">_</span>norm</div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d2913709492-33">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d2913709492-34"><span class="crayon-p"># define cnn model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d2913709492-35"><span class="crayon-e">def </span><span class="crayon-e">define_model</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d2913709492-36"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d2913709492-37"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">32</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'he_uniform'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d2913709492-38"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">MaxPooling2D</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d2913709492-39"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">64</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'he_uniform'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d2913709492-40"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">64</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'he_uniform'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d2913709492-41"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">MaxPooling2D</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d2913709492-42"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Flatten</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d2913709492-43"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'he_uniform'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d2913709492-44"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'softmax'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d2913709492-45"><span class="crayon-h">	</span><span class="crayon-p"># compile model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d2913709492-46"><span class="crayon-h">	</span><span class="crayon-v">opt</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">SGD</span><span class="crayon-sy">(</span><span class="crayon-v">learning_rate</span><span class="crayon-o">=</span><span class="crayon-cn">0.01</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">momentum</span><span class="crayon-o">=</span><span class="crayon-cn">0.9</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d2913709492-47"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-v">opt</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'categorical_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d2913709492-48"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d2913709492-49">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d2913709492-50"><span class="crayon-p"># run the test harness for evaluating a model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d2913709492-51"><span class="crayon-e">def </span><span class="crayon-e">run_test_harness</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d2913709492-52"><span class="crayon-h">	</span><span class="crayon-p"># load dataset</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d2913709492-53"><span class="crayon-h">	</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_dataset</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d2913709492-54"><span class="crayon-h">	</span><span class="crayon-p"># prepare pixel data</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d2913709492-55"><span class="crayon-h">	</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">prep_pixels</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d2913709492-56"><span class="crayon-h">	</span><span class="crayon-p"># define model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d2913709492-57"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">define_model</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d2913709492-58"><span class="crayon-h">	</span><span class="crayon-p"># fit model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d2913709492-59"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">32</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d2913709492-60"><span class="crayon-h">	</span><span class="crayon-p"># save model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d2913709492-61"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">save</span><span class="crayon-sy">(</span><span class="crayon-s">'final_model.h5'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d2913709492-62">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d2913709492-63"><span class="crayon-p"># entry point, run the test harness</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d2913709492-64"><span class="crayon-e">run_test_harness</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>After running this example, you will now have a 1.2-megabyte file with the name &#8216;<em>final_model.h5</em>&#8216; in your current working directory.</p>
<h3>Evaluate Final Model</h3>
<p>We can now load the final model and evaluate it on the hold out test dataset.</p>
<p>This is something we might do if we were interested in presenting the performance of the chosen model to project stakeholders.</p>
<p>The model can be loaded via the <em>load_model()</em> function.</p>
<p>The complete example of loading the saved model and evaluating it on the test dataset is listed below.</p>
		<div id="urvanov-syntax-highlighter-619c550b940d3195622341" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# evaluate the deep model on the test dataset
from tensorflow.keras.datasets import mnist
from tensorflow.keras.models import load_model
from tensorflow.keras.utils import to_categorical

# load train and test dataset
def load_dataset():
	# load dataset
	(trainX, trainY), (testX, testY) = mnist.load_data()
	# reshape dataset to have a single channel
	trainX = trainX.reshape((trainX.shape[0], 28, 28, 1))
	testX = testX.reshape((testX.shape[0], 28, 28, 1))
	# one hot encode target values
	trainY = to_categorical(trainY)
	testY = to_categorical(testY)
	return trainX, trainY, testX, testY

# scale pixels
def prep_pixels(train, test):
	# convert from integers to floats
	train_norm = train.astype('float32')
	test_norm = test.astype('float32')
	# normalize to range 0-1
	train_norm = train_norm / 255.0
	test_norm = test_norm / 255.0
	# return normalized images
	return train_norm, test_norm

# run the test harness for evaluating a model
def run_test_harness():
	# load dataset
	trainX, trainY, testX, testY = load_dataset()
	# prepare pixel data
	trainX, testX = prep_pixels(trainX, testX)
	# load model
	model = load_model('final_model.h5')
	# evaluate model on test dataset
	_, acc = model.evaluate(testX, testY, verbose=0)
	print('&gt; %.3f' % (acc * 100.0))

# entry point, run the test harness
run_test_harness()</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d3195622341-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d3195622341-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d3195622341-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d3195622341-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d3195622341-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d3195622341-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d3195622341-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d3195622341-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d3195622341-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d3195622341-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d3195622341-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d3195622341-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d3195622341-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d3195622341-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d3195622341-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d3195622341-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d3195622341-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d3195622341-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d3195622341-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d3195622341-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d3195622341-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d3195622341-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d3195622341-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d3195622341-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d3195622341-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d3195622341-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d3195622341-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d3195622341-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d3195622341-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d3195622341-30">30</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d3195622341-31">31</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d3195622341-32">32</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d3195622341-33">33</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d3195622341-34">34</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d3195622341-35">35</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d3195622341-36">36</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d3195622341-37">37</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d3195622341-38">38</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d3195622341-39">39</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d3195622341-40">40</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d3195622341-41">41</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d3195622341-42">42</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d3195622341-1"><span class="crayon-p"># evaluate the deep model on the test dataset</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d3195622341-2"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">datasets </span><span class="crayon-e">import </span><span class="crayon-e">mnist</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d3195622341-3"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">load_model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d3195622341-4"><span class="crayon-e">from </span><span class="crayon-v">tensorflow</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">utils </span><span class="crayon-e">import </span><span class="crayon-v">to</span><span class="crayon-sy">_</span>categorical</div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d3195622341-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d3195622341-6"><span class="crayon-p"># load train and test dataset</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d3195622341-7"><span class="crayon-e">def </span><span class="crayon-e">load_dataset</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d3195622341-8"><span class="crayon-h">	</span><span class="crayon-p"># load dataset</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d3195622341-9"><span class="crayon-h">	</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testY</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">mnist</span><span class="crayon-sy">.</span><span class="crayon-e">load_data</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d3195622341-10"><span class="crayon-h">	</span><span class="crayon-p"># reshape dataset to have a single channel</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d3195622341-11"><span class="crayon-h">	</span><span class="crayon-v">trainX</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">trainX</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d3195622341-12"><span class="crayon-h">	</span><span class="crayon-v">testX</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d3195622341-13"><span class="crayon-h">	</span><span class="crayon-p"># one hot encode target values</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d3195622341-14"><span class="crayon-h">	</span><span class="crayon-v">trainY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">to_categorical</span><span class="crayon-sy">(</span><span class="crayon-v">trainY</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d3195622341-15"><span class="crayon-h">	</span><span class="crayon-v">testY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">to_categorical</span><span class="crayon-sy">(</span><span class="crayon-v">testY</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d3195622341-16"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">testY</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d3195622341-17">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d3195622341-18"><span class="crayon-p"># scale pixels</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d3195622341-19"><span class="crayon-e">def </span><span class="crayon-e">prep_pixels</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d3195622341-20"><span class="crayon-h">	</span><span class="crayon-p"># convert from integers to floats</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d3195622341-21"><span class="crayon-h">	</span><span class="crayon-v">train_norm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d3195622341-22"><span class="crayon-h">	</span><span class="crayon-v">test_norm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d3195622341-23"><span class="crayon-h">	</span><span class="crayon-p"># normalize to range 0-1</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d3195622341-24"><span class="crayon-h">	</span><span class="crayon-v">train_norm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">train_norm</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">255.0</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d3195622341-25"><span class="crayon-h">	</span><span class="crayon-v">test_norm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">test_norm</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">255.0</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d3195622341-26"><span class="crayon-h">	</span><span class="crayon-p"># return normalized images</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d3195622341-27"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">train_norm</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">_</span>norm</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d3195622341-28">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d3195622341-29"><span class="crayon-p"># run the test harness for evaluating a model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d3195622341-30"><span class="crayon-e">def </span><span class="crayon-e">run_test_harness</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d3195622341-31"><span class="crayon-h">	</span><span class="crayon-p"># load dataset</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d3195622341-32"><span class="crayon-h">	</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_dataset</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d3195622341-33"><span class="crayon-h">	</span><span class="crayon-p"># prepare pixel data</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d3195622341-34"><span class="crayon-h">	</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">prep_pixels</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d3195622341-35"><span class="crayon-h">	</span><span class="crayon-p"># load model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d3195622341-36"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_model</span><span class="crayon-sy">(</span><span class="crayon-s">'final_model.h5'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d3195622341-37"><span class="crayon-h">	</span><span class="crayon-p"># evaluate model on test dataset</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d3195622341-38"><span class="crayon-h">	</span><span class="crayon-v">_</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">acc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">evaluate</span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d3195622341-39"><span class="crayon-h">	</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'&gt; %.3f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e ">acc *</span><span class="crayon-h"> </span><span class="crayon-cn">100.0</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d3195622341-40">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d3195622341-41"><span class="crayon-p"># entry point, run the test harness</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d3195622341-42"><span class="crayon-e">run_test_harness</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>Running the example loads the saved model and evaluates the model on the hold out test dataset.</p>
<p><strong>Note</strong>: Your <a href="https://machinelearningmastery.com/different-results-each-time-in-machine-learning/">results may vary</a> given the stochastic nature of the algorithm or evaluation procedure, or differences in numerical precision. Consider running the example a few times and compare the average outcome.</p>

<p>The classification accuracy for the model on the test dataset is calculated and printed. In this case, we can see that the model achieved an accuracy of 99.090%, or just less than 1%, which is not bad at all and reasonably close to the estimated 99.753% with a standard deviation of about half a percent (e.g. 99% of scores).</p>
		<div id="urvanov-syntax-highlighter-619c550b940d4875325574" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
&gt; 99.090</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d4875325574-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d4875325574-1">&gt; 99.090</div></div></td>
					</tr>
				</table>
			</div>
		</div><p></p>
<h3>Make Prediction</h3>
<p>We can use our saved model to make a prediction on new images.</p>
<p>The model assumes that new images are grayscale, that they have been aligned so that one image contains one centered handwritten digit, and that the size of the image is square with the size 28&#215;28 pixels.</p>
<p>Below is an image extracted from the MNIST test dataset. You can save it in your current working directory with the filename &#8216;<em>sample_image.png</em>&#8216;.</p>
<div id="attachment_7562" style="width: 310px" class="wp-caption aligncenter"><img aria-describedby="caption-attachment-7562" loading="lazy" class="wp-image-7562 size-medium" src="https://machinelearningmastery.com/wp-content/uploads/2019/02/sample_image-300x298.png" alt="Sample Handwritten Digit" width="300" height="298" srcset="https://machinelearningmastery.com/wp-content/uploads/2019/02/sample_image-300x298.png 300w, https://machinelearningmastery.com/wp-content/uploads/2019/02/sample_image-150x150.png 150w, https://machinelearningmastery.com/wp-content/uploads/2019/02/sample_image-768x763.png 768w, https://machinelearningmastery.com/wp-content/uploads/2019/02/sample_image-1024x1017.png 1024w, https://machinelearningmastery.com/wp-content/uploads/2019/02/sample_image.png 1490w" sizes="(max-width: 300px) 100vw, 300px" /><p id="caption-attachment-7562" class="wp-caption-text">Sample Handwritten Digit</p></div>
<ul>
<li><a href="https://machinelearningmastery.com/wp-content/uploads/2019/02/sample_image.png">Download the sample image (sample_image.png)</a></li>
</ul>
<p>We will pretend this is an entirely new and unseen image, prepared in the required way, and see how we might use our saved model to predict the integer that the image represents (e.g. we expect &#8220;<em>7</em>&#8220;).</p>
<p>First, we can load the image, force it to be in grayscale format, and force the size to be 28&#215;28 pixels. The loaded image can then be resized to have a single channel and represent a single sample in a dataset. The <em>load_image()</em> function implements this and will return the loaded image ready for classification.</p>
<p>Importantly, the pixel values are prepared in the same way as the pixel values were prepared for the training dataset when fitting the final model, in this case, normalized.</p>
		<div id="urvanov-syntax-highlighter-619c550b940d5039302297" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# load and prepare the image
def load_image(filename):
	# load the image
	img = load_img(filename, grayscale=True, target_size=(28, 28))
	# convert to array
	img = img_to_array(img)
	# reshape into a single sample with 1 channel
	img = img.reshape(1, 28, 28, 1)
	# prepare pixel data
	img = img.astype('float32')
	img = img / 255.0
	return img</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d5039302297-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d5039302297-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d5039302297-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d5039302297-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d5039302297-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d5039302297-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d5039302297-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d5039302297-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d5039302297-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d5039302297-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d5039302297-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d5039302297-12">12</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d5039302297-1"><span class="crayon-p"># load and prepare the image</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d5039302297-2"><span class="crayon-e">def </span><span class="crayon-e">load_image</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d5039302297-3"><span class="crayon-h">	</span><span class="crayon-p"># load the image</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d5039302297-4"><span class="crayon-h">	</span><span class="crayon-v">img</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_img</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">grayscale</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">target_size</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d5039302297-5"><span class="crayon-h">	</span><span class="crayon-p"># convert to array</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d5039302297-6"><span class="crayon-h">	</span><span class="crayon-v">img</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">img_to_array</span><span class="crayon-sy">(</span><span class="crayon-v">img</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d5039302297-7"><span class="crayon-h">	</span><span class="crayon-p"># reshape into a single sample with 1 channel</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d5039302297-8"><span class="crayon-h">	</span><span class="crayon-v">img</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">img</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d5039302297-9"><span class="crayon-h">	</span><span class="crayon-p"># prepare pixel data</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d5039302297-10"><span class="crayon-h">	</span><span class="crayon-v">img</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">img</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d5039302297-11"><span class="crayon-h">	</span><span class="crayon-v">img</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">img</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">255.0</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d5039302297-12"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">img</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>Next, we can load the model as in the previous section and call the <em>predict()</em> function to get the predicted score, and then use <em>argmax()</em> to obtain the digit that the image represents.</p>
		<div id="urvanov-syntax-highlighter-619c550b940d6360717106" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# predict the class
predict_value = model.predict(img)
digit = argmax(predict_value)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d6360717106-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d6360717106-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d6360717106-3">3</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d6360717106-1"><span class="crayon-p"># predict the class</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d6360717106-2"><span class="crayon-v">predict_value</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">img</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d6360717106-3"><span class="crayon-v">digit</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">argmax</span><span class="crayon-sy">(</span><span class="crayon-v">predict_value</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>The complete example is listed below.</p>
		<div id="urvanov-syntax-highlighter-619c550b940d7346888698" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# make a prediction for a new image.
from numpy import argmax
from keras.preprocessing.image import load_img
from keras.preprocessing.image import img_to_array
from keras.models import load_model

# load and prepare the image
def load_image(filename):
	# load the image
	img = load_img(filename, grayscale=True, target_size=(28, 28))
	# convert to array
	img = img_to_array(img)
	# reshape into a single sample with 1 channel
	img = img.reshape(1, 28, 28, 1)
	# prepare pixel data
	img = img.astype('float32')
	img = img / 255.0
	return img

# load an image and predict the class
def run_example():
	# load the image
	img = load_image('sample_image.png')
	# load model
	model = load_model('final_model.h5')
	# predict the class
	predict_value = model.predict(img)
	digit = argmax(predict_value)
	print(digit)

# entry point, run the example
run_example()</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d7346888698-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d7346888698-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d7346888698-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d7346888698-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d7346888698-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d7346888698-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d7346888698-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d7346888698-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d7346888698-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d7346888698-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d7346888698-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d7346888698-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d7346888698-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d7346888698-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d7346888698-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d7346888698-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d7346888698-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d7346888698-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d7346888698-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d7346888698-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d7346888698-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d7346888698-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d7346888698-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d7346888698-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d7346888698-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d7346888698-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d7346888698-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d7346888698-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d7346888698-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d7346888698-30">30</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d7346888698-31">31</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b940d7346888698-32">32</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d7346888698-1"><span class="crayon-p"># make a prediction for a new image.</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d7346888698-2"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">argmax</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d7346888698-3"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">preprocessing</span><span class="crayon-sy">.</span><span class="crayon-e">image </span><span class="crayon-e">import </span><span class="crayon-e">load_img</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d7346888698-4"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">preprocessing</span><span class="crayon-sy">.</span><span class="crayon-e">image </span><span class="crayon-e">import </span><span class="crayon-e">img_to_array</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d7346888698-5"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-v">load</span><span class="crayon-sy">_</span>model</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d7346888698-6">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d7346888698-7"><span class="crayon-p"># load and prepare the image</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d7346888698-8"><span class="crayon-e">def </span><span class="crayon-e">load_image</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d7346888698-9"><span class="crayon-h">	</span><span class="crayon-p"># load the image</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d7346888698-10"><span class="crayon-h">	</span><span class="crayon-v">img</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_img</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">grayscale</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">target_size</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d7346888698-11"><span class="crayon-h">	</span><span class="crayon-p"># convert to array</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d7346888698-12"><span class="crayon-h">	</span><span class="crayon-v">img</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">img_to_array</span><span class="crayon-sy">(</span><span class="crayon-v">img</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d7346888698-13"><span class="crayon-h">	</span><span class="crayon-p"># reshape into a single sample with 1 channel</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d7346888698-14"><span class="crayon-h">	</span><span class="crayon-v">img</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">img</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d7346888698-15"><span class="crayon-h">	</span><span class="crayon-p"># prepare pixel data</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d7346888698-16"><span class="crayon-h">	</span><span class="crayon-v">img</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">img</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d7346888698-17"><span class="crayon-h">	</span><span class="crayon-v">img</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">img</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">255.0</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d7346888698-18"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">img</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d7346888698-19">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d7346888698-20"><span class="crayon-p"># load an image and predict the class</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d7346888698-21"><span class="crayon-e">def </span><span class="crayon-e">run_example</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d7346888698-22"><span class="crayon-h">	</span><span class="crayon-p"># load the image</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d7346888698-23"><span class="crayon-h">	</span><span class="crayon-v">img</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_image</span><span class="crayon-sy">(</span><span class="crayon-s">'sample_image.png'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d7346888698-24"><span class="crayon-h">	</span><span class="crayon-p"># load model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d7346888698-25"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_model</span><span class="crayon-sy">(</span><span class="crayon-s">'final_model.h5'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d7346888698-26"><span class="crayon-h">	</span><span class="crayon-p"># predict the class</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d7346888698-27"><span class="crayon-h">	</span><span class="crayon-v">predict_value</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">img</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d7346888698-28"><span class="crayon-h">	</span><span class="crayon-v">digit</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">argmax</span><span class="crayon-sy">(</span><span class="crayon-v">predict_value</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d7346888698-29"><span class="crayon-h">	</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">digit</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d7346888698-30">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d7346888698-31"><span class="crayon-p"># entry point, run the example</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b940d7346888698-32"><span class="crayon-e">run_example</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>Running the example first loads and prepares the image, loads the model, and then correctly predicts that the loaded image represents the digit &#8216;<em>7</em>&#8216;.</p>
		<div id="urvanov-syntax-highlighter-619c550b940d8307934880" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
7</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b940d8307934880-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b940d8307934880-1">7</div></div></td>
					</tr>
				</table>
			</div>
		</div><p></p>
<h2>Extensions</h2>
<p>This section lists some ideas for extending the tutorial that you may wish to explore.</p>
<ul>
<li><strong>Tune Pixel Scaling</strong>. Explore how alternate pixel scaling methods impact model performance as compared to the baseline model, including centering and standardization.</li>
<li><strong>Tune the Learning Rate</strong>. Explore how different learning rates impact the model performance as compared to the baseline model, such as 0.001 and 0.0001.</li>
<li><strong>Tune Model Depth</strong>. Explore how adding more layers to the model impact the model performance as compared to the baseline model, such as another block of convolutional and pooling layers or another dense layer in the classifier part of the model.</li>
</ul>
<p>If you explore any of these extensions, I&#8217;d love to know.<br />
Post your findings in the comments below.</p>
<h2>Further Reading</h2>
<p>This section provides more resources on the topic if you are looking to go deeper.</p>
<h3>APIs</h3>
<ul>
<li><a href="https://keras.io/datasets/">Keras Datasets API</a></li>
<li><a href="https://github.com/keras-team/keras/tree/master/keras/datasets">Keras Datasets Code</a></li>
<li><a href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.KFold.html">sklearn.model_selection.KFold API</a></li>
</ul>
<h3>Articles</h3>
<ul>
<li><a href="https://en.wikipedia.org/wiki/MNIST_database">MNIST database, Wikipedia.</a></li>
<li><a href="https://rodrigob.github.io/are_we_there_yet/build/classification_datasets_results.html">Classification datasets results, What is the class of this image?</a></li>
</ul>
<h2>Summary</h2>
<p>In this tutorial, you discovered how to develop a convolutional neural network for handwritten digit classification from scratch.</p>
<p>Specifically, you learned:</p>
<ul>
<li>How to develop a test harness to develop a robust evaluation of a model and establish a baseline of performance for a classification task.</li>
<li>How to explore extensions to a baseline model to improve learning and model capacity.</li>
<li>How to develop a finalized model, evaluate the performance of the final model, and use it to make predictions on new images.</li>
</ul>
<p>Do you have any questions?<br />
Ask your questions in the comments below and I will do my best to answer.</p>
<div class="widget_text awac-wrapper" id="custom_html-65"><div class="widget_text awac widget custom_html-65"><div class="textwidget custom-html-widget"><div style="text-align: center;">
<div class="woo-sc-hr"></div>
<h2>Develop Deep Learning Models for Vision Today!</h2>
<a href="/deep-learning-for-computer-vision/" rel="nofollow"><img width="220" height="311" style="border: 0;" src="/wp-content/uploads/2019/03/Deep-Learning-for-Computer-Vision-220-1.png" alt="Deep Learning for Computer Vision" align="left" /></a>
<h4>Develop Your Own Vision Models in Minutes</h4>
<p>...with just a few lines of python code</p>

<p>Discover how in my new Ebook:<br>
<a href="/deep-learning-for-computer-vision/" rel="nofollow">Deep Learning for Computer Vision</a></p>

<p>It provides <strong>self-study tutorials</strong> on topics like:<br>
	<em>classification</em>, <em>object detection (yolo and rcnn)</em>, <em>face recognition (vggface and facenet)</em>, <em>data preparation</em> and much more...</p>

<h4>Finally Bring Deep Learning to your Vision Projects</h4>
	<p>Skip the Academics. Just Results.</p>

<a href="/deep-learning-for-computer-vision/" class="woo-sc-button  red" ><span class="woo-">See What's Inside</span></a>

<div class="woo-sc-hr"></div>
</div></div></div></div></p><div class="simplesocialbuttons simplesocial-simple-icons simplesocialbuttons_inline simplesocialbuttons-align-left post-7553 post  simplesocialbuttons-inline-no-animation">
<button class="ssb_tweet-icon" data-href="https://twitter.com/share?text=How+to+Develop+a+CNN+for+MNIST+Handwritten+Digit+Classification&url=https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/" rel="nofollow" onclick="if (!window.__cfRLUnblockHandlers) return false; javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" data-cf-modified-46b118dd096b29ef1b5fe745-="">
						<span class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 72 72"><path fill="none" d="M0 0h72v72H0z"/><path class="icon" fill="#fff" d="M68.812 15.14c-2.348 1.04-4.87 1.744-7.52 2.06 2.704-1.62 4.78-4.186 5.757-7.243-2.53 1.5-5.33 2.592-8.314 3.176C56.35 10.59 52.948 9 49.182 9c-7.23 0-13.092 5.86-13.092 13.093 0 1.026.118 2.02.338 2.98C25.543 24.527 15.9 19.318 9.44 11.396c-1.125 1.936-1.77 4.184-1.77 6.58 0 4.543 2.312 8.552 5.824 10.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163 0 6.345 4.513 11.638 10.504 12.84-1.1.298-2.256.457-3.45.457-.845 0-1.666-.078-2.464-.23 1.667 5.2 6.5 8.985 12.23 9.09-4.482 3.51-10.13 5.605-16.26 5.605-1.055 0-2.096-.06-3.122-.184 5.794 3.717 12.676 5.882 20.067 5.882 24.083 0 37.25-19.95 37.25-37.25 0-.565-.013-1.133-.038-1.693 2.558-1.847 4.778-4.15 6.532-6.774z"/></svg></span><i class="simplesocialtxt">Tweet </i></button>
		<button class="ssb_fbshare-icon" target="_blank" data-href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/" onclick="if (!window.__cfRLUnblockHandlers) return false; javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" data-cf-modified-46b118dd096b29ef1b5fe745-="">
						<span class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" class="_1pbq" color="#ffffff"><path fill="#ffffff" fill-rule="evenodd" class="icon" d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z"></path></svg></span>
						<span class="simplesocialtxt">Share </span> </button>
<button class="ssb_linkedin-icon" data-href="https://www.linkedin.com/cws/share?url=https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/" onclick="if (!window.__cfRLUnblockHandlers) return false; javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" data-cf-modified-46b118dd096b29ef1b5fe745-="">
						<span class="icon"> <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="15px" height="14.1px" viewBox="-301.4 387.5 15 14.1" enable-background="new -301.4 387.5 15 14.1" xml:space="preserve"> <g id="XMLID_398_"> <path id="XMLID_399_" fill="#FFFFFF" d="M-296.2,401.6c0-3.2,0-6.3,0-9.5h0.1c1,0,2,0,2.9,0c0.1,0,0.1,0,0.1,0.1c0,0.4,0,0.8,0,1.2 c0.1-0.1,0.2-0.3,0.3-0.4c0.5-0.7,1.2-1,2.1-1.1c0.8-0.1,1.5,0,2.2,0.3c0.7,0.4,1.2,0.8,1.5,1.4c0.4,0.8,0.6,1.7,0.6,2.5 c0,1.8,0,3.6,0,5.4v0.1c-1.1,0-2.1,0-3.2,0c0-0.1,0-0.1,0-0.2c0-1.6,0-3.2,0-4.8c0-0.4,0-0.8-0.2-1.2c-0.2-0.7-0.8-1-1.6-1 c-0.8,0.1-1.3,0.5-1.6,1.2c-0.1,0.2-0.1,0.5-0.1,0.8c0,1.7,0,3.4,0,5.1c0,0.2,0,0.2-0.2,0.2c-1,0-1.9,0-2.9,0 C-296.1,401.6-296.2,401.6-296.2,401.6z"/> <path id="XMLID_400_" fill="#FFFFFF" d="M-298,401.6L-298,401.6c-1.1,0-2.1,0-3,0c-0.1,0-0.1,0-0.1-0.1c0-3.1,0-6.1,0-9.2 c0-0.1,0-0.1,0.1-0.1c1,0,2,0,2.9,0h0.1C-298,395.3-298,398.5-298,401.6z"/> <path id="XMLID_401_" fill="#FFFFFF" d="M-299.6,390.9c-0.7-0.1-1.2-0.3-1.6-0.8c-0.5-0.8-0.2-2.1,1-2.4c0.6-0.2,1.2-0.1,1.8,0.2 c0.5,0.4,0.7,0.9,0.6,1.5c-0.1,0.7-0.5,1.1-1.1,1.3C-299.1,390.8-299.4,390.8-299.6,390.9L-299.6,390.9z"/> </g> </svg> </span>
						<span class="simplesocialtxt">Share</span> </button>
</div>
<div class="crp_related  "><h3>More On This Topic</h3><ul><li><a href="https://machinelearningmastery.com/how-to-develop-a-generative-adversarial-network-for-an-mnist-handwritten-digits-from-scratch-in-keras/"     class="crp_link post-8099"><figure><img loading="lazy"  width="150" height="150"  src="https://machinelearningmastery.com/wp-content/uploads/2019/04/Plot-of-100-GAN-Generated-MNIST-Figures-After-100-Epochs-150x150.png" class="crp_thumb crp_featured" alt="How to Develop a GAN for Generating MNIST Handwritten Digits" title="How to Develop a GAN for Generating MNIST Handwritten Digits" /></figure><span class="crp_title">How to Develop a GAN for Generating MNIST Handwritten Digits</span></a></li><li><a href="https://machinelearningmastery.com/handwritten-digit-recognition-using-convolutional-neural-networks-python-keras/"     class="crp_link post-2585"><figure><img loading="lazy"  width="150" height="150"  src="https://machinelearningmastery.com/wp-content/uploads/2016/05/Examples-from-the-MNIST-dataset-150x150.png" class="crp_thumb crp_featured" alt="Handwritten Digit Recognition using Convolutional Neural Networks in Python with Keras" title="Handwritten Digit Recognition using Convolutional Neural Networks in Python with Keras" /></figure><span class="crp_title">Handwritten Digit Recognition using Convolutional&hellip;</span></a></li><li><a href="https://machinelearningmastery.com/how-to-develop-a-cnn-from-scratch-for-fashion-mnist-clothing-classification/"     class="crp_link post-7565"><figure><img loading="lazy"  width="150" height="150"  src="https://machinelearningmastery.com/wp-content/uploads/2019/05/Loss-and-Accuracy-Learning-Curves-for-the-Baseline-Model-on-the-Fashion-MNIST-Dataset-During-k-Fold-Cross-Validation-150x150.png" class="crp_thumb crp_featured" alt="Deep Learning CNN for Fashion-MNIST Clothing Classification" title="Deep Learning CNN for Fashion-MNIST Clothing Classification" /></figure><span class="crp_title">Deep Learning CNN for Fashion-MNIST Clothing Classification</span></a></li><li><a href="https://machinelearningmastery.com/develop-n-gram-multichannel-convolutional-neural-network-sentiment-analysis/"     class="crp_link post-4586"><figure><img loading="lazy"  width="150" height="150"  src="https://machinelearningmastery.com/wp-content/uploads/2017/10/Plot-of-the-Multichannel-Convolutional-Neural-Network-For-Text-150x150.png" class="crp_thumb crp_featured" alt="How to Develop a Multichannel CNN Model for Text Classification" title="How to Develop a Multichannel CNN Model for Text Classification" /></figure><span class="crp_title">How to Develop a Multichannel CNN Model for Text&hellip;</span></a></li><li><a href="https://machinelearningmastery.com/how-to-develop-a-cnn-from-scratch-for-cifar-10-photo-classification/"     class="crp_link post-7576"><figure><img loading="lazy"  width="150" height="150"  src="https://machinelearningmastery.com/wp-content/uploads/2019/02/Line-Plots-of-Learning-Curves-for-Baseline-Model-With-Increasing-Dropout-Data-Augmentation-and-Batch-Normalization-on-the-CIFAR-10-Dataset-150x150.png" class="crp_thumb crp_featured" alt="How to Develop a CNN From Scratch for CIFAR-10 Photo Classification" title="How to Develop a CNN From Scratch for CIFAR-10 Photo Classification" /></figure><span class="crp_title">How to Develop a CNN From Scratch for CIFAR-10 Photo&hellip;</span></a></li><li><a href="https://machinelearningmastery.com/develop-bidirectional-lstm-sequence-classification-python-keras/"     class="crp_link post-4081"><figure><img loading="lazy"  width="150" height="150"  src="https://machinelearningmastery.com/wp-content/uploads/2017/05/Line-Plot-of-Log-Loss-for-an-LSTM-Reversed-LSTM-and-a-Bidirectional-LSTM-150x150.png" class="crp_thumb crp_featured" alt="How to Develop a Bidirectional LSTM For Sequence Classification in Python with Keras" title="How to Develop a Bidirectional LSTM For Sequence Classification in Python with Keras" /></figure><span class="crp_title">How to Develop a Bidirectional LSTM For Sequence&hellip;</span></a></li></ul><div class="crp_clear"></div></div>	</section><!-- /.entry -->
	<div class="fix"></div>
	<aside id="post-author">
	<div class="profile-image"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=160&#038;d=mm&#038;r=g 2x' class='avatar avatar-80 photo' height='80' width='80' loading='lazy'/></div>
	<div class="profile-content">
		<h4>About Jason Brownlee</h4>
		Jason Brownlee, PhD is a machine learning specialist who teaches developers how to get results with modern machine learning methods via hands-on tutorials.				<div class="profile-link">
			<a href="https://machinelearningmastery.com/author/jasonb/">
				View all posts by Jason Brownlee <span class="meta-nav">&rarr;</span>			</a>
		</div><!--#profile-link-->
			</div>
	<div class="fix"></div>
</aside>
<div class="post-utility"></div>
</article><!-- /.post -->
	        <div class="post-entries">
	            <div class="nav-prev fl"><a href="https://machinelearningmastery.com/how-to-visualize-filters-and-feature-maps-in-convolutional-neural-networks/" rel="prev"><i class="fa fa-angle-left"></i> How to Visualize Filters and Feature Maps in Convolutional Neural Networks</a></div>
	            <div class="nav-next fr"><a href="https://machinelearningmastery.com/how-to-develop-a-cnn-from-scratch-for-fashion-mnist-clothing-classification/" rel="next">Deep Learning CNN for Fashion-MNIST Clothing Classification <i class="fa fa-angle-right"></i></a></div>
	            <div class="fix"></div>
	        </div>

		<div id="comments">		 	<h3 id="comments-title">148 Responses to <em>How to Develop a CNN for MNIST Handwritten Digit Classification</em></h3>
		 	<ol class="commentlist">
				
		<li id="comment-484707" class="comment even thread-even depth-1">

	      	<div id="li-comment-484707" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/0071516956534589332ae54468ccda5b?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/0071516956534589332ae54468ccda5b?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">SHAHEEN ALHIRMIZY</span>
	                <span class="date">May 10, 2019 at 4:32 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-484707" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dear Jason Thank You Very Much For your wonderful Tutorial Please can you build for us A model  for Edge detection from scratch using real images.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-484707' data-commentid="484707" data-postid="7553" data-belowelement="comment-484707" data-respondelement="respond" data-replyto="Reply to SHAHEEN ALHIRMIZY" aria-label='Reply to SHAHEEN ALHIRMIZY'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-484803" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-484803" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">May 11, 2019 at 6:05 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-484803" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great suggestion, thanks.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-484803' data-commentid="484803" data-postid="7553" data-belowelement="comment-484803" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-484709" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-484709" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/0071516956534589332ae54468ccda5b?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/0071516956534589332ae54468ccda5b?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">SHAHEEN ALHIRMIZY</span>
	                <span class="date">May 10, 2019 at 4:47 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-484709" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have two questions :</p>
<p>first suppose I have images sizes equal to 7611 x  7811 how to deal with this big size images in CNN models.</p>
<p>second question about if our images different sizes not same size.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-484709' data-commentid="484709" data-postid="7553" data-belowelement="comment-484709" data-respondelement="respond" data-replyto="Reply to SHAHEEN ALHIRMIZY" aria-label='Reply to SHAHEEN ALHIRMIZY'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-484804" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-484804" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">May 11, 2019 at 6:06 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-484804" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I recommend reducing the size of your images first, before modeling, e.g. less than 1000 pixels, even less than 500 pixels if you can.</p>
<p>I then recommend normalizing images to the same size.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-484804' data-commentid="484804" data-postid="7553" data-belowelement="comment-484804" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-503450" class="comment even depth-3">

	      	<div id="li-comment-503450" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/372eab615515c1df9525bd59c00f8145?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/372eab615515c1df9525bd59c00f8145?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">vinay</span>
	                <span class="date">September 30, 2019 at 11:47 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-503450" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>to reduce the size of the images, which approach is better. Using machine learning or normal image compression methods.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-503450' data-commentid="503450" data-postid="7553" data-belowelement="comment-503450" data-respondelement="respond" data-replyto="Reply to vinay" aria-label='Reply to vinay'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-503465" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-503465" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">September 30, 2019 at 2:26 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-503465" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Use image compression algorithms.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-503465' data-commentid="503465" data-postid="7553" data-belowelement="comment-503465" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-484882" class="comment even thread-even depth-1">

	      	<div id="li-comment-484882" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/0071516956534589332ae54468ccda5b?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/0071516956534589332ae54468ccda5b?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">SHAHEEN ALHIRMIZY</span>
	                <span class="date">May 11, 2019 at 4:13 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-484882" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>when we reducing the size of images that means losing many fine details from these images</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-484882' data-commentid="484882" data-postid="7553" data-belowelement="comment-484882" data-respondelement="respond" data-replyto="Reply to SHAHEEN ALHIRMIZY" aria-label='Reply to SHAHEEN ALHIRMIZY'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-484967" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-484967" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">May 12, 2019 at 6:38 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-484967" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Often it does.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-484967' data-commentid="484967" data-postid="7553" data-belowelement="comment-484967" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-505377" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-505377" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/be8d376e806494d59af1c5d9a168b3db?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/be8d376e806494d59af1c5d9a168b3db?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Taranpreetkaur</span>
	                <span class="date">October 12, 2019 at 10:57 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-505377" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>How u make this project please help us &#8230; We can&#8217;t understand how we make this project &#8230; Taranpreetkaur</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-505377' data-commentid="505377" data-postid="7553" data-belowelement="comment-505377" data-respondelement="respond" data-replyto="Reply to Taranpreetkaur" aria-label='Reply to Taranpreetkaur'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-505449" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-505449" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">October 13, 2019 at 8:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-505449" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>What problem are you having exactly?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-505449' data-commentid="505449" data-postid="7553" data-belowelement="comment-505449" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-506362" class="comment even thread-even depth-1">

	      	<div id="li-comment-506362" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/c951a207024245b7cf339c94fbc707ff?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/c951a207024245b7cf339c94fbc707ff?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ajoy</span>
	                <span class="date">October 20, 2019 at 4:08 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-506362" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Original error was: No module named _multiarray_umath, keras .imageprocessing<br />
Importing the numpy c-extensions failed.</p>
<p>Any ideas please</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-506362' data-commentid="506362" data-postid="7553" data-belowelement="comment-506362" data-respondelement="respond" data-replyto="Reply to Ajoy" aria-label='Reply to Ajoy'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-506395" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-506395" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">October 20, 2019 at 6:23 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-506395" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry to hear that.</p>
<p>Perhaps try checking that your version of Keras and TensorFlow are up to date?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-506395' data-commentid="506395" data-postid="7553" data-belowelement="comment-506395" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-506470" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-506470" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/c951a207024245b7cf339c94fbc707ff?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/c951a207024245b7cf339c94fbc707ff?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ajoy</span>
	                <span class="date">October 20, 2019 at 7:18 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-506470" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry dont worry, I somehow got to resolve it. I think I reinstalled stuff.<br />
I have another problem though. How do I add data for learning if in case the data predicted the wrong valiue pelase. I think I need the advise for both how to add as well as how to add the data in the mnist data format. Thanks</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-506470' data-commentid="506470" data-postid="7553" data-belowelement="comment-506470" data-respondelement="respond" data-replyto="Reply to Ajoy" aria-label='Reply to Ajoy'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-506571" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-506571" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">October 21, 2019 at 6:17 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-506571" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Happy to hear that.</p>
<p>Perhaps you can refit your model as you get access to new data?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-506571' data-commentid="506571" data-postid="7553" data-belowelement="comment-506571" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-506475" class="comment even thread-even depth-1">

	      	<div id="li-comment-506475" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/c951a207024245b7cf339c94fbc707ff?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/c951a207024245b7cf339c94fbc707ff?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ajoy</span>
	                <span class="date">October 20, 2019 at 7:51 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-506475" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Jason you know what, for &#8220;17&#8221; it returned &#8220;7&#8221;. Thats actually good, but if you could please tip me as to how can I turn this into &#8220;Awesome.&#8221; Can I divide the pixel data into 2 dividions based on whitespace or what would be the best way please to recognize &#8220;17&#8221;. Thanks</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-506475' data-commentid="506475" data-postid="7553" data-belowelement="comment-506475" data-respondelement="respond" data-replyto="Reply to Ajoy" aria-label='Reply to Ajoy'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-506572" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-506572" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">October 21, 2019 at 6:17 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-506572" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I believe the model supports one character at a time, try splitting multiple characters up into single character input.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-506572' data-commentid="506572" data-postid="7553" data-belowelement="comment-506572" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-512501" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-512501" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/c281bcf53ab9cc1a91f981d5a023977f?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/c281bcf53ab9cc1a91f981d5a023977f?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jubayed</span>
	                <span class="date">November 26, 2019 at 10:13 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-512501" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great!! I enjoyed very well.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-512501' data-commentid="512501" data-postid="7553" data-belowelement="comment-512501" data-respondelement="respond" data-replyto="Reply to Jubayed" aria-label='Reply to Jubayed'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-512558" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-512558" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">November 27, 2019 at 6:05 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-512558" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks!</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-512558' data-commentid="512558" data-postid="7553" data-belowelement="comment-512558" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-512535" class="comment even thread-even depth-1">

	      	<div id="li-comment-512535" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/26a8e3863200dc27114cc140379a893a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/26a8e3863200dc27114cc140379a893a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Victor Johns</span>
	                <span class="date">November 27, 2019 at 3:43 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-512535" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Jason,<br />
Thanks much for this tutorial. I had a question on the structure of the CNN. In this (and other descriptions of this problem for the MNIST digit data set) a common structure seems to be that the number of CNN filters is 32. Where each filter is a 5&#215;5 of stride 1. However (and I apologize if this is explained somewhere) I cannot seem to find why 32 filters are chosen. i.e. Why not 16 or 64 ( or 14 or 28). Is it possible to explain why this is so. </p>
<p>Regards<br />
Victor</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-512535' data-commentid="512535" data-postid="7553" data-belowelement="comment-512535" data-respondelement="respond" data-replyto="Reply to Victor Johns" aria-label='Reply to Victor Johns'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-512571" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-512571" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">November 27, 2019 at 6:13 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-512571" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It is arbitrary.</p>
<p>Try different numbers of filters and compare the results.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-512571' data-commentid="512571" data-postid="7553" data-belowelement="comment-512571" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-514552" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-514552" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/1612ee654b5956e3a4fd9490c79bce5d?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/1612ee654b5956e3a4fd9490c79bce5d?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Samuel</span>
	                <span class="date">December 11, 2019 at 8:36 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-514552" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Jason,<br />
Thank you for the detailed explanation of this. I wanted to run your code and follow along to see how it worked. When I tried to run the complete example for the baseline cnn model for mnist, I get the following error:</p>
<p>KeyError                                  Traceback (most recent call last)<br />
 in<br />
    107<br />
    108 # entry point, run the test harness<br />
&#8211;&gt; 109 run_test_harness()</p>
<p> in run_test_harness()<br />
    102         scores, histories = evaluate_model(model, trainX, trainY)<br />
    103         # learning curves<br />
&#8211;&gt; 104         summarize_diagnostics(histories)<br />
    105         # summarize estimated performance<br />
    106         summarize_performance(scores)</p>
<p> in summarize_diagnostics(histories)<br />
     79                 pyplot.subplot(212)<br />
     80                 pyplot.title(&#8216;Classification Accuracy&#8217;)<br />
&#8212;&gt; 81                 pyplot.plot(histories[i].history[&#8216;acc&#8217;], color=&#8217;blue&#8217;, label=&#8217;train&#8217;)<br />
     82                 pyplot.plot(histories[i].history[&#8216;val_acc&#8217;], color=&#8217;orange&#8217;, label=&#8217;test&#8217;)<br />
     83         pyplot.show()</p>
<p>KeyError: &#8216;acc&#8217;</p>
<p>Any ideas what it means?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-514552' data-commentid="514552" data-postid="7553" data-belowelement="comment-514552" data-respondelement="respond" data-replyto="Reply to Samuel" aria-label='Reply to Samuel'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-514569" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-514569" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">December 11, 2019 at 1:41 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-514569" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, the API has changed. </p>
<p>I have updated the example. </p>
<p>Thanks for letting me know!</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-514569' data-commentid="514569" data-postid="7553" data-belowelement="comment-514569" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-514639" class="comment even thread-even depth-1">

	      	<div id="li-comment-514639" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/bc0fbfc72974e2f341729c3f5782d5eb?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/bc0fbfc72974e2f341729c3f5782d5eb?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Xenon</span>
	                <span class="date">December 12, 2019 at 5:16 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-514639" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>please how can i Train a simple convolutional network for number recognition (MNIST). Thanks. that&#8217;s what i want to see.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-514639' data-commentid="514639" data-postid="7553" data-belowelement="comment-514639" data-respondelement="respond" data-replyto="Reply to Xenon" aria-label='Reply to Xenon'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-514675" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-514675" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">December 12, 2019 at 6:33 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-514675" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>See the above tutorial for an example.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-514675' data-commentid="514675" data-postid="7553" data-belowelement="comment-514675" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-516125" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-516125" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/9dca8e8c06b7e01934271cc6cf37bb5c?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/9dca8e8c06b7e01934271cc6cf37bb5c?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Vivek</span>
	                <span class="date">December 23, 2019 at 10:30 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-516125" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I want to create a image exactly same as mnist using mspaint for example and test it using the mnist evaluation model using predict_classes API.</p>
<p>Is it possible without using python API.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-516125' data-commentid="516125" data-postid="7553" data-belowelement="comment-516125" data-respondelement="respond" data-replyto="Reply to Vivek" aria-label='Reply to Vivek'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-516165" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-516165" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">December 24, 2019 at 6:42 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-516165" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I don&#8217;t see why not.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-516165' data-commentid="516165" data-postid="7553" data-belowelement="comment-516165" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-516428" class="comment even thread-even depth-1">

	      	<div id="li-comment-516428" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/63ab119aed7f7fe39af6afdf7c0614d2?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/63ab119aed7f7fe39af6afdf7c0614d2?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Alexander Soare</span>
	                <span class="date">December 27, 2019 at 8:00 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-516428" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br />
Thanks for the excellent tutorial! I have two questions about K-fold cross-validation. In your &#8220;gentle introduction&#8221; article you say that the model is discarded each time we switch the hold out set. So here are my questions</p>
<p>1) Here it looks like you don&#8217;t discard the model between iterations of the k-fold cross validation. Why?</p>
<p>2) The model&#8217;s accuracy gets better each time you do an iteration. Why is taking a simple average fair then? To take it to the extreme: What if you only trained on 1 epoch? Then you&#8217;d get 94% on your first fold, then 98.5% on your second fold. And so on, yielding a much poorer average and a huge standard deviation. On the back of this question, I&#8217;d also ask why the standard deviation is a fair representation of the model under these circumstances.</p>
<p>Thanks again for the great material!<br />
Alex</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-516428' data-commentid="516428" data-postid="7553" data-belowelement="comment-516428" data-respondelement="respond" data-replyto="Reply to Alexander Soare" aria-label='Reply to Alexander Soare'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-516482" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-516482" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">December 28, 2019 at 7:38 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-516482" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You&#8217;re welcome.</p>
<p>That looks like an error. I will update the tutorial.</p>
<p>Thanks for point it out!</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-516482' data-commentid="516482" data-postid="7553" data-belowelement="comment-516482" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-516554" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-516554" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/63ab119aed7f7fe39af6afdf7c0614d2?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/63ab119aed7f7fe39af6afdf7c0614d2?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Alexander Soare</span>
	                <span class="date">December 29, 2019 at 5:43 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-516554" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for picking up my previous question Jason. I have another. You say at some point that there are no clear signs of overfitting. But it looks like the orange lines for the validation accuracy are staying relatively low compared to the blue lines for the testing accuracy. Is this not an indicator of overfitting? Or am I misinterpreting the charts?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-516554' data-commentid="516554" data-postid="7553" data-belowelement="comment-516554" data-respondelement="respond" data-replyto="Reply to Alexander Soare" aria-label='Reply to Alexander Soare'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-516571" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-516571" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">December 29, 2019 at 6:09 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-516571" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Excellent question Alexander.</p>
<p>They are close enough that I would not classify it as overfitting, instead it is a good fit:<br />
<a href="https://machinelearningmastery.com/learning-curves-for-diagnosing-machine-learning-model-performance/" rel="nofollow ugc">https://machinelearningmastery.com/learning-curves-for-diagnosing-machine-learning-model-performance/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-516571' data-commentid="516571" data-postid="7553" data-belowelement="comment-516571" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-516986" class="comment even thread-even depth-1">

	      	<div id="li-comment-516986" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/7f2d5a482bdc964c856cc00e72931a32?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/7f2d5a482bdc964c856cc00e72931a32?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Anja</span>
	                <span class="date">January 3, 2020 at 3:02 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-516986" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason,</p>
<p>When I execute the final code I get following error: &#8220;AttributeError: module &#8216;tensorflow&#8217; has no attribute &#8216;get_default_graph&#8221;. I have installed Tensorflow 2.0, will downgrading it to the previous version solve this problem?</p>
<p>Thank you for your time and this amazing post!</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-516986' data-commentid="516986" data-postid="7553" data-belowelement="comment-516986" data-respondelement="respond" data-replyto="Reply to Anja" aria-label='Reply to Anja'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-517043" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-517043" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">January 4, 2020 at 8:24 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-517043" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Confirm you have Keras 2.3 and Tensorflow 2.0 installed.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-517043' data-commentid="517043" data-postid="7553" data-belowelement="comment-517043" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-517227" class="comment even depth-3">

	      	<div id="li-comment-517227" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/7f2d5a482bdc964c856cc00e72931a32?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/7f2d5a482bdc964c856cc00e72931a32?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Anja</span>
	                <span class="date">January 6, 2020 at 12:51 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-517227" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason,</p>
<p>I have Tensorflow 2.0 and Keras 2.2.4. I tried updating Keras to 2.3 but can not find the way on Windows 10. I tried also switching to Linux on VB but I have a hard time with permissions there. Do you have any advice for me, I would be really grateful?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-517227' data-commentid="517227" data-postid="7553" data-belowelement="comment-517227" data-respondelement="respond" data-replyto="Reply to Anja" aria-label='Reply to Anja'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-517231" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-517231" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">January 6, 2020 at 1:31 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-517231" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can try:</p>
<p></p>
		<div id="urvanov-syntax-highlighter-619c550b9627e095755757" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
pip install keras</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b9627e095755757-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b9627e095755757-1"><span class="crayon-e">pip </span><span class="crayon-e">install </span><span class="crayon-v">keras</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p></p>
<p>Or, if you are on anaconda:</p>
<p></p>
		<div id="urvanov-syntax-highlighter-619c550b96280925417457" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
conda install -c conda-forge keras</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b96280925417457-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b96280925417457-1"><span class="crayon-e">conda </span><span class="crayon-v">install</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">c</span><span class="crayon-h"> </span><span class="crayon-v">conda</span><span class="crayon-o">-</span><span class="crayon-e">forge </span><span class="crayon-v">keras</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-517231' data-commentid="517231" data-postid="7553" data-belowelement="comment-517231" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-520248" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-520248" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/c76d6ab2e3a5bb790b29fdde3d1b649d?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/c76d6ab2e3a5bb790b29fdde3d1b649d?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Dmytro</span>
	                <span class="date">February 4, 2020 at 7:44 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-520248" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason,<br />
Thank you for the tutorial and all the answers!</p>
<p>I have my own set of images, each class in a separate folder. What should I do to upload the dataset instead of writing</p>
<p># load dataset<br />
(trainX, trainY), (testX, testY) = mnist.load_data()</p>
<p>It would be great if you can give some advice!</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-520248' data-commentid="520248" data-postid="7553" data-belowelement="comment-520248" data-respondelement="respond" data-replyto="Reply to Dmytro" aria-label='Reply to Dmytro'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-520271" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-520271" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">February 4, 2020 at 8:02 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-520271" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Here is an example:<br />
<a href="https://machinelearningmastery.com/how-to-load-large-datasets-from-directories-for-deep-learning-with-keras/" rel="nofollow ugc">https://machinelearningmastery.com/how-to-load-large-datasets-from-directories-for-deep-learning-with-keras/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-520271' data-commentid="520271" data-postid="7553" data-belowelement="comment-520271" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-520432" class="comment even thread-even depth-1">

	      	<div id="li-comment-520432" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/c76d6ab2e3a5bb790b29fdde3d1b649d?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/c76d6ab2e3a5bb790b29fdde3d1b649d?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Dmytro</span>
	                <span class="date">February 5, 2020 at 4:00 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-520432" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you!</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-520432' data-commentid="520432" data-postid="7553" data-belowelement="comment-520432" data-respondelement="respond" data-replyto="Reply to Dmytro" aria-label='Reply to Dmytro'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-520493" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-520493" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">February 6, 2020 at 8:18 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-520493" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You&#8217;re welcome.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-520493' data-commentid="520493" data-postid="7553" data-belowelement="comment-520493" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-525583" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-525583" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/6715bdb7babd6a2f475b56dc5df3235e?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/6715bdb7babd6a2f475b56dc5df3235e?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">SARVANI CH</span>
	                <span class="date">March 14, 2020 at 9:11 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-525583" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br />
Thanks for the article!!!<br />
Do you have any plans to implement &#8220;Information bottleneck theory&#8221; i.e, finding mainly the mutual information among various layers in an architecture?<br />
Does it seem simpler or a harder one for you??</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-525583' data-commentid="525583" data-postid="7553" data-belowelement="comment-525583" data-respondelement="respond" data-replyto="Reply to SARVANI CH" aria-label='Reply to SARVANI CH'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-525620" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-525620" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">March 15, 2020 at 6:13 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-525620" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have not heard of it sorry, do you have a link?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-525620' data-commentid="525620" data-postid="7553" data-belowelement="comment-525620" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-526177" class="comment even thread-even depth-1">

	      	<div id="li-comment-526177" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/6d43f284b90a7dd7391885912285b6a6?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/6d43f284b90a7dd7391885912285b6a6?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">SWETHA</span>
	                <span class="date">March 20, 2020 at 1:05 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-526177" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>def load_image(filename):<br />
	# load the image<br />
	img = load_img(filename, grayscale=True, target_size=(28, 28))<br />
	# convert to array<br />
	img = img_to_array(img)<br />
	# reshape into a single sample with 1 channel<br />
	img = img.reshape(1, 28, 28, 1)<br />
	# prepare pixel data<br />
	img = img.astype(&#8216;float32&#8217;)<br />
	img = img / 255.0<br />
	return img</p>
<p>what does the &#8216;filename&#8217; mean in the above code?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-526177' data-commentid="526177" data-postid="7553" data-belowelement="comment-526177" data-respondelement="respond" data-replyto="Reply to SWETHA" aria-label='Reply to SWETHA'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-526187" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-526187" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">March 20, 2020 at 1:20 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-526187" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It&#8217;s an argument to the function &#8211; the name of the file you want to load.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-526187' data-commentid="526187" data-postid="7553" data-belowelement="comment-526187" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-526196" class="comment even depth-3">

	      	<div id="li-comment-526196" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/6d43f284b90a7dd7391885912285b6a6?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/6d43f284b90a7dd7391885912285b6a6?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">SWETHA</span>
	                <span class="date">March 20, 2020 at 2:17 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-526196" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Did you mean the saved model&#8217;s filename?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-526196' data-commentid="526196" data-postid="7553" data-belowelement="comment-526196" data-respondelement="respond" data-replyto="Reply to SWETHA" aria-label='Reply to SWETHA'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-526276" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-526276" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">March 21, 2020 at 8:17 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-526276" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>No, the function loads an image as it&#8217;s name suggests.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-526276' data-commentid="526276" data-postid="7553" data-belowelement="comment-526276" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-526191" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-526191" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/6d43f284b90a7dd7391885912285b6a6?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/6d43f284b90a7dd7391885912285b6a6?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">SWETHA</span>
	                <span class="date">March 20, 2020 at 1:48 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-526191" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you!</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-526191' data-commentid="526191" data-postid="7553" data-belowelement="comment-526191" data-respondelement="respond" data-replyto="Reply to SWETHA" aria-label='Reply to SWETHA'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-526272" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-526272" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">March 21, 2020 at 8:16 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-526272" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You&#8217;re welcome.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-526272' data-commentid="526272" data-postid="7553" data-belowelement="comment-526272" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-526913" class="comment even thread-even depth-1">

	      	<div id="li-comment-526913" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/ce69d3c4dbdbe06f227a0883d28af0cc?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/ce69d3c4dbdbe06f227a0883d28af0cc?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Elbhednam</span>
	                <span class="date">March 26, 2020 at 6:52 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-526913" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>What is the purpose of reshaping the data to a single color channel? Is it necessary for the 2D convolution step in the model definition? I ask because other digit classification examples I&#8217;ve looked at go straight to flattening the train/test data but those didn&#8217;t have a 2D convolution layer.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-526913' data-commentid="526913" data-postid="7553" data-belowelement="comment-526913" data-respondelement="respond" data-replyto="Reply to Elbhednam" aria-label='Reply to Elbhednam'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-526944" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-526944" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">March 26, 2020 at 8:07 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-526944" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The CNN layer expects data to have a 3d shape including a channels dimension:<br />
<a href="https://machinelearningmastery.com/convolutional-layers-for-deep-learning-neural-networks/" rel="nofollow ugc">https://machinelearningmastery.com/convolutional-layers-for-deep-learning-neural-networks/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-526944' data-commentid="526944" data-postid="7553" data-belowelement="comment-526944" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-529516" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-529516" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/eabb7001452cd85d0e191fb1b7792440?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/eabb7001452cd85d0e191fb1b7792440?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://www.taterkins.com/' rel='external nofollow ugc' class='url'>Edward</a></span>
	                <span class="date">April 13, 2020 at 5:00 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-529516" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>If one wanted to create a new MNIST how would they set the data up? In these examples we get to use curated datasets from a dispensary but that does not explain how to set up your data to run the model.<br />
For example what if I wanted to create my own MNIST to determine if the picture is a poker card, how would I go about setting the pictures and telling the machine what that picture is?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-529516' data-commentid="529516" data-postid="7553" data-belowelement="comment-529516" data-respondelement="respond" data-replyto="Reply to Edward" aria-label='Reply to Edward'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-529541" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-529541" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">April 13, 2020 at 6:22 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-529541" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Good question, see this:<br />
<a href="https://machinelearningmastery.com/how-to-load-large-datasets-from-directories-for-deep-learning-with-keras/" rel="nofollow ugc">https://machinelearningmastery.com/how-to-load-large-datasets-from-directories-for-deep-learning-with-keras/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-529541' data-commentid="529541" data-postid="7553" data-belowelement="comment-529541" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-529826" class="comment even thread-even depth-1">

	      	<div id="li-comment-529826" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/9feda0db5fa9d5e1a544641d24b728fa?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/9feda0db5fa9d5e1a544641d24b728fa?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Amit Baghel</span>
	                <span class="date">April 15, 2020 at 3:53 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-529826" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>hi Jason Brownlee,<br />
  i want to make model handwriting alphbet  so please suggest which dataset is good</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-529826' data-commentid="529826" data-postid="7553" data-belowelement="comment-529826" data-respondelement="respond" data-replyto="Reply to Amit Baghel" aria-label='Reply to Amit Baghel'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-529903" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-529903" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">April 16, 2020 at 5:57 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-529903" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps this will help:<br />
<a href="https://machinelearningmastery.com/faq/single-faq/where-can-i-get-a-dataset-on-___" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/where-can-i-get-a-dataset-on-___</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-529903' data-commentid="529903" data-postid="7553" data-belowelement="comment-529903" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-530170" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-530170" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/c44cf0d8752d789cdcc692d1d5d841a0?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/c44cf0d8752d789cdcc692d1d5d841a0?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Nawal</span>
	                <span class="date">April 17, 2020 at 6:03 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-530170" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Jason, Thank you so much for sharing your knowledge. I just started learning python, tensorflow and machine learning. I understood all the maths and processes but was having difficulty in coding. Your example worked first time. Brilliant.<br />
Do you have a simpler example of CNN with just 4 hidden layers as follows:<br />
1. Input layer of 784 nodes<br />
2. First convolution later : 5x5x32<br />
3. First max pooling layer<br />
4. Second convolution layer 5x5x64<br />
5. Second max pooling layer<br />
6. Out put layer of 10 nodes</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-530170' data-commentid="530170" data-postid="7553" data-belowelement="comment-530170" data-respondelement="respond" data-replyto="Reply to Nawal" aria-label='Reply to Nawal'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-530259" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-530259" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">April 18, 2020 at 5:42 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-530259" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks.</p>
<p>You can adapt the above example to this directly if you like.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-530259' data-commentid="530259" data-postid="7553" data-belowelement="comment-530259" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-533129" class="comment even thread-even depth-1">

	      	<div id="li-comment-533129" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/6b306b17e9277501eabbe057246b1975?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/6b306b17e9277501eabbe057246b1975?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Joyce</span>
	                <span class="date">May 4, 2020 at 6:03 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-533129" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason. Can I ask why did you reshape the data? The image from the MNIST are already grey scale which are 1 channel. I am not quite understand why you need to do this step. Also what does the trainx.shape[0]/testX.shape[0] do here?</p>
<p># reshape dataset to have a single channel<br />
trainX = trainX.reshape((trainX.shape[0], 28, 28, 1))<br />
testX = testX.reshape((testX.shape[0], 28, 28, 1))</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-533129' data-commentid="533129" data-postid="7553" data-belowelement="comment-533129" data-respondelement="respond" data-replyto="Reply to Joyce" aria-label='Reply to Joyce'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-533146" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-533146" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">May 4, 2020 at 6:28 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-533146" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Inputs to CNNs must have the channel defined explicitly, which is not the case by default for grayscale images.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-533146' data-commentid="533146" data-postid="7553" data-belowelement="comment-533146" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-533147" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-533147" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/f0cd4a4d2bfa133bef5dbc58bd42b942?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/f0cd4a4d2bfa133bef5dbc58bd42b942?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Amy</span>
	                <span class="date">May 4, 2020 at 6:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-533147" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Can I ask why the hot encode is 10 binary vectors? Why choose 10?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-533147' data-commentid="533147" data-postid="7553" data-belowelement="comment-533147" data-respondelement="respond" data-replyto="Reply to Amy" aria-label='Reply to Amy'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-533148" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-533148" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">May 4, 2020 at 6:33 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-533148" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Because there are 10 classes.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-533148' data-commentid="533148" data-postid="7553" data-belowelement="comment-533148" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-533713" class="comment even thread-even depth-1">

	      	<div id="li-comment-533713" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/be05db28b5e6ffb436b41381d466432e?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/be05db28b5e6ffb436b41381d466432e?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ruslaniv</span>
	                <span class="date">May 7, 2020 at 9:20 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-533713" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason! Thank you so much, this is a great tutorial!<br />
Just one question, i&#8217;m somewhat confused.<br />
Are training our model twice? Once with k-fold validation and then right before saving it, with model.fit?<br />
====<br />
model = define_model()<br />
model.fit(trainX, trainY, epochs=10, batch_size=32, verbose=0)<br />
model.save(&#8216;final_model.h5&#8217;)<br />
====</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-533713' data-commentid="533713" data-postid="7553" data-belowelement="comment-533713" data-respondelement="respond" data-replyto="Reply to Ruslaniv" aria-label='Reply to Ruslaniv'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-533783" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-533783" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">May 8, 2020 at 6:31 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-533783" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Cross-validation will train k models and is used to estimate the performance when making predictions on new data. These models are discarded.</p>
<p>Once we choose a final model config, we fit a model on all data and use it to start making predictions.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-533783' data-commentid="533783" data-postid="7553" data-belowelement="comment-533783" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-534290" class="comment even depth-3">

	      	<div id="li-comment-534290" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/be05db28b5e6ffb436b41381d466432e?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/be05db28b5e6ffb436b41381d466432e?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ruslaniv</span>
	                <span class="date">May 11, 2020 at 8:20 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-534290" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great, that&#8217;s what I thought! Thank you again for this amazing tutorial.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-534290' data-commentid="534290" data-postid="7553" data-belowelement="comment-534290" data-respondelement="respond" data-replyto="Reply to Ruslaniv" aria-label='Reply to Ruslaniv'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-534353" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-534353" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">May 12, 2020 at 6:43 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-534353" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You&#8217;re welcome.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-534353' data-commentid="534353" data-postid="7553" data-belowelement="comment-534353" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-596292" class="comment even depth-3">

	      	<div id="li-comment-596292" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/8ebbec17af6b9bb1ba6af83fdab05829?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/8ebbec17af6b9bb1ba6af83fdab05829?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Thenerd</span>
	                <span class="date">February 5, 2021 at 3:05 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-596292" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>In the k fold cross validation a new model is defined for each k iteration. So does that mean a new model is trained each time? But then what is the use of training new models in each iteration? </p>
<p>By model config you mean an optimal define_model? And once an optimal model is fixed we train on the entire training set? I am not able to relate how will K iterations in the K-fold reflect our understanding of what model  configuration is the best.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-596292' data-commentid="596292" data-postid="7553" data-belowelement="comment-596292" data-respondelement="respond" data-replyto="Reply to Thenerd" aria-label='Reply to Thenerd'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-596326" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-596326" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">February 5, 2021 at 5:46 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-596326" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, a new model is trained each iteration, evaluated, and discarded.</p>
<p>The purpose is to estimate the performance of the model configuration when making predictions on unseen data for your prediction problem.</p>
<p>Once we have this estimate, we can choose to use the configuration (compared to other configurations). A final model can be fit on all data and we can start making predictions for real on new data where we don&#8217;t know the label.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-596326' data-commentid="596326" data-postid="7553" data-belowelement="comment-596326" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-596919" class="comment even depth-5">

	      	<div id="li-comment-596919" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/8ebbec17af6b9bb1ba6af83fdab05829?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/8ebbec17af6b9bb1ba6af83fdab05829?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Thenerd</span>
	                <span class="date">February 10, 2021 at 7:21 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-596919" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thankyou very much. I had another question. I was trying to run the final model on the unseen test data. however for each run the results vary ofcourse. therefore i decided to run this over 10 runs and average the test results, something like monte carlo simulation. but again in that case where would model = define_model() be places? would that be placed inside the for loop for average or just be defined once before running these 10 iterations, considering this average results is on the test data. since in kfold you discard it.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-596938" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-596938" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">February 10, 2021 at 8:13 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-596938" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You&#8217;re welcome.</p>
<p>Yes, you can reduce variance in prediction by fitting multiple final models and averaging their predictions:<br />
<a href="https://machinelearningmastery.com/how-to-reduce-model-variance/" rel="nofollow ugc">https://machinelearningmastery.com/how-to-reduce-model-variance/</a></p>
<p>This has a code example:<br />
<a href="https://machinelearningmastery.com/model-averaging-ensemble-for-deep-learning-neural-networks/" rel="nofollow ugc">https://machinelearningmastery.com/model-averaging-ensemble-for-deep-learning-neural-networks/</a></p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-534281" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-534281" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/c55fee81e8874ed5ec2b85fdb935c0c4?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/c55fee81e8874ed5ec2b85fdb935c0c4?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Gohel vivek</span>
	                <span class="date">May 11, 2020 at 6:02 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-534281" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>If i am writing this all by making a class name -mnist_classification then </p>
<p>AttributeError: &#8216;mnist_classification&#8217; object has no attribute &#8216;astype&#8217;</p>
<p>this .astype error is coming please sir can you help me to figure this out</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-534281' data-commentid="534281" data-postid="7553" data-belowelement="comment-534281" data-respondelement="respond" data-replyto="Reply to Gohel vivek" aria-label='Reply to Gohel vivek'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-534345" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-534345" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">May 12, 2020 at 6:40 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-534345" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry to hear that, this will help:<br />
<a href="https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-534345' data-commentid="534345" data-postid="7553" data-belowelement="comment-534345" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-537674" class="comment even thread-even depth-1">

	      	<div id="li-comment-537674" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/c7f61e9836c19abebf6954fdff165e09?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/c7f61e9836c19abebf6954fdff165e09?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ramya</span>
	                <span class="date">June 2, 2020 at 7:01 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-537674" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thanks for this tutorial. It&#8217;s very helpful.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-537674' data-commentid="537674" data-postid="7553" data-belowelement="comment-537674" data-respondelement="respond" data-replyto="Reply to Ramya" aria-label='Reply to Ramya'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-537681" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-537681" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">June 2, 2020 at 7:55 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-537681" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You&#8217;re welcome, I&#8217;m happy to hear that.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-537681' data-commentid="537681" data-postid="7553" data-belowelement="comment-537681" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-540430" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-540430" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/62991253d3074a9a8752aa47e18da8e9?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/62991253d3074a9a8752aa47e18da8e9?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Milind Naidu</span>
	                <span class="date">June 21, 2020 at 11:28 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-540430" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, i am trying to build a CNN fo the same problem. My output layer has 10 neurons. When i try to fit my model after One-Hot_encoding of y_train and y_test, i get an error that the labels and the logits don&#8217;t match.   However, without the one-hot encoding the model fits perfectly. Can you please explain?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-540430' data-commentid="540430" data-postid="7553" data-belowelement="comment-540430" data-respondelement="respond" data-replyto="Reply to Milind Naidu" aria-label='Reply to Milind Naidu'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-540468" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-540468" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">June 22, 2020 at 6:14 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-540468" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps you can use the above tutorial as a starting point and adapt it for your project?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-540468' data-commentid="540468" data-postid="7553" data-belowelement="comment-540468" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-545053" class="comment even thread-even depth-1">

	      	<div id="li-comment-545053" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/6d827388d966b693ac5adb84ff9b6c8b?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/6d827388d966b693ac5adb84ff9b6c8b?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">William</span>
	                <span class="date">July 19, 2020 at 8:48 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-545053" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This is the best article about MNIST, but I have a question &#8220;Is it necessary to use a GPU with high performance in order to running these codes?&#8221;</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-545053' data-commentid="545053" data-postid="7553" data-belowelement="comment-545053" data-respondelement="respond" data-replyto="Reply to William" aria-label='Reply to William'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-545099" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-545099" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">July 20, 2020 at 6:12 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-545099" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks!</p>
<p>No, you can run on CPU, it might just take more minutes to run.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-545099' data-commentid="545099" data-postid="7553" data-belowelement="comment-545099" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-546665" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-546665" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/d9cd0876ef619d530b24ebabbf7631b0?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/d9cd0876ef619d530b24ebabbf7631b0?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sandhya</span>
	                <span class="date">July 31, 2020 at 3:58 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-546665" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason<br />
 Thanks for this amazing tutorial. It will definitely help a lot of budding researchers.<br />
I have a question<br />
Can you please help if instead of single character i have to work on complete self taken handwritten word image (20 different classes,total around 20000 images).  How to do it?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-546665' data-commentid="546665" data-postid="7553" data-belowelement="comment-546665" data-respondelement="respond" data-replyto="Reply to Sandhya" aria-label='Reply to Sandhya'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-546722" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-546722" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">August 1, 2020 at 6:07 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-546722" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps the letters in each word images can first be segmented, then classified.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-546722' data-commentid="546722" data-postid="7553" data-belowelement="comment-546722" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-546822" class="comment even depth-3">

	      	<div id="li-comment-546822" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/d9cd0876ef619d530b24ebabbf7631b0?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/d9cd0876ef619d530b24ebabbf7631b0?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sandhya</span>
	                <span class="date">August 1, 2020 at 5:39 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-546822" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>thanks for the reply but i want to do it using segmentation free approach</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-546822' data-commentid="546822" data-postid="7553" data-belowelement="comment-546822" data-respondelement="respond" data-replyto="Reply to Sandhya" aria-label='Reply to Sandhya'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-546940" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-546940" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">August 2, 2020 at 5:39 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-546940" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps use a CNN to read the images and an LSTM to interpret the image features and output one letter at a time.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-546940' data-commentid="546940" data-postid="7553" data-belowelement="comment-546940" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-546666" class="comment even thread-even depth-1">

	      	<div id="li-comment-546666" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/d9cd0876ef619d530b24ebabbf7631b0?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/d9cd0876ef619d530b24ebabbf7631b0?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sandhya</span>
	                <span class="date">July 31, 2020 at 4:14 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-546666" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>hi Jason<br />
Thanks for this amazing tutorial.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-546666' data-commentid="546666" data-postid="7553" data-belowelement="comment-546666" data-respondelement="respond" data-replyto="Reply to Sandhya" aria-label='Reply to Sandhya'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-546723" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-546723" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">August 1, 2020 at 6:07 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-546723" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You&#8217;re welcome.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-546723' data-commentid="546723" data-postid="7553" data-belowelement="comment-546723" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-568433" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-568433" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/f678b276e54b80bf7135c64fa9b9064c?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/f678b276e54b80bf7135c64fa9b9064c?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://no' rel='external nofollow ugc' class='url'>zulfiqar ali</a></span>
	                <span class="date">October 18, 2020 at 9:46 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-568433" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks, Jason Brownlee for this excellent tutorial. I am your huge fan and I regularly following your all machine learning and deep earning models.I got a lot of knowledge from this site but After completion of machine learning tutorials there always raise a question in my mind that how can we apply these models in Mobile APPs(Andriod, iOS, etc) so that we get more fun and knowledge by this models. Are you suggest to me any link to have such kind of projects such as weather prediction app . Thanks again.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-568433' data-commentid="568433" data-postid="7553" data-belowelement="comment-568433" data-respondelement="respond" data-replyto="Reply to zulfiqar ali" aria-label='Reply to zulfiqar ali'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-568481" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-568481" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">October 18, 2020 at 1:25 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-568481" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks.</p>
<p>Sorry, I don&#8217;t know about using models on mobile.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-568481' data-commentid="568481" data-postid="7553" data-belowelement="comment-568481" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-570102" class="comment even thread-even depth-1">

	      	<div id="li-comment-570102" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/24d1e1ede9e3297563e609bd68ac0a87?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/24d1e1ede9e3297563e609bd68ac0a87?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Zunaira Shafqat</span>
	                <span class="date">October 23, 2020 at 4:49 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-570102" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for the tutorial Jason Brownlee.<br />
Can I use same model but pass my own dataset (of humans) to it &amp; use it for detecting fall or not fall by making small changes?<br />
Thanks.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-570102' data-commentid="570102" data-postid="7553" data-belowelement="comment-570102" data-respondelement="respond" data-replyto="Reply to Zunaira Shafqat" aria-label='Reply to Zunaira Shafqat'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-570128" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-570128" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">October 23, 2020 at 6:17 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-570128" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sure.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-570128' data-commentid="570128" data-postid="7553" data-belowelement="comment-570128" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-574728" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-574728" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/ad0352842ce339b73b89bb759c9ca422?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/ad0352842ce339b73b89bb759c9ca422?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Preethi</span>
	                <span class="date">November 12, 2020 at 3:28 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-574728" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi do you have any projects done based on Wireless and Mobile Network except human activity recognition using smart phone</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-574728' data-commentid="574728" data-postid="7553" data-belowelement="comment-574728" data-respondelement="respond" data-replyto="Reply to Preethi" aria-label='Reply to Preethi'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-574875" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-574875" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">November 13, 2020 at 6:32 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-574875" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I don&#8217;t think so. Perhaps try the blog search.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-574875' data-commentid="574875" data-postid="7553" data-belowelement="comment-574875" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-575017" class="comment even thread-even depth-1">

	      	<div id="li-comment-575017" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/86d53fd436d96120f4cb360db45ed54d?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/86d53fd436d96120f4cb360db45ed54d?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Archna</span>
	                <span class="date">November 13, 2020 at 7:01 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-575017" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for the detailed explanation !!<br />
Can you pls do a tutorial on colorization without using pretratined model</p>
<p>Thanks in advance</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-575017' data-commentid="575017" data-postid="7553" data-belowelement="comment-575017" data-respondelement="respond" data-replyto="Reply to Archna" aria-label='Reply to Archna'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-575118" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-575118" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">November 14, 2020 at 6:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-575118" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great suggestion, thanks!</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-575118' data-commentid="575118" data-postid="7553" data-belowelement="comment-575118" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-578189" class="comment even depth-3">

	      	<div id="li-comment-578189" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/86d53fd436d96120f4cb360db45ed54d?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/86d53fd436d96120f4cb360db45ed54d?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Archna</span>
	                <span class="date">November 24, 2020 at 6:31 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-578189" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Waiting for the same 🙂</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-578189' data-commentid="578189" data-postid="7553" data-belowelement="comment-578189" data-respondelement="respond" data-replyto="Reply to Archna" aria-label='Reply to Archna'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-581421" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-581421" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/0a6713efb5b878c64e3586f0bfc04c83?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/0a6713efb5b878c64e3586f0bfc04c83?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ebdulmomen</span>
	                <span class="date">December 7, 2020 at 8:53 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-581421" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>hey jason that was a very good tutorial, i did not understand how in the predict_classes we got 7? the model had a softmax activation function as the last layer which will be a probability distribution of 10 float numbers, what i can&#8217;t grasp is how did we get back 7?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-581421' data-commentid="581421" data-postid="7553" data-belowelement="comment-581421" data-respondelement="respond" data-replyto="Reply to Ebdulmomen" aria-label='Reply to Ebdulmomen'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-581422" class="comment even depth-2">

	      	<div id="li-comment-581422" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/0a6713efb5b878c64e3586f0bfc04c83?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/0a6713efb5b878c64e3586f0bfc04c83?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ebdulmomen</span>
	                <span class="date">December 7, 2020 at 8:57 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-581422" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>what i mean is how this 10 probabilities turned into 1 predicted number?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-581422' data-commentid="581422" data-postid="7553" data-belowelement="comment-581422" data-respondelement="respond" data-replyto="Reply to Ebdulmomen" aria-label='Reply to Ebdulmomen'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-581423" class="comment odd alt depth-3">

	      	<div id="li-comment-581423" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/0a6713efb5b878c64e3586f0bfc04c83?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/0a6713efb5b878c64e3586f0bfc04c83?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ebdulmomen</span>
	                <span class="date">December 7, 2020 at 9:09 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-581423" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>and how does it know it is 7, didn&#8217;t we hot encode the Y values?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-581423' data-commentid="581423" data-postid="7553" data-belowelement="comment-581423" data-respondelement="respond" data-replyto="Reply to Ebdulmomen" aria-label='Reply to Ebdulmomen'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-581447" class="comment byuser comment-author-jasonb bypostauthor even depth-3">

	      	<div id="li-comment-581447" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">December 7, 2020 at 1:35 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-581447" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Via argmax:<br />
<a href="https://machinelearningmastery.com/argmax-in-machine-learning/" rel="nofollow ugc">https://machinelearningmastery.com/argmax-in-machine-learning/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-581447' data-commentid="581447" data-postid="7553" data-belowelement="comment-581447" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-581446" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-581446" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">December 7, 2020 at 1:35 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-581446" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks.</p>
<p>The predict_classes() performs an argmax on the predicted probabilities for you.</p>
<p>If you are new to argmax, see this:<br />
<a href="https://machinelearningmastery.com/argmax-in-machine-learning/" rel="nofollow ugc">https://machinelearningmastery.com/argmax-in-machine-learning/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-581446' data-commentid="581446" data-postid="7553" data-belowelement="comment-581446" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-581472" class="comment even depth-3">

	      	<div id="li-comment-581472" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/0a6713efb5b878c64e3586f0bfc04c83?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/0a6713efb5b878c64e3586f0bfc04c83?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ebdulmomen</span>
	                <span class="date">December 7, 2020 at 6:41 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-581472" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>thank you jason, everything is clear, really appreciate it!</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-581472' data-commentid="581472" data-postid="7553" data-belowelement="comment-581472" data-respondelement="respond" data-replyto="Reply to Ebdulmomen" aria-label='Reply to Ebdulmomen'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-581585" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-581585" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">December 8, 2020 at 7:40 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-581585" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I&#8217;m happy to hear that.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-581585' data-commentid="581585" data-postid="7553" data-belowelement="comment-581585" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-583565" class="comment even thread-even depth-1">

	      	<div id="li-comment-583565" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/2ecf1bed9147f034af1499b0754d2205?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/2ecf1bed9147f034af1499b0754d2205?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Naveen</span>
	                <span class="date">December 13, 2020 at 2:43 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-583565" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hey is this code not compatible for Tensorflow 2? I am getting the following error.<br />
E tensorflow/stream_executor/cuda/cuda_driver.cc:314] failed call to cuInit: CUDA_ERROR_NO_DEVICE: no CUDA-capable device is detected</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-583565' data-commentid="583565" data-postid="7553" data-belowelement="comment-583565" data-respondelement="respond" data-replyto="Reply to Naveen" aria-label='Reply to Naveen'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-583598" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-583598" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">December 13, 2020 at 6:06 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-583598" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, you can learn more here:<br />
<a href="https://machinelearningmastery.com/faq/single-faq/do-you-support-tensorflow-2" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/do-you-support-tensorflow-2</a></p>
<p>That error looks like a problem with your development environment.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-583598' data-commentid="583598" data-postid="7553" data-belowelement="comment-583598" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-587839" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-587839" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/ff0e4276c3e1d33001a3d48caa27c20a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/ff0e4276c3e1d33001a3d48caa27c20a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Yash</span>
	                <span class="date">December 23, 2020 at 9:40 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-587839" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello!<br />
Thanks for the wonderful article helped me a lot with my project!<br />
I have a question though, I am trying to take an image from my phone and then use that image to predict the number but it doesn&#8217;t work with that. What should I do to that image?<br />
I resized it to 28&#215;28 using online tools and even tried the grayscale version of the image to predict.<br />
Any suggestion or lead will be appreciated!<br />
Thanks in advance!</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-587839' data-commentid="587839" data-postid="7553" data-belowelement="comment-587839" data-respondelement="respond" data-replyto="Reply to Yash" aria-label='Reply to Yash'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-587897" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-587897" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">December 23, 2020 at 1:27 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-587897" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You will have to prepare the image in an identical manner to the images in the training set. e.g. white foreground, black background, grayscale and same image size.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-587897' data-commentid="587897" data-postid="7553" data-belowelement="comment-587897" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-590154" class="comment even thread-even depth-1">

	      	<div id="li-comment-590154" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/38fad5c19b9f971dbd2b25b324bda3f8?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/38fad5c19b9f971dbd2b25b324bda3f8?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='https://acehl.org/' rel='external nofollow ugc' class='url'>JG</a></span>
	                <span class="date">December 31, 2020 at 7:53 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-590154" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Great tutorial as always!</p>
<p>I implemented your tutorial with two variants. </p>
<p>I load the images from  digits dataset of sklearn library (it uses less images number only 1,797 and with much lower resolution 8 x 8 bits vs MNIST 70,000 and 28,28 pixels resolution. On the contrary it is much faster this dataset because it use less data features.<br />
And also I apply for this multi-class problem  other library classifier models from Sklearn such as SVC(), logisticRegression(), ExtraTreesClassifier(), XGBClassifier(), RandomForestClassifier(), etc.</p>
<p>My main results are:</p>
<p>&#8211; I got 98.4% accuracy and 1.1 of sigma for the simple CNN baseline model  (not other deep layers, not other BatchNormalization()) and I got 98.8% from SVC&#8230;but only suing the 8&#215;8 pixels resolution which is a great new!.</p>
<p>But when I reduce the final image to be predicted to 8 x 8 pixels, in order to apply my trained model, whereI got such a great score  I poorly predict the 7 digit as 9 digit.<br />
My guess is when I load_image of 7 and I clip it to such smaller size of 8&#215;8 pixels, I lost important images features in the process of cutting back the image&#8230;.where the the MNIST 28&#215;28 pixels still retain key digit features of the image, what do you think?</p>
<p>thank you Jason</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-590154' data-commentid="590154" data-postid="7553" data-belowelement="comment-590154" data-respondelement="respond" data-replyto="Reply to JG" aria-label='Reply to JG'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-590173" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-590173" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">December 31, 2020 at 9:26 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-590173" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks.</p>
<p>Very nice experiments!</p>
<p>Yes, the larger images perhaps provide more context on challenging cases in the dataset.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-590173' data-commentid="590173" data-postid="7553" data-belowelement="comment-590173" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-594411" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-594411" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/42ee9f1e9ade5446e7e34defa0addafc?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/42ee9f1e9ade5446e7e34defa0addafc?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://www.hannesholst.com' rel='external nofollow ugc' class='url'>Hannes</a></span>
	                <span class="date">January 26, 2021 at 1:15 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-594411" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>You have always very interesting articles.<br />
I was able to train a CNN based on the Char74K-dataset. I&#8217;m happy of that because the model-file is only 42MB and the time to predict a number is fast.</p>
<p>I did use a kNN-model before (on the same dataset) that had a file size of 680MB!</p>
<p>Thanks,<br />
Hannes</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-594411' data-commentid="594411" data-postid="7553" data-belowelement="comment-594411" data-respondelement="respond" data-replyto="Reply to Hannes" aria-label='Reply to Hannes'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-594480" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-594480" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">January 26, 2021 at 5:58 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-594480" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks.</p>
<p>Well done!</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-594480' data-commentid="594480" data-postid="7553" data-belowelement="comment-594480" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-596400" class="comment even thread-even depth-1">

	      	<div id="li-comment-596400" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/fdfa3d08680c52b037bd5312515ed002?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/fdfa3d08680c52b037bd5312515ed002?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Mukesh</span>
	                <span class="date">February 5, 2021 at 8:42 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-596400" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Great article!!</p>
<p>i just have one doubt, in the evaluate method why are we creating a new model for every fold?</p>
<p>Thanks,</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-596400' data-commentid="596400" data-postid="7553" data-belowelement="comment-596400" data-respondelement="respond" data-replyto="Reply to Mukesh" aria-label='Reply to Mukesh'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-596453" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-596453" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">February 6, 2021 at 5:49 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-596453" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This is how k-fold cross-validation works, we have a new training set and fit a new model for each fold, then average the performance of all models to get an estimate of model performance when used on unseen data.</p>
<p>You can learn more here:<br />
<a href="https://machinelearningmastery.com/k-fold-cross-validation/" rel="nofollow ugc">https://machinelearningmastery.com/k-fold-cross-validation/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-596453' data-commentid="596453" data-postid="7553" data-belowelement="comment-596453" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-596502" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-596502" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/15a5efe49875b91252461acc5e91b50c?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/15a5efe49875b91252461acc5e91b50c?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Dmitry</span>
	                <span class="date">February 6, 2021 at 6:20 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-596502" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for this amazing tutorial!</p>
<p>I have some experience in MLP but not with CNN. Is there a reason try to use CNN if each sample of my data have shape 16&#215;1 (row) with values between 0,01 to 0,99 and the model shoud perform classification for 15 classes. If I reshape samples from 16&#215;1 to 4&#215;4 then which filter size and a modest number of filters shoud I use? Or better dont reshape and try model with Conv1D layers? Thanks.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-596502' data-commentid="596502" data-postid="7553" data-belowelement="comment-596502" data-respondelement="respond" data-replyto="Reply to Dmitry" aria-label='Reply to Dmitry'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-596533" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-596533" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">February 7, 2021 at 5:17 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-596533" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>CNN can be effective if there is a spatial relationship between the inputs in an image or a sequence.</p>
<p>If you have tabular data (e.g. not a images and not sequences), then a CNN does not make sense.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-596533' data-commentid="596533" data-postid="7553" data-belowelement="comment-596533" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-597913" class="comment even thread-even depth-1">

	      	<div id="li-comment-597913" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/557bb5be9c83992918fc88aadb6e0f0f?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/557bb5be9c83992918fc88aadb6e0f0f?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ahmed Shafeek</span>
	                <span class="date">February 18, 2021 at 2:19 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-597913" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thank you very much for your amazing tutorial. I am running your code using pycharm and I have a GPU with the right CUDA but your code is only running on my CPU.</p>
<p>Is there something that I am missing here?</p>
<p>thank you. 🙂</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-597913' data-commentid="597913" data-postid="7553" data-belowelement="comment-597913" data-respondelement="respond" data-replyto="Reply to Ahmed Shafeek" aria-label='Reply to Ahmed Shafeek'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-597921" class="comment odd alt depth-2">

	      	<div id="li-comment-597921" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/557bb5be9c83992918fc88aadb6e0f0f?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/557bb5be9c83992918fc88aadb6e0f0f?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ahmed Shafeek</span>
	                <span class="date">February 18, 2021 at 4:52 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-597921" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry Jason, it turned out I had a problem in the CuDNN installation and i did a work around to fix it and it worked. 🙂</p>
<p>Thanks again for this great tutorial. 🙂</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-597921' data-commentid="597921" data-postid="7553" data-belowelement="comment-597921" data-respondelement="respond" data-replyto="Reply to Ahmed Shafeek" aria-label='Reply to Ahmed Shafeek'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-597992" class="comment byuser comment-author-jasonb bypostauthor even depth-3">

	      	<div id="li-comment-597992" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">February 19, 2021 at 5:55 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-597992" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>No problem! </p>
<p>Happy to hear you fixed the issue.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-597992' data-commentid="597992" data-postid="7553" data-belowelement="comment-597992" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-597990" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-597990" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">February 19, 2021 at 5:54 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-597990" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The code is agnostic to hardware &#8211; runs on both.</p>
<p>If it is running on your CPU, then you need to change the configuration of your tensorflow library. I don&#8217;t have tutorials on this topic, sorry.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-597990' data-commentid="597990" data-postid="7553" data-belowelement="comment-597990" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-598567" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-598567" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/854b05e9f02561de32cf0261e077bb68?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/854b05e9f02561de32cf0261e077bb68?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Karl</span>
	                <span class="date">February 24, 2021 at 1:20 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-598567" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, </p>
<p>Thank you very much for this tutorial, helped a lot! I developed my own CNN, which seems to perform pretty well according to the mean accuracy. However, the cross-entropy loss of the validation set is below the loss of the training set. Is this a sign of underfitting? And if so, should I change the model if I would like to apply the model to unseen data?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-598567' data-commentid="598567" data-postid="7553" data-belowelement="comment-598567" data-respondelement="respond" data-replyto="Reply to Karl" aria-label='Reply to Karl'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-598599" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-598599" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">February 24, 2021 at 5:34 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-598599" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You&#8217;re welcome.</p>
<p>Well done!</p>
<p>If performance is poor, a learning curve can help diagnose issues, this can help you interpret the learning curve:<br />
<a href="https://machinelearningmastery.com/learning-curves-for-diagnosing-machine-learning-model-performance/" rel="nofollow ugc">https://machinelearningmastery.com/learning-curves-for-diagnosing-machine-learning-model-performance/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-598599' data-commentid="598599" data-postid="7553" data-belowelement="comment-598599" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-598569" class="comment even thread-even depth-1">

	      	<div id="li-comment-598569" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/982ac96f275185dc6506bfb88a34da8b?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/982ac96f275185dc6506bfb88a34da8b?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Noah</span>
	                <span class="date">February 24, 2021 at 1:51 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-598569" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thank you very much for this tutorial, helped a lot! I developed my own CNN, which seems to perform pretty well according to the mean accuracy. However, the cross-entropy loss of the validation set is below the loss of the training set. Is this a sign of underfitting? And if so, should I change the model if I would like to apply the model to unseen data?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-598569' data-commentid="598569" data-postid="7553" data-belowelement="comment-598569" data-respondelement="respond" data-replyto="Reply to Noah" aria-label='Reply to Noah'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-598601" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-598601" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">February 24, 2021 at 5:35 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-598601" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You&#8217;re welcome.</p>
<p>Perhaps focus on the out of sample performance of the model first and optimize that.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-598601' data-commentid="598601" data-postid="7553" data-belowelement="comment-598601" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-599413" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-599413" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/b5d1301886519eb39bc126e872214229?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/b5d1301886519eb39bc126e872214229?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Geo</span>
	                <span class="date">March 2, 2021 at 12:20 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-599413" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Previously I was grateful for the tutorial you provided, I learned a lot from here. What if I want to display the probability value of the prediction result? (for example 50.67% something like that)</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-599413' data-commentid="599413" data-postid="7553" data-belowelement="comment-599413" data-respondelement="respond" data-replyto="Reply to Geo" aria-label='Reply to Geo'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-599461" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-599461" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">March 2, 2021 at 5:45 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-599461" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks!</p>
<p>You can call model.predict() then multiply the result by 100 to get a percentage.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-599461' data-commentid="599461" data-postid="7553" data-belowelement="comment-599461" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-599529" class="comment even thread-even depth-1">

	      	<div id="li-comment-599529" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/52fa4f6f751c870b9b3cca3e2d9f5f6b?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/52fa4f6f751c870b9b3cca3e2d9f5f6b?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">William</span>
	                <span class="date">March 2, 2021 at 3:01 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-599529" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you for the tutorial!</p>
<p>I created an image with same characteristics as sample_image.png (1490&#215;1480, black background, white foreground), opened it in Paint, typed a &#8220;6&#8221; (without the quotes, of course), increased the font size to 1000 (so it would occupy most of the canvas), then saved it.  However, the code doesn&#8217;t seem to recognize it.  It seems to think it&#8217;s a &#8220;1&#8221;, &#8220;8&#8221;, or other numbers.</p>
<p>Any suggestions on why?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-599529' data-commentid="599529" data-postid="7553" data-belowelement="comment-599529" data-respondelement="respond" data-replyto="Reply to William" aria-label='Reply to William'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-599625" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-599625" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">March 3, 2021 at 5:25 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-599625" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps there was some important difference in the image itself or it&#8217;s preparation (e.g. pixel scaling) that differed from the training dataset?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-599625' data-commentid="599625" data-postid="7553" data-belowelement="comment-599625" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-603051" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-603051" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/be37c522522e693eb1d6098007d70f93?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/be37c522522e693eb1d6098007d70f93?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Venkat</span>
	                <span class="date">April 1, 2021 at 10:07 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-603051" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason &#8211; fantastic article!! Just wondering why you had to do evaluate to get the accuracy, while it is already being returned by the fit call? I just checked the histories and they have exactly the same stuff returned by the evaluate call. Was there any other reason for the evaluate call?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-603051' data-commentid="603051" data-postid="7553" data-belowelement="comment-603051" data-respondelement="respond" data-replyto="Reply to Venkat" aria-label='Reply to Venkat'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-603104" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-603104" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">April 2, 2021 at 5:39 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-603104" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks!</p>
<p>No, accuracy on a hold out dataset is not calculated when calling fit. We must make predictions on new data manually or use the evaluate function.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-603104' data-commentid="603104" data-postid="7553" data-belowelement="comment-603104" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-604974" class="comment even depth-3">

	      	<div id="li-comment-604974" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/be37c522522e693eb1d6098007d70f93?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/be37c522522e693eb1d6098007d70f93?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Venkat</span>
	                <span class="date">April 15, 2021 at 4:17 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-604974" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for the reply!! I was seeing the same data is passed (testX, testY) for both fit and evaluate calls for validation. As a result, the return object from fit call already has the data to be returned by the evaluate call. Am I making sense?</p>
<p># fit model<br />
history = model.fit(trainX, trainY, epochs=10, batch_size=32, validation_data=(testX, testY), verbose=0)<br />
# evaluate model<br />
_, acc = model.evaluate(testX, testY, verbose=0)</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-604974' data-commentid="604974" data-postid="7553" data-belowelement="comment-604974" data-respondelement="respond" data-replyto="Reply to Venkat" aria-label='Reply to Venkat'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-605003" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-605003" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">April 15, 2021 at 5:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-605003" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Generally it is not a good idea to use test data as validation, I do to keep the examples simple.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-605003' data-commentid="605003" data-postid="7553" data-belowelement="comment-605003" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-603436" class="comment even thread-even depth-1">

	      	<div id="li-comment-603436" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/1932242bdd892819ef21d87693f149e9?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/1932242bdd892819ef21d87693f149e9?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Berke</span>
	                <span class="date">April 4, 2021 at 9:47 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-603436" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, thanks for this great tutorial!</p>
<p>I don&#8217;t get why we don&#8217;t use the models that we created during the k-fold. I was expecting something like we combine this k models results into one single model and save it. If we don&#8217;t do that how&#8217;s that useful?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-603436' data-commentid="603436" data-postid="7553" data-belowelement="comment-603436" data-respondelement="respond" data-replyto="Reply to Berke" aria-label='Reply to Berke'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-603478" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-603478" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">April 5, 2021 at 6:11 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-603478" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Models created during k-fold cross-validation are discarded. They are only used to estimate the performance of the model/pipeline on unseen examples.</p>
<p>Once we choose a configuration, we can fit a final model on all data and use it to make predictions on new examples:<br />
<a href="https://machinelearningmastery.com/train-final-machine-learning-model/" rel="nofollow ugc">https://machinelearningmastery.com/train-final-machine-learning-model/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-603478' data-commentid="603478" data-postid="7553" data-belowelement="comment-603478" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-605099" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-605099" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/438730a9a508262461435bde4b5dae55?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/438730a9a508262461435bde4b5dae55?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Vishwa</span>
	                <span class="date">April 15, 2021 at 9:38 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-605099" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks a lot Jason  !!! This tutorial was very very helpful and it solved half of my project problems !!! Thanks a lot again !..</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-605099' data-commentid="605099" data-postid="7553" data-belowelement="comment-605099" data-respondelement="respond" data-replyto="Reply to Vishwa" aria-label='Reply to Vishwa'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-605169" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-605169" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">April 16, 2021 at 5:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-605169" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You&#8217;re welcome.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-605169' data-commentid="605169" data-postid="7553" data-belowelement="comment-605169" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-612667" class="comment even thread-even depth-1">

	      	<div id="li-comment-612667" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/7457d50a3a56de43b22cfd16aa5db976?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/7457d50a3a56de43b22cfd16aa5db976?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">ismail</span>
	                <span class="date">June 9, 2021 at 8:47 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-612667" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you for the great tutorial. Is it possible to use it with a webcam for recognition task?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-612667' data-commentid="612667" data-postid="7553" data-belowelement="comment-612667" data-respondelement="respond" data-replyto="Reply to ismail" aria-label='Reply to ismail'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-612731" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-612731" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">June 10, 2021 at 5:20 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-612731" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps try it and see.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-612731' data-commentid="612731" data-postid="7553" data-belowelement="comment-612731" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-612968" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-612968" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/8f8c3b4ee7f14c7c4cdf0ea6d59460d4?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/8f8c3b4ee7f14c7c4cdf0ea6d59460d4?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Taylor Rayne</span>
	                <span class="date">June 12, 2021 at 12:20 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-612968" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello! Thank you Jason for this amazing resource. I am currently working on a rented computer from school &#8211; do you think I could do implement this code in CoLabs?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-612968' data-commentid="612968" data-postid="7553" data-belowelement="comment-612968" data-respondelement="respond" data-replyto="Reply to Taylor Rayne" aria-label='Reply to Taylor Rayne'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-613019" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-613019" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">June 13, 2021 at 5:46 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-613019" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You&#8217;re welcome.</p>
<p>Good question, see this:<br />
<a href="https://machinelearningmastery.com/faq/single-faq/do-code-examples-run-on-google-colab" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/do-code-examples-run-on-google-colab</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-613019' data-commentid="613019" data-postid="7553" data-belowelement="comment-613019" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-613234" class="comment even thread-even depth-1">

	      	<div id="li-comment-613234" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/fe4b19dc63ec10e7b78cd73b28b11b3a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/fe4b19dc63ec10e7b78cd73b28b11b3a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Manal</span>
	                <span class="date">June 15, 2021 at 4:14 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-613234" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br />
Thank you very much<br />
If possible, advise on the implementation HMM.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-613234' data-commentid="613234" data-postid="7553" data-belowelement="comment-613234" data-respondelement="respond" data-replyto="Reply to Manal" aria-label='Reply to Manal'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-613298" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-613298" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">June 16, 2021 at 6:17 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-613298" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for the suggestion, perhaps in the future.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-613298' data-commentid="613298" data-postid="7553" data-belowelement="comment-613298" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-613257" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-613257" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/6b0b33737577b4c28bc5feb712d1c6b5?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/6b0b33737577b4c28bc5feb712d1c6b5?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">amberbir</span>
	                <span class="date">June 15, 2021 at 11:11 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-613257" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>i am developing a model of handwritten character recognition but the accuracy is very low i think it is not only because i have a small datatset, there is something i am not understanding can u help me on the improvement</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-613257' data-commentid="613257" data-postid="7553" data-belowelement="comment-613257" data-respondelement="respond" data-replyto="Reply to amberbir" aria-label='Reply to amberbir'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-613307" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-613307" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">June 16, 2021 at 6:21 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-613307" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps try some of these suggestions:<br />
<a href="https://machinelearningmastery.com/improve-deep-learning-performance/" rel="nofollow ugc">https://machinelearningmastery.com/improve-deep-learning-performance/</a></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-613307' data-commentid="613307" data-postid="7553" data-belowelement="comment-613307" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-615857" class="comment even thread-even depth-1">

	      	<div id="li-comment-615857" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a3f6bf9f09182bf1025db2249e4514d1?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a3f6bf9f09182bf1025db2249e4514d1?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Shri</span>
	                <span class="date">July 8, 2021 at 11:15 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-615857" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Can I use this code for any character dataset ?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-615857' data-commentid="615857" data-postid="7553" data-belowelement="comment-615857" data-respondelement="respond" data-replyto="Reply to Shri" aria-label='Reply to Shri'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-615892" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-615892" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">July 9, 2021 at 5:11 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-615892" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps try it and see.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-615892' data-commentid="615892" data-postid="7553" data-belowelement="comment-615892" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-620862" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-620862" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/f9bbd17761ad0e609533ba939d496077?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/f9bbd17761ad0e609533ba939d496077?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://jhss.scholasticahq.com' rel='external nofollow ugc' class='url'>Shireesh Apte</a></span>
	                <span class="date">August 8, 2021 at 8:34 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-620862" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Could you provide a peer review for a manuscript that has been submitted to the Journal  of High School Science (<a href="http://jhss.scholasticahq.com" rel="nofollow ugc">http://jhss.scholasticahq.com</a>) ? The title of the manuscript is : Implementing a Quantum Convolutional Neural Network for Efficient Image Recognition. Abstract: Machine learning has many real-world applications ranging from modeling the universe to computational chemistry. As probability is the bedrock for machine learning, it is essential to optimize both hardware and software to obtain the best results. Classical computers are generally used for machine learning programs. However, learning from high-dimensional data often demands excessive compute time and power, and it may not achieve the highest accuracy. The Quantum Computing environment can be utilized to create a more accurate model than that created via classical computing. To test this quantum advantage, we implemented a Quantum Convolutional Neural Network (QCNN), which parallels the structure of the classical Convolution Neural Network (CNN) in the quantum domain. Due to the lack of quantum computers with many qubits, physicists, namely John Preskill, have introduced the Noisy Intermediate Scale Quantum (NISQ) concept, which constitutes a hybrid interface between classical and quantum computers. In the context of QCNN, the data processing and the cost function optimization would be performed on the classical computer, while the probabilities generated by the Variational Quantum Circuits (VQC) would be evaluated on the quantum computer. The QCNN consists of a classical-to-quantum data encoder, a cluster state quantum circuit to entangle qubit states, a series of Variational Quantum Circuits using Quantum Convolutional and Pooling Layers for efficient feature extraction, a quantum-to-classical data decoder, which would lead to the output. Both the CNN and the QCNN extract features from data like 2D images, and performances can be compared using metrics like accuracy and time.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-620862' data-commentid="620862" data-postid="7553" data-belowelement="comment-620862" data-respondelement="respond" data-replyto="Reply to Shireesh Apte" aria-label='Reply to Shireesh Apte'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-620962" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-620962" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href='http://MachineLearningMastery.com' rel='external nofollow ugc' class='url'>Jason Brownlee</a></span>
	                <span class="date">August 9, 2021 at 5:52 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-620962" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry I cannot peer review your manuscript.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-620962' data-commentid="620962" data-postid="7553" data-belowelement="comment-620962" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label='Reply to Jason Brownlee'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-626421" class="comment even thread-even depth-1">

	      	<div id="li-comment-626421" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/1e49ae6672b336001f305fc4d32d40f9?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/1e49ae6672b336001f305fc4d32d40f9?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">nbe</span>
	                <span class="date">September 11, 2021 at 6:48 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-626421" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>what if we are asked to design a project to identify digit classification from MNIST using classification algorithm should we use the above oen</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-626421' data-commentid="626421" data-postid="7553" data-belowelement="comment-626421" data-respondelement="respond" data-replyto="Reply to nbe" aria-label='Reply to nbe'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-626695" class="comment byuser comment-author-adriantam odd alt depth-2">

	      	<div id="li-comment-626695" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/73a7f07e8fec40c74d091917c1108f7b?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/73a7f07e8fec40c74d091917c1108f7b?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Adrian Tam</span>
	                <span class="date">September 14, 2021 at 1:08 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-626695" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-626695' data-commentid="626695" data-postid="7553" data-belowelement="comment-626695" data-respondelement="respond" data-replyto="Reply to Adrian Tam" aria-label='Reply to Adrian Tam'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-637837" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-637837" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/1fe34e0141b88f6a64b690af38f6ab46?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/1fe34e0141b88f6a64b690af38f6ab46?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Abhi</span>
	                <span class="date">November 12, 2021 at 11:26 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-637837" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Wonderful tutorial!!</p>
<p>When i implemented the code i got this error &#8221; AttributeError: &#8216;Sequential&#8217; object has no attribute &#8216;predict_classes&#8217; &#8221;<br />
Any suggestions to rectify this error please?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-637837' data-commentid="637837" data-postid="7553" data-belowelement="comment-637837" data-respondelement="respond" data-replyto="Reply to Abhi" aria-label='Reply to Abhi'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-638396" class="comment byuser comment-author-adriantam odd alt depth-2">

	      	<div id="li-comment-638396" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/73a7f07e8fec40c74d091917c1108f7b?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/73a7f07e8fec40c74d091917c1108f7b?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Adrian Tam</span>
	                <span class="date">November 14, 2021 at 2:27 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-638396" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p></p>
		<div id="urvanov-syntax-highlighter-619c550b95e11671910244" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
from numpy import argmax

pred_value = model.predict(img)
digit = argmax(pred_value)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b95e11671910244-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b95e11671910244-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-619c550b95e11671910244-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-619c550b95e11671910244-4">4</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b95e11671910244-1"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">argmax</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b95e11671910244-2">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-619c550b95e11671910244-3"><span class="crayon-v">pred_value</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">img</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-619c550b95e11671910244-4"><span class="crayon-v">digit</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">argmax</span><span class="crayon-sy">(</span><span class="crayon-v">pred_value</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p></p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-638396' data-commentid="638396" data-postid="7553" data-belowelement="comment-638396" data-respondelement="respond" data-replyto="Reply to Adrian Tam" aria-label='Reply to Adrian Tam'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-638994" class="comment even thread-even depth-1">

	      	<div id="li-comment-638994" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/e8fd6847ca7de381ae9a0eec51ef42bb?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/e8fd6847ca7de381ae9a0eec51ef42bb?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Annya Karn</span>
	                <span class="date">November 17, 2021 at 12:06 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-638994" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I used this model as an example and when I fed it a handwritten number, it continuously gave wrong predictions. Can you please tell me what could possibly be the problem?<br />
It reads accurately when I used printed numbers with black background.<br />
I did however  change the cnn model a little bit to make it Multiple Pooling model.<br />
I can share the code as well, if you like.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-638994' data-commentid="638994" data-postid="7553" data-belowelement="comment-638994" data-respondelement="respond" data-replyto="Reply to Annya Karn" aria-label='Reply to Annya Karn'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-639063" class="comment byuser comment-author-adriantam odd alt depth-2">

	      	<div id="li-comment-639063" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/73a7f07e8fec40c74d091917c1108f7b?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/73a7f07e8fec40c74d091917c1108f7b?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Adrian Tam</span>
	                <span class="date">November 17, 2021 at 6:55 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-639063" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Can&#8217;t tell because I didn&#8217;t see your handwriting. But this MNIST dataset is a 28&#215;28 pixel grayscale with white on black. Try to mimick this set up and it should be much better. If your image is more complex (e.g., you scan it, then the background is not a single color, or the alphabet is more complicated with more strokes than digits) then you will need a larger network to recognize it.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-639063' data-commentid="639063" data-postid="7553" data-belowelement="comment-639063" data-respondelement="respond" data-replyto="Reply to Adrian Tam" aria-label='Reply to Adrian Tam'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-640530" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-640530" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/ab7dcf1d791a88c8cd9e6567a0d49cf6?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/ab7dcf1d791a88c8cd9e6567a0d49cf6?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Louca</span>
	                <span class="date">November 23, 2021 at 12:01 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-640530" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You mention in other answers that the inputs have to be reshaped because the convolutional layers expect an input with a dimension for channels. Do you know if this is unique to keras?</p>
<p>I am trying to classify 56&#215;56 grayscale images (0-&gt;255), and so far I have normalized them to [-1,1]. However, they are still 2D as a 56&#215;56 matrix. I am using pytorch. Do you know if I would also need to reshape them to add the single channel?</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-640530' data-commentid="640530" data-postid="7553" data-belowelement="comment-640530" data-respondelement="respond" data-replyto="Reply to Louca" aria-label='Reply to Louca'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-640581" class="comment byuser comment-author-adriantam odd alt depth-2">

	      	<div id="li-comment-640581" class="comment-container">

					                <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/73a7f07e8fec40c74d091917c1108f7b?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/73a7f07e8fec40c74d091917c1108f7b?s=80&#038;d=mm&#038;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' loading='lazy'/></div>
	            
		      	<div class="comment-head">

	                <span class="name">Adrian Tam</span>
	                <span class="date">November 23, 2021 at 1:40 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#comment-640581" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Depends on the way you construct the model, it may or may not necessary.</p>

				
	                <div class="reply">
	                    <a rel='nofollow' class='comment-reply-link' href='#comment-640581' data-commentid="640581" data-postid="7553" data-belowelement="comment-640581" data-respondelement="respond" data-replyto="Reply to Adrian Tam" aria-label='Reply to Adrian Tam'>Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
			</ol>
		 	</div>	<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/how-to-develop-a-convolutional-neural-network-from-scratch-for-mnist-handwritten-digit-classification/#respond" style="display:none;">Click here to cancel reply.</a></small></h3><form action="https://machinelearningmastery.com/wp-comments-post.php?wpe-comment-post=mlmastery" method="post" id="commentform" class="comment-form"><p class="comment-form-comment"><label class="hide" for="comment">Comment</label> <textarea tabindex="4" id="comment" name="comment" cols="50" rows="10" maxlength="65525" required="required"></textarea></p><p class="comment-form-author"><input id="author" name="author" type="text" class="txt" tabindex="1" value="" size="30" aria-required='true' /><label for="author">Name <span class="required">(required)</span></label> </p>
<p class="comment-form-email"><input id="email" name="email" type="text" class="txt" tabindex="2" value="" size="30" aria-required='true' /><label for="email">Email (will not be published) <span class="required">(required)</span></label> </p>
<p class="comment-form-url"><input id="url" name="url" type="text" class="txt" tabindex="3" value="" size="30" /><label for="url">Website</label></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit Comment" /> <input type='hidden' name='comment_post_ID' value='7553' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="39830479bd" /></p><p style="display: none !important;"><label>&#916;<textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100"></textarea></label><input type="hidden" id="ak_js" name="ak_js" value="7"/><script type="rocketlazyloadscript">document.getElementById( "ak_js" ).setAttribute( "value", ( new Date() ).getTime() );</script></p></form>	</div><!-- #respond -->
	     
            </section><!-- /#main -->
                
            <aside id="sidebar">
<div id="woo_blogauthorinfo-2" class="widget widget_woo_blogauthorinfo"><span class="left"><img alt='' src='https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=88&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=176&#038;d=mm&#038;r=g 2x' class='avatar avatar-88 photo' height='88' width='88' loading='lazy'/></span>
<p><strong>Welcome!</strong><br>
I'm <em>Jason Brownlee</em> PhD <br>
and I <strong>help developers</strong> get results with <strong>machine learning</strong>.<br>
<a href="/about">Read more</a></p>
<div class="fix"></div>
</div><div id="custom_html-89" class="widget_text widget widget_custom_html"><div class="textwidget custom-html-widget"><h4>Never miss a tutorial:</h4>
<br>
<div style="text-align: left;">
<a href="https://www.linkedin.com/company/machine-learning-mastery/"><img width="30" height="30" src="/wp-content/uploads/2019/12/small_icon_blue_linkedin3.png" alt="LinkedIn"></a>
&nbsp;&nbsp;&nbsp;
<a href="https://twitter.com/TeachTheMachine"><img width="30" height="30" src="/wp-content/uploads/2019/12/small_icon_blue_twitter3.png" alt="Twitter"></a>
&nbsp;&nbsp;&nbsp;
<a href="https://www.facebook.com/MachineLearningMastery/"><img width="30" height="30" src="/wp-content/uploads/2019/12/small_icon_blue_facebook3.png" alt="Facebook"></a>
&nbsp;&nbsp;&nbsp;
<a href="/newsletter/"><img width="30" height="30" src="/wp-content/uploads/2019/12/small_icon_blue_email3.png" alt="Email Newsletter"></a>
&nbsp;&nbsp;&nbsp;
<a href="https://machinelearningmastery.com/rss-feed/"><img width="30" height="30" src="/wp-content/uploads/2019/12/small_icon_blue_rss3.png" alt="RSS Feed"></a>
</div></div></div><div id="custom_html-28" class="widget_text widget widget_custom_html"><div class="textwidget custom-html-widget"><h4>Picked for you:</h4>
<br>
<div class="display-posts-listing image-left"><div class="listing-item"><a class="image" href="https://machinelearningmastery.com/how-to-train-an-object-detection-model-with-keras/"><img width="150" height="150" src="https://machinelearningmastery.com/wp-content/uploads/2019/03/Photograph-Showing-Object-Detection-Masks-Bounding-Boxes-and-Class-Labels-150x150.png" class="attachment-thumbnail size-thumbnail wp-post-image" alt="Photograph Showing Object Detection Masks, Bounding Boxes, and Class Labels" loading="lazy" /></a> <a class="title" href="https://machinelearningmastery.com/how-to-train-an-object-detection-model-with-keras/" rel="nofollow">How to Train an Object Detection Model with Keras</a></div><div class="listing-item"><a class="image" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/"><img width="150" height="150" src="https://machinelearningmastery.com/wp-content/uploads/2019/03/Detected-Face-of-Jerry-Seinfeld-Correctly-Identified-by-the-SVM-Classifier-150x150.png" class="attachment-thumbnail size-thumbnail wp-post-image" alt="Detected Face of Jerry Seinfeld, Correctly Identified by the SVM Classifier" loading="lazy" /></a> <a class="title" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/" rel="nofollow">How to Develop a Face Recognition System Using FaceNet in Keras</a></div><div class="listing-item"><a class="image" href="https://machinelearningmastery.com/how-to-perform-object-detection-with-yolov3-in-keras/"><img width="150" height="150" src="https://machinelearningmastery.com/wp-content/uploads/2019/03/Photograph-of-Three-Zebra-Each-Detected-with-the-YOLOv3-Model-and-Localized-with-Bounding-Boxes-150x150.png" class="attachment-thumbnail size-thumbnail wp-post-image" alt="Photograph of Three Zebra Each Detected with the YOLOv3 Model and Localized with Bounding Boxes" loading="lazy" /></a> <a class="title" href="https://machinelearningmastery.com/how-to-perform-object-detection-with-yolov3-in-keras/" rel="nofollow">How to Perform Object Detection With YOLOv3 in Keras</a></div><div class="listing-item"><a class="image" href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-to-classify-photos-of-dogs-and-cats/"><img width="150" height="150" src="https://machinelearningmastery.com/wp-content/uploads/2019/03/Plot-of-the-First-Nine-Photos-of-Cats-in-the-Dogs-vs-Cats-Dataset-150x150.png" class="attachment-thumbnail size-thumbnail wp-post-image" alt="Plot of the First Nine Photos of Cats in the Dogs vs Cats Dataset" loading="lazy" /></a> <a class="title" href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-to-classify-photos-of-dogs-and-cats/" rel="nofollow">How to Classify Photos of Dogs and Cats (with 97% accuracy)</a></div><div class="listing-item"><a class="image" href="https://machinelearningmastery.com/how-to-get-started-with-deep-learning-for-computer-vision-7-day-mini-course/"><img width="150" height="150" src="https://machinelearningmastery.com/wp-content/uploads/2019/04/How-to-Get-Started-With-Deep-Learning-for-Computer-Vision-7-Day-Mini-Course-150x150.jpg" class="attachment-thumbnail size-thumbnail wp-post-image" alt="How to Get Started With Deep Learning for Computer Vision (7-Day Mini-Course)" loading="lazy" /></a> <a class="title" href="https://machinelearningmastery.com/how-to-get-started-with-deep-learning-for-computer-vision-7-day-mini-course/" rel="nofollow">How to Get Started With Deep Learning for Computer Vision (7-Day Mini-Course)</a></div></div></div></div><div id="custom_html-9" class="widget_text widget widget_custom_html"><div class="textwidget custom-html-widget"><div style="text-align: center;">
	<p><h4>Loving the Tutorials?</h4></p>

<p>The <a href="/deep-learning-for-computer-vision/" rel="nofollow">Deep Learning for Computer Vision</a> EBook is where you'll find the <strong><i>Really Good</i></strong> stuff.</p>

<a href="/deep-learning-for-computer-vision/" class="woo-sc-button  red" ><span class="woo-">&gt;&gt; See What's Inside</span></a>

</div></div></div></aside><!-- /#sidebar -->

		</div><!-- /#main-sidebar-container -->         

		
    </div><!-- /#content -->
	
	<footer id="footer" class="col-full">

		
		<div id="copyright" class="col-left">
			<p>© 2021 Machine Learning Mastery. All Rights Reserved.<br />
<a href="https://www.linkedin.com/company/machine-learning-mastery/">LinkedIn</a> |
<a href="https://twitter.com/TeachTheMachine">Twitter</a> |
<a href="https://www.facebook.com/MachineLearningMastery/">Facebook</a> |
<a href="/newsletter/">Newsletter</a> |
<a href="/rss-feed/">RSS</a></p>		</div>

		<div id="credit" class="col-right">
			<p><a href="/privacy/">Privacy</a> | 
<a href="/disclaimer/">Disclaimer</a> | 
<a href="/terms-of-service/">Terms</a> | 
<a href="/contact/">Contact</a> |
<a href="/sitemap/">Sitemap</a> |
<a href="/site-search/">Search</a></p>		</div>

	</footer>

	
	</div><!-- /#inner-wrapper -->

</div><!-- /#wrapper -->

<div class="fix"></div><!--/.fix-->

<script type="rocketlazyloadscript">window.advanced_ads_check_adblocker=function(t){var n=[],e=null;function i(t){(window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||function(t){return setTimeout(t,16)}).call(window,t)}return i((function(){var t=document.createElement("div");t.innerHTML="&nbsp;",t.setAttribute("class","ad_unit ad-unit text-ad text_ad pub_300x250"),t.setAttribute("style","width: 1px !important; height: 1px !important; position: absolute !important; left: 0px !important; top: 0px !important; overflow: hidden !important;"),document.body.appendChild(t),i((function(){var i=window.getComputedStyle&&window.getComputedStyle(t),o=i&&i.getPropertyValue("-moz-binding");e=i&&"none"===i.getPropertyValue("display")||"string"==typeof o&&-1!==o.indexOf("about:");for(var a=0,r=n.length;a<r;a++)n[a](e);n=[]}))})),function(t){null!==e?t(e):n.push(t)}}();</script><!-- Drip -->
<script type="rocketlazyloadscript" data-cfasync="false" data-rocket-type="text/javascript">
  var _dcq = _dcq || [];
  var _dcs = _dcs || {};
  _dcs.account = '9556588';

  (function() {
    var dc = document.createElement('script');
    dc.type = 'text/javascript'; dc.async = true;
    dc.src = '//tag.getdrip.com/9556588.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(dc, s);
  })();
</script>
<!-- end Drip --><script type="rocketlazyloadscript" data-rocket-type='text/javascript' src='https://machinelearningmastery.com/wp-includes/js/comment-reply.min.js?ver=5.8.2' id='comment-reply-js' defer></script>
<script type="rocketlazyloadscript" data-minify="1" data-rocket-type='text/javascript' src='https://machinelearningmastery.com/wp-content/cache/min/1/npm/mathjax@3/es5/tex-chtml.js?ver=1637275040' id='mathjax-js' defer></script>
<script type="rocketlazyloadscript" data-rocket-type='text/javascript' id='rocket-browser-checker-js-after'>
"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}var RocketBrowserCompatibilityChecker=function(){function RocketBrowserCompatibilityChecker(options){_classCallCheck(this,RocketBrowserCompatibilityChecker),this.passiveSupported=!1,this._checkPassiveOption(this),this.options=!!this.passiveSupported&&options}return _createClass(RocketBrowserCompatibilityChecker,[{key:"_checkPassiveOption",value:function(self){try{var options={get passive(){return!(self.passiveSupported=!0)}};window.addEventListener("test",null,options),window.removeEventListener("test",null,options)}catch(err){self.passiveSupported=!1}}},{key:"initRequestIdleCallback",value:function(){!1 in window&&(window.requestIdleCallback=function(cb){var start=Date.now();return setTimeout(function(){cb({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(Date.now()-start))}})},1)}),!1 in window&&(window.cancelIdleCallback=function(id){return clearTimeout(id)})}},{key:"isDataSaverModeOn",value:function(){return"connection"in navigator&&!0===navigator.connection.saveData}},{key:"supportsLinkPrefetch",value:function(){var elem=document.createElement("link");return elem.relList&&elem.relList.supports&&elem.relList.supports("prefetch")&&window.IntersectionObserver&&"isIntersecting"in IntersectionObserverEntry.prototype}},{key:"isSlowConnection",value:function(){return"connection"in navigator&&"effectiveType"in navigator.connection&&("2g"===navigator.connection.effectiveType||"slow-2g"===navigator.connection.effectiveType)}}]),RocketBrowserCompatibilityChecker}();
</script>
<script type="46b118dd096b29ef1b5fe745-text/javascript" id='rocket-preload-links-js-extra'>
/* <![CDATA[ */
var RocketPreloadLinksConfig = {"excludeUris":"\/register\/machine-learning-university\/|\/courses\/\/lessons\/holding-back-goals\/|\/courses\/course-get-started\/|\/courses\/course-get-started\/lessons\/holding-back-goals\/|\/courses\/course-get-started\/lessons\/why-machine-learning-does-not-have-to-be-so-hard\/|\/courses\/course-get-started\/lessons\/how-to-think-about-machine-learning\/|\/courses\/course-get-started\/lessons\/find-your-machine-learning-tribe\/|\/courses\/step-by-step-process\/|\/courses\/probability-for-machine-learning\/|\/account\/|\/register\/|\/courses\/|\/machine-learning-mastery-university-registration\/|\/register\/|\/newsletter\/|\/(.+\/)?feed\/?.+\/?|\/(?:.+\/)?embed\/|\/(index\\.php\/)?wp\\-json(\/.*|$)|\/wp-admin\/|\/logout\/|\/login\/","usesTrailingSlash":"1","imageExt":"jpg|jpeg|gif|png|tiff|bmp|webp|avif","fileExt":"jpg|jpeg|gif|png|tiff|bmp|webp|avif|php|pdf|html|htm","siteUrl":"https:\/\/machinelearningmastery.com","onHoverDelay":"100","rateThrottle":"3"};
/* ]]> */
</script>
<script type="rocketlazyloadscript" data-rocket-type='text/javascript' id='rocket-preload-links-js-after'>
(function() {
"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}();function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var t=function(){function n(e,t){i(this,n),this.browser=e,this.config=t,this.options=this.browser.options,this.prefetched=new Set,this.eventTime=null,this.threshold=1111,this.numOnHover=0}return e(n,[{key:"init",value:function(){!this.browser.supportsLinkPrefetch()||this.browser.isDataSaverModeOn()||this.browser.isSlowConnection()||(this.regex={excludeUris:RegExp(this.config.excludeUris,"i"),images:RegExp(".("+this.config.imageExt+")$","i"),fileExt:RegExp(".("+this.config.fileExt+")$","i")},this._initListeners(this))}},{key:"_initListeners",value:function(e){-1<this.config.onHoverDelay&&document.addEventListener("mouseover",e.listener.bind(e),e.listenerOptions),document.addEventListener("mousedown",e.listener.bind(e),e.listenerOptions),document.addEventListener("touchstart",e.listener.bind(e),e.listenerOptions)}},{key:"listener",value:function(e){var t=e.target.closest("a"),n=this._prepareUrl(t);if(null!==n)switch(e.type){case"mousedown":case"touchstart":this._addPrefetchLink(n);break;case"mouseover":this._earlyPrefetch(t,n,"mouseout")}}},{key:"_earlyPrefetch",value:function(t,e,n){var i=this,r=setTimeout(function(){if(r=null,0===i.numOnHover)setTimeout(function(){return i.numOnHover=0},1e3);else if(i.numOnHover>i.config.rateThrottle)return;i.numOnHover++,i._addPrefetchLink(e)},this.config.onHoverDelay);t.addEventListener(n,function e(){t.removeEventListener(n,e,{passive:!0}),null!==r&&(clearTimeout(r),r=null)},{passive:!0})}},{key:"_addPrefetchLink",value:function(i){return this.prefetched.add(i.href),new Promise(function(e,t){var n=document.createElement("link");n.rel="prefetch",n.href=i.href,n.onload=e,n.onerror=t,document.head.appendChild(n)}).catch(function(){})}},{key:"_prepareUrl",value:function(e){if(null===e||"object"!==(void 0===e?"undefined":r(e))||!1 in e||-1===["http:","https:"].indexOf(e.protocol))return null;var t=e.href.substring(0,this.config.siteUrl.length),n=this._getPathname(e.href,t),i={original:e.href,protocol:e.protocol,origin:t,pathname:n,href:t+n};return this._isLinkOk(i)?i:null}},{key:"_getPathname",value:function(e,t){var n=t?e.substring(this.config.siteUrl.length):e;return n.startsWith("/")||(n="/"+n),this._shouldAddTrailingSlash(n)?n+"/":n}},{key:"_shouldAddTrailingSlash",value:function(e){return this.config.usesTrailingSlash&&!e.endsWith("/")&&!this.regex.fileExt.test(e)}},{key:"_isLinkOk",value:function(e){return null!==e&&"object"===(void 0===e?"undefined":r(e))&&(!this.prefetched.has(e.href)&&e.origin===this.config.siteUrl&&-1===e.href.indexOf("?")&&-1===e.href.indexOf("#")&&!this.regex.excludeUris.test(e.href)&&!this.regex.images.test(e.href))}}],[{key:"run",value:function(){"undefined"!=typeof RocketPreloadLinksConfig&&new n(new RocketBrowserCompatibilityChecker({capture:!0,passive:!0}),RocketPreloadLinksConfig).init()}}]),n}();t.run();
}());
</script>
<script type="rocketlazyloadscript" data-minify="1" data-rocket-type='text/javascript' src='https://machinelearningmastery.com/wp-content/cache/min/1/wp-content/plugins/advanced-ads-pro-2.13.0/assets/advanced-ads-pro.js?ver=1637275040' id='advanced-ds-pro/front-js' defer></script>
<script type="46b118dd096b29ef1b5fe745-text/javascript" id='q2w3_fixed_widget-js-extra'>
/* <![CDATA[ */
var q2w3_sidebar_options = [{"sidebar":"primary","margin_top":10,"margin_bottom":0,"stop_id":"","screen_max_width":400,"screen_max_height":0,"width_inherit":false,"refresh_interval":1500,"window_load_hook":false,"disable_mo_api":false,"widgets":["custom_html-89","custom_html-50","custom_html-90","custom_html-91","custom_html-58","custom_html-60","custom_html-59","custom_html-84","custom_html-51","custom_html-56","custom_html-55","custom_html-57","custom_html-53","custom_html-54","custom_html-52","custom_html-48","custom_html-49","custom_html-80","custom_html-47","custom_html-85","custom_html-30","custom_html-29","custom_html-28","custom_html-27","custom_html-3","custom_html-24","custom_html-23","custom_html-22","custom_html-21","custom_html-20","custom_html-19","custom_html-18","custom_html-17","custom_html-16","custom_html-15","custom_html-14","custom_html-13","custom_html-11","custom_html-10","custom_html-5","custom_html-9","custom_html-61","custom_html-81","custom_html-86","custom_html-92","custom_html-97"]}];
/* ]]> */
</script>
<script type="rocketlazyloadscript" data-rocket-type='text/javascript' src='https://machinelearningmastery.com/wp-content/plugins/q2w3-fixed-widget/js/q2w3-fixed-widget.min.js?ver=5.3.0' id='q2w3_fixed_widget-js' defer></script>
<script type="46b118dd096b29ef1b5fe745-text/javascript" id='advanced-ads-pro/cache_busting-js-extra'>
/* <![CDATA[ */
var advanced_ads_pro_ajax_object = {"ajax_url":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","lazy_load_module_enabled":"","lazy_load":{"default_offset":0,"offsets":[]},"moveintohidden":"","wp_timezone_offset":"39600"};
/* ]]> */
</script>
<script type="rocketlazyloadscript" data-rocket-type='text/javascript' src='https://machinelearningmastery.com/wp-content/plugins/advanced-ads-pro-2.13.0/assets/js/base.min.js?ver=2.13.0' id='advanced-ads-pro/cache_busting-js' defer></script>
<script type="46b118dd096b29ef1b5fe745-text/javascript" id='advadsTrackingScript-js-extra'>
/* <![CDATA[ */
var advadsTracking = {"impressionActionName":"aatrack-records","clickActionName":"aatrack-click","targetClass":"machi-target","blogId":"1"};
/* ]]> */
</script>
<script type="rocketlazyloadscript" data-rocket-type='text/javascript' src='https://machinelearningmastery.com/wp-content/plugins/advanced-ads-tracking/public/assets/js/dist/tracking.min.js?ver=2.1.3' id='advadsTrackingScript-js' defer></script>
<script type="46b118dd096b29ef1b5fe745-text/javascript" src='https://machinelearningmastery.com/wp-includes/js/wp-embed.min.js?ver=5.8.2' id='wp-embed-js' defer></script>
<script type="rocketlazyloadscript" data-rocket-type='text/javascript'>function initTwitCount(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://static1.twitcount.com/js/twitcount.js';fjs.parentNode.insertBefore(js,fjs)}}
        var ssb_twit_count_init=!1;addEventListener('mouseover',function(event){if(!ssb_twit_count_init){initTwitCount(document,'script','twitcount_plugins')
        ssb_twit_count_init=!0}})</script><!--noptimize--><script type="rocketlazyloadscript">!function(){window.advanced_ads_ready_queue=window.advanced_ads_ready_queue||[],advanced_ads_ready_queue.push=window.advanced_ads_ready;for(var d=0,a=advanced_ads_ready_queue.length;d<a;d++)advanced_ads_ready(advanced_ads_ready_queue[d])}();</script><!--/noptimize--><script id="machi-tracking" type="46b118dd096b29ef1b5fe745-text/javascript">var advads_tracking_ads = {};var advads_tracking_urls = {"1":"https:\/\/machinelearningmastery.com\/wp-content\/ajax-handler.php"};var advads_tracking_methods = {"1":"frontend"};var advads_tracking_parallel = {"1":false};var advads_tracking_linkbases = {"1":"https:\/\/machinelearningmastery.com\/linkout\/"};</script><script type="46b118dd096b29ef1b5fe745-text/javascript">window.lazyLoadOptions={elements_selector:"iframe[data-lazy-src]",data_src:"lazy-src",data_srcset:"lazy-srcset",data_sizes:"lazy-sizes",class_loading:"lazyloading",class_loaded:"lazyloaded",threshold:300,callback_loaded:function(element){if(element.tagName==="IFRAME"&&element.dataset.rocketLazyload=="fitvidscompatible"){if(element.classList.contains("lazyloaded")){if(typeof window.jQuery!="undefined"){if(jQuery.fn.fitVids){jQuery(element).parent().fitVids()}}}}}};window.addEventListener('LazyLoad::Initialized',function(e){var lazyLoadInstance=e.detail.instance;if(window.MutationObserver){var observer=new MutationObserver(function(mutations){var image_count=0;var iframe_count=0;var rocketlazy_count=0;mutations.forEach(function(mutation){for(i=0;i<mutation.addedNodes.length;i++){if(typeof mutation.addedNodes[i].getElementsByTagName!=='function'){continue}
if(typeof mutation.addedNodes[i].getElementsByClassName!=='function'){continue}
images=mutation.addedNodes[i].getElementsByTagName('img');is_image=mutation.addedNodes[i].tagName=="IMG";iframes=mutation.addedNodes[i].getElementsByTagName('iframe');is_iframe=mutation.addedNodes[i].tagName=="IFRAME";rocket_lazy=mutation.addedNodes[i].getElementsByClassName('rocket-lazyload');image_count+=images.length;iframe_count+=iframes.length;rocketlazy_count+=rocket_lazy.length;if(is_image){image_count+=1}
if(is_iframe){iframe_count+=1}}});if(image_count>0||iframe_count>0||rocketlazy_count>0){lazyLoadInstance.update()}});var b=document.getElementsByTagName("body")[0];var config={childList:!0,subtree:!0};observer.observe(b,config)}},!1)</script><script data-no-minify="1" async src="https://machinelearningmastery.com/wp-content/plugins/wp-rocket/assets/js/lazyload/16.1/lazyload.min.js" type="46b118dd096b29ef1b5fe745-text/javascript"></script><script src="/cdn-cgi/scripts/7d0fa10a/cloudflare-static/rocket-loader.min.js" data-cf-settings="46b118dd096b29ef1b5fe745-|49" defer=""></script></body>
</html>
<!-- This website is like a Rocket, isn't it? Performance optimized by WP Rocket. Learn more: https://wp-rocket.me -->